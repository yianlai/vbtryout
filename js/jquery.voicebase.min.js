var voiceBase=function(e){"use strict";var t={instances:[],init:function(e){var s=t.instances.length;t.instances.push(new t.create_instance(s,e)),s++,this.current_instance=s-1},create_instance:function(e,s){this.instance_index=e,this.player=new t.Player(this,s)}};return t.default_settings={apiUrl:"https://api.voicebase.com/services",apiKey:null,externalId:null,apiVersion:"1.1",mediaId:null,password:null,token:null,tokenTimeOut:10,example:!1,exampleTokenUrl:"http://demo.voicsebasejwplayer.dev4.sibers.com/extoken.php",helpUrl:"http://www.voicebase.com/developers/",stream:!1,mediaTypeOverride:null,vbsButtons:{share:!0,comment:!0,downloadMedia:!0,downloadTranscript:!0,remove:!0,favorite:!0,help:!0,evernote:!0,edit:!1,print:!0,orderTranscript:!0,prev:!0,next:!0,fullscreen:!0,readermode:!0,pwrdb:!0,unquotes:!0},webHooks:{},addThisButtons:["gmail","facebook","twitter","google_plusone_share","compact"],mediumResponsiveWithSpeakers:600,mediumResponsive:450,minResponsive:400,voicebaseShare:!1,shareTitle:"Checkout this!",showMore:!1,shareParams:{},shareUrl:!1,trackEvents:!1,mediaBlock:"vbs-media",mediaWidth:!1,controlsBlock:"vbs-controls",controlsWidth:!1,searchBarOuter:!0,searchBarBlock:"vbs-searchbar-block",searchBarBlockWidth:!1,tabView:!1,tabViewForMobile:!0,keywordsBlock:"vbs-keywords",keywordsHeight:170,keywordsWidth:!1,keywordsResizable:!1,keywordsGroups:!0,keywordsCounter:!0,showAutoGeneratedKeywords:!0,editKeywords:!1,transcriptBlock:"vbs-transcript",transcriptHeight:148,transcriptWidth:!1,transcriptResizable:!1,transcriptHighlight:10,transcriptCheckTimer:10,turnTimes:!0,lineBreak:!1,commentsBlock:"vbs-comments",humanOnly:!1,animation:!0,localYoutubeApp:!1,localData:!1,localSearch:!1,localSearchHelperUrl:"js/workers/",colors:["#78c361","#9932cc","#ff69b4","#6495ed","#ffd700","#f6a7a1","#7fb397","#009999"],filterSpeaker:"all",playerType:"youtube",playerId:"ytplayer",keywordsColumns:!1,topicHover:!0,zeroclipboard:"ZeroClipboard.swf",commentsUsername:!1,commentsUserhandle:!1,contextMenu:!0,debug:!0,toggleBlocks:!0,toggleMediaBlock:!0,toggleKeywordsBlock:!0,toggleTranscriptBlock:!0,toggleCommentBlock:!0,hasMediaBlockHeader:!0,hasKeywordsBlockHeader:!0,hasTranscriptBlockHeader:!0,hasCommentsBlockHeader:!0,showControlsBlock:!0,showKeywordsBlock:!0,showTranscriptBlock:!0,showCommentsBlock:!0,expandMediaBlock:!0,expandKeywordsBlock:!0,expandTranscriptBlock:!0,expandCommentsBlock:!1,expandNewsBlock:!1,newsUrl:"https://stage.voicebase.com/bing/search?query=",newsBlock:"vbs-news",newsWidth:!1,showNewsBlock:!1,toggleNewsBlock:!0,hasNewsBlockHeader:!0,predictionsBlock:"vbs-predictions",predictionsWidth:!1,showPredictionsBlock:!1,togglePredictionsBlock:!0,expandPredictionsBlock:!0,hasPredictionsBlockHeader:!0,markersInNativeTimeline:!1,cssPathForPlayerFrame:"css/vbs-kaltura-iframe.css",modalErrors:!1,modalSave:!1,nativePlaylist:!0,restrictions:[],ready:function(){}},t.settings={},t.blockSettings={media:{block:"mediaBlock",additionalBlockClass:null,toggle:"toggleMediaBlock",expand:"expandMediaBlock",hasHeader:"hasMediaBlockHeader"},keywords:{block:"keywordsBlock",additionalBlockClass:".vbs-keywords-block",toggle:"toggleKeywordsBlock",expand:"expandKeywordsBlock",hasHeader:"hasKeywordsBlockHeader",width:"keywordsWidth",height:"keywordsHeight"},transcript:{block:"transcriptBlock",additionalBlockClass:".vbs-transcript-block",toggle:"toggleTranscriptBlock",expand:"expandTranscriptBlock",hasHeader:"hasTranscriptBlockHeader",width:"transcriptWidth",height:"transcriptHeight"},comments:{block:"commentsBlock",additionalBlockClass:".vbs-comments-block",toggle:"toggleCommentBlock",expand:"expandCommentsBlock",hasHeader:"hasCommentsBlockHeader",width:"commentsWidth"},news:{block:"newsBlock",additionalBlockClass:null,toggle:"toggleNewsBlock",expand:"expandNewsBlock",hasHeader:"hasNewsBlockHeader",width:"newsWidth"},predictions:{block:"predictionsBlock",additionalBlockClass:".vbs-predictions-block",toggle:"togglePredictionsBlock",expand:"expandPredictionsBlock",hasHeader:"hasPredictionsBlockHeader",width:"predictionsWidth"}},t.reSettings=function(s){t.settings=jQuery.extend(!0,{},t.default_settings),t.data=jQuery.extend(!0,{},t.default_data);var a=t.common.keysToLowerCase(s);for(var n in t.default_settings)t._setProperty(a,n);if("undefined"!=typeof a.actionflag)for(var r in a.actionflag)t.settings.vbsButtons[r]=a.actionflag[r];t.settings.helpUrl||t.settings.webHooks.help||(t.settings.vbsButtons.help=!1),t.common.isMobile()&&t.settings.tabViewForMobile&&(t.settings.tabView=!0);for(n in t.blockSettings){var i=t.blockSettings[n];t.settings.toggleBlocks?(t._setProperty(a,i.toggle),t._setProperty(a,i.expand)):(t.settings[i.toggle]=!1,t.settings[i.expand]=!0),t.settings[i.toggle]||(t.settings[i.expand]=!0),t.settings[i.hasHeader]||(t.settings[i.toggle]=!1),i.block&&"media"!==n&&(t.settings.tabView?e("#"+a[i.block.toLowerCase()]).empty():(t._setProperty(a,i.block),t._setBlockWidth(a,i.width),i.height&&t._setProperty(a,i.height)))}if(t.settings.tabView?t.settings.searchBarOuter=!0:t._setProperty(a,"searchBarOuter"),t.settings.searchBarOuter&&(t._setProperty(a,"searchBarBlock"),t._setBlockWidth(a,"searchBarBlockWidth")),(t.settings.localYoutubeApp||t.settings.localData)&&("undefined"!=typeof Fuse&&(t.settings.localSearch=!0),t.settings.showCommentsBlock=!1,t.settings.vbsButtons.edit=!1,t.settings.vbsButtons.downloadMedia=!1,t.settings.vbsButtons.downloadTranscript=!1,t.settings.vbsButtons.favorite=!1,t.settings.vbsButtons.remove=!1,t.settings.vbsButtons.share=!1,t.settings.vbsButtons.orderTranscript=!1),t.settings.localData&&(t.settings.apiVersion="2.0"),"undefined"==typeof Fuse&&(t.settings.localSearch=!1),t.settings.localSearch&&"undefined"==typeof localSearchHelper&&jQuery.ajax({url:t.settings.localSearchHelperUrl+"localSearchHelper.js",dataType:"script",async:!0}),"jwplayer"==t.settings.playerType){var o=jwplayer(t.settings.playerId).config.playlist;t.settings.hasPlaylist=!(!(o&&o.length>1)||t.settings.mediaId)}t.settings.markersInNativeTimeline&&(t.settings.showControlsBlock=!1),t.settings.restrictions.length>0&&(t.settings.vbsButtons.edit=t.settings.restrictions.indexOf("updateTranscript")>-1,t.settings.editKeywords=t.settings.restrictions.indexOf("manageKeywords")>-1,t.settings.vbsButtons.remove=t.settings.restrictions.indexOf("deleteFile")>-1,t.settings.vbsButtons.share=t.settings.restrictions.indexOf("manageShares")>-1)},t._setProperty=function(e,s){var a=s.toLowerCase();t.settings[s]="undefined"!=typeof e[a]?e[a]:t.settings[s]},t._setBlockWidth=function(e,s){var a=s.toLowerCase();"undefined"!=typeof e[a]&&(t.settings[s]=e[a]<220?220:e[a])},t.default_data={months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],customMarkers:{},speakers:{},allSpeakers:[],vbsSpeakers:{},keywords:{},duration:null,vclass:null,sclass:null,position:0,commentsThreads:null,startParams:[],played:0,playerDom:null,playerHeight:null,movelistner:!1,dragging:!1,draggingVol:!1,kf:!1,tf:!1,lspeaker:null,clicker:!1,waiterSave:!1,metadataWaiter:!1,isSaving:!1,searcht:null,searchHits:null,localYoutubeData:{},isMobile:!1,keywordClickEvent:null,playlist_meta:null,highlightSnippets:null},t.data={},e.fn.voicebase=function(s){return t.methods[s]?t.methods[s].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof s&&s?(e.error("Method "+s+" does not exist on jQuery.vbplugin"),void 0):t.methods.init.apply(this,arguments)},t}(jQuery);voiceBase=function(e,t){"use strict";return e.api={inited:!1,init:function(){this.inited=!0,this.parameters=jQuery.extend(!0,{},this.default_parameters),e.settings.mediaId?(this.parameters.mediaid=e.settings.mediaId,delete this.parameters.externalid):(this.parameters.externalid=e.settings.externalId,delete this.parameters.mediaid),e.settings.token||e.settings.example?(this.parameters.token=e.settings.token,delete this.parameters.apikey,delete this.parameters.password):(delete this.parameters.token,this.parameters.apikey=e.settings.apiKey,this.parameters.password=e.settings.password),e.api.response={metadata:null,keywords:null,transcript:null,comments:null},e.api.data={keywords:{},comments:{},tmp:{}},e.api.ready={metadata:!1,keywords:!1,transcript:!1,comments:!1},e.api.errors={processing:0,failure:0},this.showProcessingMsg=!1,this.endSearch=!1},default_parameters:{version:e.default_settings.apiVersion,ModPagespeed:"off"},parameters:{},getToken:function(t){if(e.common.isApi2_0())e.api2_0.getToken();else{var s={};jQuery.extend(s,this.parameters),s.action="getToken",s.timeout=t,delete s.mediaid,delete s.externalid,e.settings.restrictions&&e.settings.restrictions.length>0&&(s.privs=e.settings.restrictions.join(",")),e.api.call(s,e.api.setToken)}},setToken:function(t){"SUCCESS"==t.requestStatus?(e.settings.token=t.token,e.api.parameters.token=t.token,delete e.api.parameters.apikey,delete e.api.parameters.password,e.view.initWithToken()):alert(t.statusMessage)},getExampleToken:function(){var t={};e.api.callCustom(e.settings.exampleTokenUrl,t,e.api.setExampleToken)},setExampleToken:function(t){t.success===!0?(e.settings.token=t.token,e.api.parameters.token=t.token,e.view.initWithToken()):alert(t.message)},getMetaData:function(){e.data.metadataWaiter=setInterval(function(){if(e.data.metadataWaiter&&e.PlayerApi.isPlayerReady())if(clearInterval(e.data.metadataWaiter),e.data.metadataWaiter=null,e.settings.hasPlaylist&&e.settings.stream){var t=e.PlayerApi.getPlaylist();if(e.data.playlist_meta){var s=e.PlayerApi.getCurrentPlaylistItem(),a=e.PlayerApi.getPlaylistItemId(s);e.api.setMetaData(e.data.playlist_meta.metadata[a.id])}else e.api.getMetaDataForPlaylist(t)}else if(e.common.isApi2_0())e.settings.localData?e.api2_0.setMetaData(e.settings.localData):e.api2_0.getMetaData();else{var n={};jQuery.extend(n,e.api.parameters),n.action="getFileMetaData",n.confidence="0.0",e.api.call(n,e.api.setMetaData)}},10)},setMetaData:function(s){var a=e.helper.find(".vbs-media-block");if("SUCCESS"!=s.requestStatus&&(s=e.api.createMetaData()),"SUCCESS"==s.requestStatus&&"PROCESSING"!=s.response.fileStatus){s.self_made&&(a.find(".vbs-download-audio-btn").addClass("vbs-disable-button"),a.find(".vbs-del-btn").addClass("vbs-disable-button"),a.find(".vbs-star-btn").addClass("vbs-disable-button")),e.api.response.metadata=s,s.response.lengthMs?(e.data.duration=s.response.lengthMs/1e3,e.view.renderTimeInMediaTitle()):t(".vbs-time").hide(),e.helper.find(".voicebase_record_times").show(),e.helper.find(".vplayer").show();var n=t("#"+e.settings.playerId);if("jwplayer"==e.settings.playerType)e.data.playerDom="flash"===e.PlayerApi.getRenderingMode()?n.parent():n,e.data.playerDom.addClass("vbs-player-wrapper vbs-"+e.helper.randId()),e.helper.isMediaTypeEqualVideo()||e.data.playerDom.parent().addClass("vbs-media-audio");else if("kaltura"==e.settings.playerType)e.data.playerDom=t("#"+e.settings.playerId),e.data.playerDom.addClass("vbs-player-wrapper vbs-"+e.helper.randId());else if("jplayer"==e.settings.playerType){var r=e.instances[e.current_instance].player.interface;r&&(e.data.playerDom=r.getGui(),e.data.playerDom.addClass("vbs-player-wrapper vbs-"+e.helper.randId()))}else 0===t(".vbs-player-wrapper").length&&(e.data.playerDom=t("#"+e.settings.playerId),e.data.playerDom.before(vbsTemplates.render("players/playerWrapper",{randId:e.helper.randId()})));if(e.helper.isMediaTypeEqualVideo()){a.addClass("vbs-video"),t(".vbs-video .vbs-section-title").attr("data-title","Hide Video"),e.helper.find(".vbs-record-player").addClass("vbs-video");var i=e.helper.findc(".vbs-player-wrapper"),o=t("#"+e.settings.playerId).width();t("#"+e.settings.mediaBlock).insertBefore(i).css("width",o),o<e.settings.mediumResponsive&&o>=e.settings.minResponsive?a.addClass("less-600px"):o<e.settings.minResponsive&&a.addClass("less-600px").addClass("less-460px"),e.settings.vbsButtons.fullscreen&&a.find(".vbs-section-btns ul").append(vbsTemplates.render("players/expandBtn")),e.settings.expandMediaBlock||e.helper.find(".vbs-media-block .vbs-section-title").click()}else e.PlayerApi.hidePlayer();s.response.humanOrderStatus&&s.response.humanOrderDueDate&&e.helper.setOrderedButton(s.response.humanOrderDueDate),e.helper.adjustMediaTime(),e.view.favorite(s.response.isFavorite),e.helper.checkAutoStart()}else a.append(vbsTemplates.render("common/disabler")),e.helper.find(".vbs-record-player").append(vbsTemplates.render("common/disabler")),e.api.setErrors(s);e.api.ready.metadata=!0},getMetaDataForPlaylist:function(s){e.data.playlist_meta={},e.data.playlist_meta.promises=[],e.data.playlist_meta.metadata={};for(var a=0;a<s.length;a++){var n=s[a];e.api.setMetaDataPromise(n)}t.when.apply(this,e.data.playlist_meta.promises).then(function(){e.api.resolveMetaDataPromise(s)})},setMetaDataPromise:function(s){var a={};jQuery.extend(a,this.parameters),a.action="getFileMetaData",a.confidence="0.0",delete a.mediaid,delete a.externalid;var n;s.vbs_mediaid?a.mediaid=n=s.vbs_mediaid:s.vbs_externalid&&(a.externalid=n=s.vbs_externalid);var r=t.getJSON(e.settings.apiUrl,a).done(function(t){e.data.playlist_meta.metadata[n]=t}).fail(function(e){console.log(e)});e.data.playlist_meta.promises.push(r)},resolveMetaDataPromise:function(t){for(var s=[],a=0;a<t.length;a++){var n=t[a],r=e.PlayerApi.getPlaylistItemId(n),i=r.id;if(e.data.playlist_meta.metadata[i]){var o,l=e.data.playlist_meta.metadata[i].response;l?o=e.PlayerApi.getStreamUrl(l):(o=n.file,e.data.playlist_meta.metadata[i]=e.api.createMetaData());var d={file:o,title:n.title};r.isMediaid?d.vbs_mediaid=i:d.vbs_externalid=i,s.push(d),0===a&&e.api.setMetaData(e.data.playlist_meta.metadata[i])}}e.PlayerApi.loadFile(s)},setLocalMetaData:function(){e.data.localYoutubeData.metadata=e.api.createMetaData(),e.api.setMetaData(e.data.localYoutubeData.metadata)},createMetaData:function(){var t=1e3*e.PlayerApi.getDuration(),s=t>0?t:0;return{requestStatus:"SUCCESS",self_made:!0,response:{lengthMs:s,hasVideo:!0,isFavorite:!1}}},getKeywords:function(){var t={};jQuery.extend(t,this.parameters),t.action="getFileAnalytics",t.returnCategories="1",t.includeStartTimes=!0,t.useStemming=!0,e.settings.keywordsGroups&&(t.returnGroups=!0),e.api.call(t,e.keywords.view.createView)},getTranscript:function(){var t={};jQuery.extend(t,this.parameters),t.action="getKeywords",t.confidence="0.0",e.api.call(t,e.transcript.view.createView)},setPredictions:function(t){var s=e.helper.find(".vbs-predictions-block "),a=vbsTemplates.render("predictions/predictionsData",{predictions:t.predictions});s.find(".vbs-predictions-wrapper").html(a),s.show(),e.settings.expandPredictionsBlock||(s.find(".vbs-section-title").attr("data-title","Show Predictions").addClass("vbs-hidden"),s.find(".vbs-section-body").hide())},searchInfo:function(){var t=this;t.showProcessingMsg=!1,t.endSearch=!1,setTimeout(function(){t.showProcessingMsg=!0,t.endSearch||e.helper.showMessage("Processing your search...","info")},500),setTimeout(function(){if(!t.endSearch&&t.showProcessingMsg){e.helper.clearMessage();var s=vbsTemplates.render("messages/endSearchMessage");e.helper.appendMessage(s)}},2e3)},getSearch:function(t,s){var a=this,n=e.api.validateSearch(t);if(!n)return e.helper.showMessage("Search phrase is invalid. Its length can be up to 254 characters.","error"),e.helper.hideLoader(),!1;if(e.data.clicker=!0,e.data.keywordClickEvent||e.news.view.collapseNewsBlock(),s=!("undefined"!=typeof s&&s===!1),e.settings.localSearch)e.api.getLocalSearch(t,s);else{var r=t.join(" ").toLowerCase(),i={};jQuery.extend(i,this.parameters),i.action="searchFile",i.terms=r,e.api.searchInfo(),e.api.call(i,function(t,s){a.endSearch=!0,t.numberOfHits>1e3&&e.helper.showMessage("Displaying your search results...","info"),e.api.setSearch(t,s)},{start:s,terms:t})}},validateSearch:function(e){var t=e.join(" ");return t.length<255},getLocalSearch:function(s,a){var n,r=this;window.Worker&&"undefined"!=typeof localSearchHelper?(e.api.searchInfo(),e.data.searchWorker=new Worker(e.settings.localSearchHelperUrl+"localSearchWorker.js"),e.data.searchWorker.onerror=function(t){e.helper.showMessage("Search error!","error"),console.log(["ERROR: Line ",t.lineno," in ",t.filename,": ",t.message].join(""))},e.data.searchWorker.onmessage=function(i){clearInterval(e.events.time),e.events.time=null,r.endSearch=!0,n=i.data.results;var o=0;n.hits.hits.forEach(function(e){o+=e.hits.length}),o>1e3&&e.helper.showMessage("Displaying your search results...","info");var l=setInterval(function(){l&&t(".vbs-markers").find(".vbs-marker").length===o&&(clearInterval(l),l=null,e.helper.clearMessage(),e.helper.setOnTimeInterval())},100);setTimeout(function(){e.api.setSearch(n,{start:a,terms:s})},10)},e.data.searchWorker.postMessage({transcript:e.api.response.transcript.transcript,terms:s,isApi2_0:e.common.isApi2_0()})):(n=localSearchHelper.localTranscriptSearch(e.api.response.transcript.transcript,s),e.api.setSearch(n,{start:a,terms:s}))},setSearch:function(s,a){console.time("setSearch");var n=a.start,r=a.terms;e.data.clicker=!1;var i=e.helper.find(".vbs-record-timeline-wrap");e.data.markersStyles={markersWrapper:i,markersContainer:i.find(".vbs-markers"),markersWrapperWidth:i.width()};var o={};if(e.helper.find(".vbs-widget .vbs-word").each(function(e,s){var a=t(s),n=a.find(".vbs-search_word").text().replace(/"/g,"").trim().toLowerCase();o[n]=a.find(".vbs-marker").css("border-bottom-color")}),"SUCCESS"==s.requestStatus){var l=[];if(s.hits.length){var d=0,c="";s.hits.hits.map(function(t){var s=[],a=[];t.hits.map(function(n){if(e.speakers.filterResultForSpeaker(n.time)){s=s.concat(n.time);var r=n.phrase?n.phrase:e.keywords.view.getPhraseByTime(n.time,n.end,t.term);a=a.concat(r)}}),c+=e.view.markerWidget(s,a,o[t.term]),l=l.concat(s),d++}),setTimeout(function(){c.length&&e.helper.find(".vbs-next-action-btn").removeClass("vbs-next-notactive"),e.data.markersStyles.markersContainer.append(c)},0),e.settings.editKeywords&&s.hits.hits.length>0?(e.data.searcht=l,e.data.searchHits=s.hits.hits,e.keywords.view.checkKeyword(r,l,s.hits.hits)):(e.data.searcht=null,e.data.searchHits=null)}l.sort(function(e,t){return e-t}),n&&e.PlayerApi.seek(l[0])}else"FAILURE"==s.requestStatus&&e.helper.hideLoader();e.helper.clearMessage(),console.timeEnd("setSearch")},downloadAudio:function(){var t={};jQuery.extend(t,this.parameters),t.action="getFileMetadata",e.api.call(t,e.api.setDownloadAudio)},setDownloadAudio:function(t){"SUCCESS"==t.requestStatus?window.location=t.response.downloadMediaUrl:e.helper.showMessage(t.statusMessage,"error")},favorite:function(t){var s={};jQuery.extend(s,this.parameters),t="undefined"!=typeof t?t:!0,s.action="updateMediaFile",s.favorite=t?"add":"remove",e.view.favorite(t),e.api.call(s,e.api.sendFavorite)},sendFavorite:function(t){"SUCCESS"!=t.requestStatus&&(e.view.favoriteToggle(),e.helper.showMessage(t.statusMessage,"error"))},getAutoNotesHtmlURL:function(){var t={};return jQuery.extend(t,this.parameters),t.action="getAutoNotesHtml",t.content=!0,e.settings.apiUrl+"?"+e.common.getStringFromObject(t)},editKeyword:function(s,a,n,r){n=n.trim();var i={};jQuery.extend(i,this.parameters),i.keywordname=a,i.action="moveKeyword",i.categoryname="ALL TOPICS"!=n?n:"",i.mode=s;var o=t(r).parent();e.api.call(i,e.api.responseEditKeywords,{mode:s,li:o})},responseEditKeywords:function(t,s){"SUCCESS"==t.requestStatus?e.keywords.view.editKeyword(s.mode,s.li):e.helper.showMessage(t.statusMessage,"error")},removeKeyword:function(s,a,n){if(s){a=a.trim();var r={};jQuery.extend(r,this.parameters),r.action="deleteKeyword",r.keywordname=s,r.categoryname="ALL TOPICS"!=a?a:"";var i=t(n).parent();e.api.call(r,e.api.responseRemoveKeyword,{category_name:a,keyword_name:s,li:i})}},responseRemoveKeyword:function(t,s){"SUCCESS"==t.requestStatus?e.keywords.view.removeKeyword(s.category_name,s.keyword_name,s.li):e.helper.showMessage(t.statusMessage,"error")},removeTopic:function(t){var s={};jQuery.extend(s,this.parameters),s.categoryname=t,s.action="deleteKeywordCategory",e.api.call(s,e.api.responseRemoveTopic)},responseRemoveTopic:function(t){"SUCCESS"==t.requestStatus?e.keywords.view.removeTopic():e.helper.showMessage(t.statusMessage,"error")},addKeywords:function(t,s){var a={};jQuery.extend(a,this.parameters),a.keyword=t,a.action="addKeyword",e.api.call(a,e.api.responseAddKeywords,{keywords:t,times:s})},responseAddKeywords:function(t,s){"SUCCESS"==t.requestStatus?e.keywords.view.addKeywords(s.keywords,s.times):e.helper.showMessage(t.statusMessage,"error")},saveTrancript:function(t){var s={};jQuery.extend(s,this.parameters),s.content=t,s.action="updateTranscript",e.transcript.view.setIsSaving(!0),e.api.callPost(s,e.api.responseSaveTrancript,t)},responseSaveTrancript:function(t){"SUCCESS"==t.requestStatus?setTimeout(function(){e.api.triggerTranscriptStatus()},1e3*e.settings.transcriptCheckTimer):e.transcript.view.saveTranscriptError(t.statusMessage)},triggerTranscriptStatus:function(){var t={};jQuery.extend(t,this.parameters),t.action="getFileStatus",e.api.call(t,e.api.responseTriggerTranscriptStatus)},responseTriggerTranscriptStatus:function(t){"SUCCESS"!=t.requestStatus||"PROCESSING"!=t.fileStatus&&"REPROCESSING"!=t.fileStatus?"SUCCESS"==t.requestStatus&&"ERROR"==t.fileStatus?e.transcript.view.saveTranscriptError(t.response):"SUCCESS"==t.requestStatus?e.transcript.view.saveTranscriptComplete():"FAILURE"==t.requestStatus?e.transcript.view.saveTranscriptError(t.statusMessage):e.helper.showMessage(t.statusMessage,"error"):setTimeout(function(){e.api.triggerTranscriptStatus()},1e3*e.settings.transcriptCheckTimer)},call:function(t,s,a){a="undefined"!=typeof a?a:!1,this.inited||this.init();var n=9===e.common.isIe();jQuery.ajax({url:e.settings.apiUrl,type:"GET",data:t,dataType:n?"jsonp":"json"}).done(function(e){s(e,a)}).fail(function(e){console.log(e)})},callPost:function(t,s,a){a="undefined"!=typeof a?a:!1;var n=9===e.common.isIe();jQuery.ajax({url:e.settings.apiUrl,type:"POST",data:t,dataType:n?"jsonp":"json"}).done(function(e){s(e,a)}).fail(function(e){console.log(e)})},callCustom:function(t,s,a,n){n="undefined"!=typeof n?n:!1;var r=9===e.common.isIe();jQuery.ajax({url:t,type:"POST",data:s,dataType:r?"jsonp":"json"}).done(function(e){a(e,n)}).fail(function(e){console.log(e)})},setErrors:function(t){"FAILURE"==t.requestStatus?e.api.errors.failure++:t.response&&"PROCESSING"==t.response.fileStatus?e.api.errors.processing++:"PROCESSING"==t.fileStatus&&e.api.errors.processing++}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.api2_0={getToken:function(){var s=e.settings.apiKey,a=e.settings.password,n=e.settings.apiUrl+"access/users/+"+s.toLowerCase()+"/tokens";t.ajax({type:"GET",url:n,headers:{Authorization:"Basic "+btoa(s+":"+a)},success:function(t){t.tokens&&t.tokens.length>0&&e.api.setToken({token:t.tokens[0].token,requestStatus:"SUCCESS"})},error:function(e,t,s){console.log(s+": Error "+e.status)}})},getMetaData:function(){var s=e.settings.apiUrl+"media/"+e.settings.mediaId;t.ajax({type:"GET",url:s,beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e.settings.token)},success:function(t){e.api2_0.setMetaData(t)},error:function(e,t,s){console.log(s+": Error "+e.status)}})},setMetaData:function(t){var s=t.media,a={requestStatus:"PLUGIN"};s&&s.metadata&&s.metadata.length&&(a={requestStatus:"SUCCESS",response:{lengthMs:s.metadata.length.milliseconds}}),e.api.setMetaData(a),s&&(s.keywords&&e.api2_0.setKeywords(s.keywords),s.transcripts&&e.api2_0.setTranscript(s.transcripts),s.predictions&&s.predictions.latest&&s.predictions.latest.detections&&e.api2_0.setUtterances(s.predictions.latest.detections),e.api.ready.comments=!0)},setKeywords:function(t){var s=null;if(s=t.words?t:s,s=t.latest?t.latest:s,!s)return!1;var a={requestStatus:"SUCCESS",keywords:s.words||[],categories:s.categories||{},groups:s.groups||[]};e.keywords.view.createView(a)},parseGroups:function(e){return Object.keys(e).map(function(t){var s=e[t],a=Object.keys(s).map(function(e){var t=s[e],a=t.map(function(e){return e.s});return{name:e,t:{unknown:a}}});return{name:t,type:"group",keywords:a}})},setTranscript:function(t){var s=null;if(s=t.words?t:s,s=t.latest?t.latest:s,!s)return!1;var a={requestStatus:"SUCCESS",transcriptType:s.type,transcript:s.words};e.transcript.view.createView(a)},setPredictions:function(t){var s=null;if(s=t.predictions?t.predictions:s,s=t.latest&&t.latest.predictions?t.latest.predictions:s,!s)return!1;var a={requestStatus:"SUCCESS",predictions:s};e.api.setPredictions(a)},setUtterances:function(t){e.utterances.view.createViewForV2(t)}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.comments={getCountComments:function(e){var t=0;return e&&e.forEach(function(e){t+=e.comments.length}),t},canCommentEdit:function(){var t=!0;return e.settings.restrictions.length>0&&(t=e.settings.restrictions.indexOf("manageComments")>-1||e.settings.restrictions.indexOf("manageOwnComments")>-1),t},view:{setComments:function(s){if("SUCCESS"==s.requestStatus){var a=e.comments.getCountComments(s.response.threads);e.data.commentsThreads=s.response.threads;var n=e.comments.canCommentEdit(),r=vbsTemplates.render("comments/commentThreads",{threads:s.response.threads,parseTime:e.common.parseTime,showCommentsBtn:n,countComments:a}),i=a>0?a+" Comment(s)":"No Comments";t(".vbs-comments-block .vbs-section-name").attr("style","width: 200px;").text(i),e.comments.view.commentsWidget(r,e.api.data.tmp.hide),e.api.data.tmp.rebuild&&e.comments.view.commentsTWidget()}else{var o=e.helper.find(".vbs-comments-block");o.append(vbsTemplates.render("common/disabler")),e.settings.tabView||(o.show(),o.find(".vbs-section-body").hide(),o.find(".vbs-section-title .vbs-section-name").text("Comments")),e.api.setErrors(s)}e.api.ready.comments=!0},sendComment:function(t){"SUCCESS"==t.requestStatus?e.comments.api.getComments(e.helper.find(".vbs-comments-block .vbs-section-title").hasClass("vbs-hidden"),!0):e.helper.showMessage(t.statusMessage,"error")},sendEditComment:function(t){var s=e.api.data.tmp.commentParent,a=e.api.data.tmp.commentData;if("SUCCESS"==t.requestStatus){s.parents(".vbs-comment-content").find(".vbs-comment-message p").text(a.comment),s.remove();var n=a.comment_id;e.data.commentsThreads.forEach(function(e){e.comments.forEach(function(e){e.id==n&&(e.content=a.comment)})}),e.comments.view.commentsTWidget()}else s.find("textarea").attr("disabled",!1),e.helper.showMessage(t.statusMessage,"error")},commentsWidget:function(t,s){var a=e.helper.find(".vbs-comments-block");a.find(".vbs-section-body").html(t),s&&(a.find(".vbs-section-body").hide(),a.find(".vbs-section-title").addClass("vbs-hidden")),a.slideDown("fast")},commentsTWidget:function(){if(!e.data.commentsThreads)return!1;var t=vbsTemplates.render("comments/commentsTimeline",{threads:e.data.commentsThreads,duration:e.data.duration,getOffset:e.PlayerApi.getOffset});e.helper.find(".vbs-comments-wrapper-block").html(t),e.settings.markersInNativeTimeline&&e.settings.cssPathForPlayerFrame&&e.comments.view.commentsWidgetForNativeTimeline()},resizeCommentsTWidget:function(){var s=e.helper.find(".vbs-record-timeline-wrap").width(),a=e.data.duration;e.helper.find(".vbs-comments-wrapper-block div.vbs-comments-wrapper ").each(function(){var e=t(this),n=e.attr("stime"),r=n*s/a;e.css("left",r)})},commentsWidgetForNativeTimeline:function(){var s=t(".vbs-comments-wrapper-block").find(".vbs-comments-wrapper"),a=e.PlayerApi.getPlayerIframe(),n=a.find(".scrubber");0===n.find(".vbs-comments-wrapper-block").length&&n.append(vbsTemplates.render("comments/kalturaWrapperComments"));var r=n.find(".vbs-comments-wrapper-block");r.empty(),t.each(s,function(t,s){e.comments.view.createScruberComment(s,r)})},createScruberComment:function(s,a){var n=t(s).attr("stime"),r=n/e.data.duration*100,i=t(s).find("a").text(),o=t(vbsTemplates.render("comments/kalturaInlineComment",{duration:e.data.duration,left:r,stime:n,commentText:i}));a.append(o)},toggleBlockHandler:function(t){t.toggleClass("vbs-hidden");var s=t.parents(".vbs-comments-block").find(".vbs-section-body");t.hasClass("vbs-hidden")?(t.attr("data-title","Show Comments"),s.slideUp()):(t.attr("data-title","Hide Comments"),s.slideDown(),e.news.view.collapseNewsBlock())},clickAddCommentHandler:function(s){var a=e.helper.find(".vbs-comments-popup"),n=e.helper.find(".vbs-comments-block .vbs-section-btns");if(s.hasClass("vbs-active"))a.fadeOut("fast",function(){n.find(".vbs-comments-btn").removeClass("vbs-active"),a.remove()});else{e.helper.find(".vbs-comments-popup").each(function(){t(this).remove()});var r=vbsTemplates.render("comments/commentPopup",{time:e.data.position,parseTime:e.common.parseTime});n.find(".vbs-clearfix li").append(r),n.find(".vbs-comments-btn").addClass("vbs-active"),e.helper.find(".vbs-comments-popup").show(),t("#vbs-comment-text").focus()}e.news.view.collapseNewsBlock()},confirmAddCommentHandler:function(t){e.news.view.collapseNewsBlock();var s=t.parent(".vbs-comment-footer").parent(".vbs-comments-popup"),a={},n=s.find("#vbs-comment-text").val(),r=s.find("#vbs-comment-timeline").attr("vbct");return""===n?(alert("Text of comment is required."),!1):(e.helper.find(".vbs-comments-popup").fadeOut("fast",function(){e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active"),e.helper.find(".vbs-comments-popup").addClass("vbs-hidden")}),a.comment=n,a.comment_timestamp=r,a.parent_comment_id=!1,e.comments.api.addComment(a),void 0)},playCommentHandler:function(t){var s=setTimeout(function(){clearTimeout(s),e.PlayerApi.seek(t.parent(".vbs-comment-popup-row").find("#vbs-comment-timeline").attr("vbct"))},250)},replyHandler:function(t){var s=t.parent(".vbs-comment-reply-wrapper"),a=vbsTemplates.render("comments/commentReplyPopup",{c_id:t.attr("c_id")});e.comments.view.toggleCreatingPopup(s,a)},replyConfirmHandler:function(t){var s=t.parents(".vbs-comment-footer").parents(".vbs-comments-popup"),a={},n=s.find("#vbs-comment-reply-text").val(),r=t.attr("c_id");return""===n?(alert("Text of comment is required."),!1):(s.parents(".vbs-comment-reply-wrapper").find(".vbs-comments-popup").remove(),a.comment=n,a.comment_timestamp=!1,a.parent_comment_id=r,e.comments.api.addComment(a),void 0)},editHandler:function(t){var s=t.attr("c_tm"),a=t.parents(".vbs-comment-row"),n=a.find(".vbs-comment-message p").text(),r=vbsTemplates.render("comments/commentEditPopup",{isFirstComment:a.hasClass("vbs-answer1"),time:s,parseTime:e.common.parseTime,c_id:t.attr("c_id"),commentText:n}),i=t.parent(".vbs-comment-edit-btn-wrapper"),o=e.comments.view.toggleCreatingPopup(i,r);o&&i.find("textarea").focus()},editConfirmHandler:function(t){var s=t.parents(".vbs-comments-popup"),a={},n=s.find("textarea").val(),r=t.attr("c_id");return""===n?(alert("Text of comment is required."),!1):(a.comment=n,a.comment_timestamp=!1,a.comment_id=r,s.find("textarea").attr("disabled",!0),e.api.data.tmp.commentParent=s,e.api.data.tmp.commentData=a,e.comments.api.editComment(a),void 0)},deleteHandler:function(t){var s=t.parent(".vbs-comment-delete-btn-wrapper"),a=vbsTemplates.render("comments/commentDeletePopup",{c_id:t.attr("c_id")});e.comments.view.toggleCreatingPopup(s,a)},deleteConfirmHandler:function(t){var s=t.attr("c_id");e.comments.api.deleteComment(s),t.parents(".vbs-comment-edit-wrapper").remove()},cancelHandler:function(t){var s=t.parents(".vbs-comments-popup");s.fadeOut("fast",function(){e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active"),s.addClass("vbs-hidden").remove()})},toggleCreatingPopup:function(t,s){var a=!0;return 0===t.find(".vbs-comments-popup").length?(e.helper.find(".vbs-comments-popup").addClass("old_reply_popup"),t.append(s),t.find(".vbs-comments-popup").show()):(a=!1,t.find(".vbs-comments-popup").remove()),e.helper.find(".vbs-comments-popup.old_reply_popup").remove(),e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active"),a},commentTimeHandler:function(t){var s=t.attr("data-vbct");s&&e.PlayerApi.seek(s)},updateTimeInPopup:function(t){var s=t||0===t?t:e.data.played;
e.helper.find(".vbs-comments-add-popup #vbs-comment-timeline").html(e.common.parseTime(s)).attr("vbct",s)}},api:{getComments:function(t,s){var a={};jQuery.extend(a,e.api.parameters),e.api.data.tmp.hide="undefined"!=typeof t?t:e.settings.expandCommentsBlock?!1:!0,e.api.data.tmp.rebuild="undefined"!=typeof s?s:!1,a.action="getComments",e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(a.username=e.settings.commentsUsername),e.api.call(a,e.comments.view.setComments)},addComment:function(t){var s={};jQuery.extend(s,e.api.parameters),s.action="addComment",s.comment=t.comment,t.comment_timestamp!==!1&&(s.timeStamp=t.comment_timestamp),t.parent_comment_id!==!1&&(s.commentId=t.parent_comment_id),e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(s.username=e.settings.commentsUsername),e.settings.commentsUserhandle&&""!==e.settings.commentsUserhandle&&(s.userhandle=e.settings.commentsUserhandle),e.api.call(s,e.comments.view.sendComment)},editComment:function(t){var s={};jQuery.extend(s,e.api.parameters),s.action="editComment",s.comment=t.comment,s.commentId=t.comment_id,e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(s.username=e.settings.commentsUsername),e.api.call(s,e.comments.view.sendEditComment)},deleteComment:function(t){var s={};jQuery.extend(s,e.api.parameters),s.action="deleteComment",s.commentId=t,e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(s.username=e.settings.commentsUsername),e.api.call(s,e.comments.view.sendComment)}},events:{init:function(s){e.settings.toggleBlocks&&e.settings.toggleCommentBlock&&e.helper.find(".vbs-comments-block .vbs-section-title").on(s,function(s){s.preventDefault(),e.comments.view.toggleBlockHandler(t(this))}),e.helper.find(".vbs-comments-block .vbs-section-btns").on(s,".vbs-comments-btn",function(s){return s.preventDefault(),"undefined"!=typeof e.settings.webHooks.comment?(e.settings.webHooks.comment(),!1):(e.comments.view.clickAddCommentHandler(t(this)),void 0)}),e.helper.find(".vbs-comments-block").on(s,".vbs-section-header .vbs-confirm-btn",function(s){s.preventDefault(),e.comments.view.confirmAddCommentHandler(t(this))}),e.helper.find(".vbs-comments-block").on(s,".vbs-play-btn",function(s){s.preventDefault(),e.news.view.collapseNewsBlock(),e.comments.view.playCommentHandler(t(this))}),e.helper.find(".vbs-comments-block").on(s,".vbs-comment-time",function(s){s.preventDefault(),e.comments.view.commentTimeHandler(t(this)),e.news.view.collapseNewsBlock()}),e.helper.find(".vbs-comments-block").on(s,".vbs-comment-reply",function(s){return s.preventDefault(),e.news.view.collapseNewsBlock(),"undefined"!=typeof e.settings.webHooks.comment?(e.settings.webHooks.comment(),!1):(e.comments.view.replyHandler(t(this)),void 0)}),e.helper.find(".vbs-comments-block").on(s,".vbs-comment-edit",function(s){return s.preventDefault(),e.news.view.collapseNewsBlock(),"undefined"!=typeof e.settings.webHooks.commentEdit?(e.settings.webHooks.commentEdit(),!1):(e.comments.view.editHandler(t(this)),void 0)}),e.helper.find(".vbs-comments-block").on(s,".vbs-section-header .vbs-cancel-btn, .vbs-comment-reply-wrapper .vbs-cancel-btn, .vbs-comment-edit-btn-wrapper .vbs-cancel-btn, .vbs-comment-delete-btn-wrapper .vbs-confirm-btn",function(s){s.preventDefault(),e.news.view.collapseNewsBlock(),e.comments.view.cancelHandler(t(this))}),e.helper.find(".vbs-comments-block").on(s,".vbs-comment-reply-wrapper .vbs-confirm-btn",function(s){s.preventDefault(),e.news.view.collapseNewsBlock(),e.comments.view.replyConfirmHandler(t(this))}),e.helper.find(".vbs-comments-block").on(s,".vbs-comment-edit-btn-wrapper .vbs-confirm-btn",function(s){s.preventDefault(),e.news.view.collapseNewsBlock(),e.comments.view.editConfirmHandler(t(this))}),e.helper.find(".vbs-comments-block").on(s,".vbs-comment-delete",function(s){s.preventDefault(),e.news.view.collapseNewsBlock(),e.comments.view.deleteHandler(t(this))}),e.helper.find(".vbs-comments-block").on(s,".vbs-comment-delete-btn-wrapper .vbs-cancel-btn",function(s){return s.preventDefault(),"undefined"!=typeof e.settings.webHooks.commentDelete?(e.settings.webHooks.commentDelete(),!1):(e.comments.view.deleteConfirmHandler(t(this)),void 0)})}}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return String.prototype.padLeft=function(e){return new Array(e-this.length+1).join("0")+this},jQuery.extend(jQuery.expr[":"],{wordtime:function(e,s,a){var n=parseFloat(t(e).attr("t")),r=a[3].split(/\s?,\s?/),i=parseFloat(r[0]),o=parseFloat(r[1]);return!isNaN(n)&&!isNaN(i)&&!isNaN(o)&&o>=n&&n>=i}}),e.common={rand:function(){return Math.ceil(1e9*Math.random())},parseTime:function(e){var t=Math.floor(e/3600)+"",s=Math.floor(e%3600/60)+"",a=Math.floor(e%3600%60)+"";return t.padLeft(2)+":"+s.padLeft(2)+":"+a.padLeft(2)},objectToArray:function(e){return Object.keys(e).map(function(t){return e[t]})},getStringFromObject:function(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")},hasTermInArray:function(t,s){for(var a=!1,n=0;n<t.length;n++){var r=t[n];if(r=e.common.replaceTrimAndLower(r),r===s){a=!0;break}}return a},keysToLowerCase:function(e){for(var t=Object.keys(e),s=t.length;s--;){var a=t[s];a!==a.toLowerCase()&&(e[a.toLowerCase()]=e[a],delete e[a])}return e},uniqueArray:function(e){e=e?e:[];for(var t={},s=0;s<e.length;s++)t[e[s]]=!0;return e=Object.keys(t)},generateRandomColor:function(){return"#"+("000000"+(16777215*Math.random()<<0).toString(16)).slice(-6)},hidePopup:function(e){e.fadeOut("fast",function(){t(this).remove()})},isApi2_0:function(){return"2.0"===e.settings.apiVersion},unEscapeHtml:function(e){return e.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;lt;/g,"&lt;").replace(/&amp;gt;/g,"&gt;")},replaceAndTrim:function(e){return e.replace(/<br\s*[\/]?>/gi,"").replace(/\n/gi,"").trim()},replaceN:function(e){return e.replace(/\\n/g,"<br>").replace(/\n/g,"<br>")},replaceTrimAndLower:function(e){return e.replace(/"/g,"").toLowerCase().trim()},isIe:function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")?parseInt(e.split("msie")[1]):!1},isRetina:function(){var e="(-webkit-min-device-pixel-ratio: 1.5),            (min--moz-device-pixel-ratio: 1.5),            (-o-min-device-pixel-ratio: 3/2),            (min-resolution: 1.5dppx)";return window.devicePixelRatio>1?!0:window.matchMedia&&window.matchMedia(e).matches?!0:!1},isMobile:function(){if(e.data.isMobile)return e.data.isMobile;var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),e.data.isMobile=t,t},is_iDevice:function(){var e=!1;return function(t){/ip(hone|od|ad)/i.test(t)&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}},e}(voiceBase,jQuery),function(e){"use strict";e.console=e.console||{};for(var t,s,a=e.console,n={},r=function(){},i="memory".split(","),o="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");t=i.pop();)a[t]||(a[t]=n);for(;s=o.pop();)"function"!=typeof a[s]&&(a[s]=r)}("undefined"==typeof window?this:window),voiceBase=function(e,t){"use strict";return e.events={time:null,onTime:function(){if(e.instances[e.current_instance].player&&e.instances[e.current_instance].player.interface){Math.round(e.data.position)!=Math.round(e.PlayerApi.getPosition())&&(e.data.clicker||e.helper.hideLoader(),e.settings.transcriptHighlight!==!1&&e.transcript.view.highlight(e.PlayerApi.getPosition()),e.data.movelistner=!1),e.data.position===e.data.duration&&e.helper.hideLoader();var t=e.data.position=e.PlayerApi.getPosition();"PLAYING"===e.PlayerApi.getStatus()&&-1!==e.PlayerApi.getDuration()&&e.data.duration!==e.PlayerApi.getDuration()&&(e.data.duration=e.PlayerApi.getDuration(),e.view.renderTimeInMediaTitle());var s=e.data.duration;if(e.data.dragging===!1&&e.data.movelistner===!1&&"undefined"!=typeof t&&s){e.helper.find(".vbs-player-slider").css("left",100*t/s+"%"),e.helper.find(".vbs-record-progress").css("width",100*t/s+"%");var a=e.common.parseTime(t);e.helper.find(".vbs-ctime").html(a),e.comments.view.updateTimeInPopup(t),e.helper.find(".vbs-share-popup").find(".vbsp-time").attr("vbct",t).html(a)}e.data.clicker||("PAUSED"==e.PlayerApi.getStatus()?e.helper.find(".vbs-player-control .vbs-play-btn").removeClass("vbs-playing").attr("data-title","Play"):"PLAYING"==e.PlayerApi.getStatus()&&e.helper.find(".vbs-player-control .vbs-play-btn").addClass("vbs-playing").attr("data-title","Pause")),e.PlayerApi.getBuffer()&&e.helper.find(".vbs-record_buffer").css("width",e.PlayerApi.getBuffer()+"%"),e.speakers.view.speakerIsSpeaking()}},registerEvents:function(){var s=e.common.isMobile()?"touchstart":"touchstart click";e.settings.toggleBlocks&&e.settings.toggleMediaBlock&&e.helper.find(".vbs-media-block .vbs-section-title").off(s).on(s,function(s){s.preventDefault();var a=t(this);a.toggleClass("vbs-hidden"),a.hasClass("vbs-hidden")?(e.data.playerHeight=e.data.playerDom.height(),"video_js"==e.settings.playerType||"jplayer"==e.settings.playerType||"jwplayer"==e.settings.playerType&&"html5"===e.PlayerApi.getRenderingMode()?e.data.playerDom.hide():e.data.playerDom.css({height:"0px"}),e.helper.find(".vbs-expand-btn").hide(),e.helper.findc(".vbs-player-wrapper .vbs-time").hide(),a.parents(".vbs-media-block").hasClass("vbs-video")&&t(".vbs-tooltip").text("Show Video"),a.attr("data-title","Show Video")):("video_js"==e.settings.playerType||"jplayer"==e.settings.playerType||"jwplayer"==e.settings.playerType&&"html5"===e.PlayerApi.getRenderingMode()?e.data.playerDom.show():e.data.playerDom.css({height:e.data.playerHeight+"px"}),e.helper.find(".vbs-expand-btn").show(),e.helper.findc(".vbs-player-wrapper .vbs-time").show(),a.parents(".vbs-media-block").hasClass("vbs-video")&&t(".vbs-tooltip").text("Hide Video"),a.attr("data-title","Hide Video"))}),e.settings.markersInNativeTimeline&&t(document).off("DOMSubtreeModified",".vbs-markers").on("DOMSubtreeModified",".vbs-markers",function(t){t.target.innerHTML.length>0?e.view.markerWidgetForNativeTimeline():e.view.clearScrubberOfMarks()}),e.helper.find(".vbs-markers,.vbs-custom-markers").on(s,"a.vbs-marker",function(s){s.preventDefault();var a=t(this).attr("stime");return e.PlayerApi.seek(a),!1}),e.helper.find(".vbs-comments-wrapper-block").on(s,".vbs-comment-preview a",function(s){s.preventDefault(),e.news.view.collapseNewsBlock();var a=t(this).attr("stime");return e.PlayerApi.seek(a),!1}),t("."+e.data.vclass+" .vbs-player-control, ."+e.data.vclass+" .vbs-edit-mode-prewrapper").on(s,".vbs-play-btn",function(s){s.preventDefault();var a=t(this),n=t(".vbs-tooltip");return a.hasClass("vbs-playing")?(a.removeClass("vbs-playing").attr("data-title","Play"),e.helper.track("pause"),n.text("Play"),e.helper.hideLoader(),e.PlayerApi.pause()):(e.helper.track("play"),a.addClass("vbs-playing").attr("data-title","Pause"),n.text("Pause"),e.helper.showLoader(),e.PlayerApi.play()),!1}),t(document).off(s,".vbs-prev-btn").on(s,".vbs-prev-btn",function(t){t.preventDefault();var s=e.PlayerApi.getPosition()-15;return s=0>s?.001:s,e.PlayerApi.seek(s),!1}),e.helper.find(".vbs-next-action-btn").on(s,function(s){if(s.preventDefault(),!t(this).hasClass("vbs-next-notactive")){var a=e.helper.find(".vbs-record-timeline-wrap .vbs-markers");e.helper.moveToNextMarker(a)}}),t(window).off("resize.vbs_resize").on("resize.vbs_resize",function(){if(e.view.resizeTimelineElements(),e.common.isMobile()){var s=e.PlayerApi.getMobilePlayerSize();e.PlayerApi.setSizePlayer(s.mobile_width,s.mobile_height),t("#"+e.settings.mediaBlock).css("width",e.helper.getMobileWidth())}e.view.checkResponsive()}),t(document).off("mousedown",".vbs-record-timeline-wrap .vbs-dragger").on("mousedown",".vbs-record-timeline-wrap .vbs-dragger",function(s){s.preventDefault();var a=t(this).parents(".vbs-record-timeline-wrap");if(0===s.button){var n=100*(s.pageX-a.offset().left)/a.width();e.helper.find(".vbs-player-slider").css("left",n+"%"),e.helper.find(".vbs-record-progress").css("width",n+"%"),e.data.movelistner=!0,e.data.dragging=!0}}).off("mousemove",".vbs-record-timeline-wrap .vbs-dragger").on("mousemove",".vbs-record-timeline-wrap .vbs-dragger",function(s){s.preventDefault();var a=t(this).parents(".vbs-record-timeline-wrap"),n=100*(s.pageX-a.offset().left)/a.width();n>100?n=100:0>n&&(n=0),e.data.played=Math.round(e.data.duration*n/100),e.data.dragging&&(e.helper.find(".vbs-player-slider").css("left",n+"%"),e.helper.find(".vbs-record-progress").css("width",n+"%"),e.helper.find(".vbs-ctime").html(e.common.parseTime(e.data.played)),e.helper.find(".vbs-share-popup .vbsp-time").html(e.common.parseTime(e.data.played)).attr("vbct",e.data.played),e.comments.view.updateTimeInPopup(null))}).off("mouseup.vbs_mouseup").on("mouseup.vbs_mouseup",function(){if(e.data.dragging&&(e.PlayerApi.seek(e.data.played),e.helper.track("seek",e.data.played),e.helper.find(".vbs-share-popup .vbsp-time").html(e.common.parseTime(e.data.played)).attr("vbct",e.data.played),e.comments.view.updateTimeInPopup(null),e.helper.find("#vbs-share-position").is(":checked"))){var s={};s.vbt=e.data.played;var a=e.helper.getNewUrl(s);t("#vbsp-url").val(a),"undefined"!=typeof addthis&&addthis.update("share","url",a)}e.data.dragging=!1}),e.helper.find(".vbs-markers,.vbs-custom-markers").on({mouseover:function(s){e.helper.find('[ctime="'+t(s.target).parent().attr("stime")+'"]').fadeIn(75)},mouseout:function(s){e.helper.find('[ctime="'+t(s.target).parent().attr("stime")+'"]').fadeOut(100)}}),e.utterances.events.init(s),e.helper.find(".vbs-volume-toolbar, ."+e.data.vclass+" .vbs-edit-mode-prewrapper").on(s,".vbs-volume-btn",function(s){s.preventDefault();var a=t(this),n=e.helper.find(".vbs-volume-toolbar-block");if(a.hasClass("show"))n.fadeOut("fast"),a.removeClass("show");else{var r=e.PlayerApi.getVolume();e.PlayerApi.setUiVolume(r),n.fadeIn(100),a.addClass("show")}}),t(document).off("mousedown",".vbs-volume-toolbar-block").on("mousedown",".vbs-volume-toolbar-block",function(s){var a=t(this);if(0===s.button){var n=100-100*(s.pageY-a.find(".vbs-volume-slider").offset().top)/t(this).height();n>100?n=100:0>n&&(n=0),e.PlayerApi.setUiVolume(n),e.PlayerApi.setVolume(n),e.data.draggingVol=!0}}).off("mousemove",".vbs-volume-toolbar-block").on("mousemove",".vbs-volume-toolbar-block",function(s){s.preventDefault();var a=t(this);if(e.data.draggingVol){var n=100-100*(s.pageY-a.find(".vbs-volume-slider").offset().top)/t(this).height();n>100?n=100:0>n&&(n=0),e.PlayerApi.setUiVolume(n),e.PlayerApi.setVolume(n)}}).on("mouseup mouseleave",function(){e.data.draggingVol=!1}),e.helper.find(".vbs-select-language-wrapper .vbs-select-dropdown").on(s,"li",function(s){s.preventDefault();var a=t(this);return a.hasClass("vbs-disabled")?!1:(a.parents(".vbs-select-dropdown").fadeOut("fast"),e.view.selectLanguage({lang_code:a.attr("data-lang-code"),lang_name:a.text()}),void 0)}),e.helper.find(".vbs-select-language").on(s,function(s){s.preventDefault(),e.helper.toggleDropdown(t(this))}),e.keywords.events.init(s),e.speakers.events.init(s),e.comments.events.init(s),e.menus.events.init(s),e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper").on(s,"span.w",function(s){s.preventDefault(),"PLAYING"==e.PlayerApi.getStatus()&&e.PlayerApi.pause(),e.helper.showLoader(),e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive");var a=t(this),n=a.attr("t")/1e3;n=n>1?n-1:n,e.helper.find(".vbs-player-slider").css("left",n/e.data.duration*100+"%"),e.helper.find(".vbs-record-progress").css("width",n/e.data.duration*100+"%"),e.PlayerApi.seek(n);var r=a.text().trim();e.helper.track("transcript",r),r.match(/\s+/g)&&(r='"'+r+'"');var i=e.helper.find("#vbs-voice_search_txt");return i.val(r).change(),r.length&&e.view.searchWordWidget([r]),i.data("data-val",i.val()),e.api.getSearch([r],!1),!1}),e.settings.toggleBlocks&&e.settings.toggleTranscriptBlock&&e.helper.find(".vbs-transcript-block .vbs-section-title").on(s,function(s){s.preventDefault(),e.transcript.view.handleToggle(t(this))}),e.helper.find(".vbs-transcript-block .vbs-more-btn a").on(s,function(s){s.preventDefault();var a=e.helper.find(".vbs-transcript-wrapper").height(),n=t(this);e.data.tf?(e.data.tf=!1,n.text("Show More..."),t(".vbs-transcript-prewrapper").animate({height:e.settings.transcriptHeight+"px"},700)):(t(".vbs-transcript-prewrapper").animate({height:a+20+"px"},700,"linear",function(){t(this).css({height:"auto"})}),n.text("Hide More..."),e.data.tf=!0)}),e.helper.find(".vbs-transcript-block .vbs-transcript-prewrapper").on({mouseover:function(){t(this).addClass("vbs-t-hover")},mouseout:function(){t(this).removeClass("vbs-t-hover")}}),e.helper.find(".vbs-section-btns").on(s,".vbs-cloud-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.downloadMedia)return e.settings.webHooks.downloadMedia(),!1;var a=t(this);a.hasClass("vbs-active")?(a.removeClass("vbs-active"),a.parent().find(".vbs-download-popup").fadeOut("fast")):(a.addClass("vbs-active"),a.parent().find(".vbs-download-popup").fadeIn("fast"))}),e.helper.find(".vbs-download-popup").on(s,".vbs-donwload-pdf, .vbs-donwload-rtf, .vbs-donwload-srt",function(s){s.preventDefault(),e.helper.find(".vbs-cloud-btn").removeClass("vbs-active"),e.helper.find(".vbs-download-popup").fadeOut("fast");var a=t(this).attr("format");e.helper.downloadFile(a)}),e.helper.find(".vbs-media-block").on(s,".vbs-download-audio-btn",function(s){return s.preventDefault(),t(this).hasClass("vbs-disable-button")?!1:"undefined"!=typeof e.settings.webHooks.downloadTranscript?(e.settings.webHooks.downloadTranscript(),!1):(e.api.downloadAudio(),void 0)}),e.helper.find(".vbs-share-btn-wrapper").on(s,".vbs-share-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.socialShare)return e.settings.webHooks.socialShare(),!1;var a=e.helper.find(".vbs-share-popup");if(0===a.length||a.hasClass("vbs-hidden")){var n=Math.round(e.PlayerApi.getPosition()),i=e.helper.getNewUrl({vbt:n}),o=e.common.parseTime(n),l="undefined"!=typeof t.fn.zclip?"":"vbs-no-zclip",d=vbsTemplates.render("share/sharePopup",{vbt:n,vbspTime:o,url:i,zclip:l,buttons:e.settings.addThisButtons,isShare:e.settings.voicebaseShare});e.helper.find(".vbs-share-popup.vbs-hidden").remove(),e.helper.find(".vbs-share-btn-wrapper").append(d),"undefined"!=typeof t.fn.zclip&&e.helper.find(".vbs-copy-btn").zclip({path:e.settings.zeroclipboard,copy:function(){return e.helper.find("#vbsp-url").val()}}),"undefined"!=typeof addthis&&addthis.toolbox(".vbs-addthis-toolbox",{},{url:i,title:e.settings.shareTitle})}else r()}),t(document).off(s,"#vbs-share-position").on(s,"#vbs-share-position",function(){var t=e.PlayerApi.getPosition(),s=e.common.parseTime(Math.round(t)),n={vbt:Math.round(t)};a(n,this),e.helper.find(".vbsp-time").html(s).attr("vbct",s)}),t(document).off(s,"#vbs-share-search").on(s,"#vbs-share-search",function(){var e={vbs:encodeURI(t("#vbs-voice_search_txt").val())};a(e,this)}),t(document).off(s,"#vbs-share-file").on(s,"#vbs-share-file",function(){var e={vbt:0};a(e,this)});var a=function(s,a){e.helper.find(".vbs-share-popup .vbs-share-radio-row").removeClass("vbs-checked"),t(a).parents(".vbs-share-radio-row").addClass("vbs-checked");var n=e.helper.getNewUrl(s);e.helper.find("#vbsp-url").val(n),"undefined"!=typeof addthis&&addthis.update("share","url",n)};e.helper.find(".vbs-share-btn-wrapper").on(s,".vbs-cancel-btn",function(e){e.preventDefault(),r()}),e.helper.find(".vbs-share-btn-wrapper").on(s,".vbs-addthis-toolbox a",function(e){e.preventDefault(),r()}),e.helper.find(".vbs-share-btn-wrapper").on(s,".vbsp-url",function(e){e.preventDefault(),t(this).select()});var n;e.helper.find(".vbs-share-btn-wrapper").on(s,".vbs-play-btn",function(s){s.preventDefault(),clearTimeout(n),n=setTimeout(function(){e.PlayerApi.seek(t(".vbsp-time").attr("vbct"))},250)}),e.helper.find(".vbs-share-btn-wrapper").on(s,".vbs-voicebase-share-btn",function(t){return t.preventDefault(),"undefined"!=typeof e.settings.webHooks.vbShare?(e.settings.webHooks.vbShare(),("undefined"==typeof e.settings.webHooks.vbShareClose||"undefined"!=typeof e.settings.webHooks.vbShareClose&&e.settings.webHooks.vbShareClose===!0)&&r(),!1):(alert("Default Voicebase Share action"),void 0)});var r=function(){var t=e.helper.find(".vbs-share-popup");t.fadeOut("fast",function(){t.addClass("vbs-hidden").show()})};e.helper.find(".vbs-section-btns").on(s,".vbs-del-btn",function(e){e.preventDefault();var s=t(this);if(s.hasClass("vbs-disable-button"))return!1;var a=s.parent().find(".vbs-download-popup");s.hasClass("vbs-active")?(s.removeClass("vbs-active"),a.fadeOut("fast")):(s.addClass("vbs-active"),a.fadeIn("fast"))}),window.addEventListener("storage",function(t){"vbs-deleted-ids"===t.key&&e.helper.clearUiForDeletedIds()},!1),e.helper.find(".vbs-section-btns").on(s,".vbs-red-btn",function(s){return s.preventDefault(),e.helper.find(".vbs-section-btns .vbs-del-btn").removeClass("vbs-active"),t(this).parents(".vbs-popup").fadeOut("fast"),e.helper.setDeletedIdsInLocalStorage(),"undefined"!=typeof e.settings.webHooks.remove?(e.settings.webHooks.remove(),!1):(alert("Default delete action"),void 0)}),e.helper.find(".vbs-section-btns").on(s,".vbs-blue-btn",function(s){s.preventDefault(),e.helper.find(".vbs-section-btns .vbs-del-btn").removeClass("vbs-active"),t(this).parents(".vbs-popup").fadeOut("fast")}),e.helper.find(".vbs-section-btns").on(s,".vbs-star-btn",function(s){s.preventDefault();var a=t(this);if(a.hasClass("vbs-disable-button"))return!1;if(a.hasClass("vbs-active")){if("undefined"!=typeof e.settings.webHooks.favoriteTrue)return e.settings.webHooks.favoriteTrue(),!1;e.api.favorite(!1)}else{if("undefined"!=typeof e.settings.webHooks.favoriteFalse)return e.settings.webHooks.favoriteFalse(),!1;e.api.favorite(!0)}}),e.helper.find(".vbs-section-btns").on(s,".vbs-help-btn",function(t){return t.preventDefault(),"undefined"!=typeof e.settings.webHooks.help?(e.settings.webHooks.help(),!1):(window.open(e.settings.helpUrl,"_blank"),void 0)}),e.helper.find(".vbs-section-btns").on(s,".vbs-expand-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.fullscreen)return e.settings.webHooks.fullscreen(),!1;if(t("body").addClass("vbs-fullscreen"),"jplayer"==e.settings.playerType){var a=e.helper.findc(".vbs-player-wrapper");e.PlayerApi.setSizePlayer(a.width(),a.height())}var n=t("#"+e.settings.controlsBlock);return e.settings.markersInNativeTimeline?i("full"):l("full"),n.append(vbsTemplates.render("players/fullscreenExitBtn")).wrap(vbsTemplates.render("controls/controlsWrapper")).addClass("vbs-controls-box"),e.settings.markersInNativeTimeline&&o("full"),e.view.resizeTimelineElements(),e.news.view.collapseNewsBlock(),!1}),t(document).off(s,".vbs-fullscreen-exit").on(s,".vbs-fullscreen-exit",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.fullscreenExit)return e.settings.webHooks.fullscreenExit(),!1;t("body").removeClass("vbs-fullscreen"),"jplayer"==e.settings.playerType&&e.PlayerApi.setDefaultSizePlayer(),t(this).remove();var a=t("#"+e.settings.controlsBlock);a.unwrap().removeClass("vbs-controls-box"),e.settings.markersInNativeTimeline?(i("exit_full"),o("exit_full")):l("exit_full"),e.view.resizeTimelineElements()});var i=function(s){var a=t("#"+e.settings.controlsBlock),n=t("#vbs-searchbar-block");"full"==s?(a.addClass("vbs-native-markers"),e.settings.searchBarOuter?a.append(n):(a.append(vbsTemplates.render("search/searchWrapper")),n=t("#vbs-searchbar-block"),n.append(t(".vbs-search-form")),n.append(t(".vbs-after-controls-wrapper")))):"exit_full"==s&&(a.removeClass("vbs-native-markers"),e.settings.searchBarOuter?a.after(n):(t(".vbs-keywords-block .vbs-section-title").after(t(".vbs-search-form")),t(".vbs-keywords-block").find(".vbs-controls-after-searchbar").empty().append(t(".vbs-after-controls-wrapper")),t("#vbs-searchbar-block").remove()))},o=function(s){var a=t("#vbs-searchbar-block");if("full"==s){var n=a.width()-t(".vbs-fullscreen-exit").width()-t(".vbs-after-controls-wrapper").width()-20;a.find(".vbs-search-form").width(n),t(".vbs-controls-wrapper").height("85px")}else"exit_full"==s&&(e.settings.searchBarOuter?a.find(".vbs-search-form").width(a.width()-t(".vbs-controls-after-searchbar .vbs-after-controls-wrapper").width()-2):t(".vbs-search-form").width("inherit"))};e.helper.find(".vbs-section-btns").on(s,".vbs-readermode-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.readermode)return e.settings.webHooks.readermode(),!1;e.tooltips.view.hideTooltips(),t("body").addClass("vbs-readermode");var a=t("#"+e.settings.controlsBlock);l("full"),a.append(vbsTemplates.render("controls/readerExitBtn")).wrap(vbsTemplates.render("controls/controlsPlacement")).addClass("vbs-controls-box"),e.view.resizeTimelineElements(),t("body").append(vbsTemplates.render("common/readerWrapper")),t(".vbs-controls-wrapper").appendTo("#vbs-reader-wrap"),t(".vbs-transcript-block").appendTo("#vbs-reader-wrap"),e.news.view.collapseNewsBlock()}),t(document).off(s,".vbs-reader-exit").on(s,".vbs-reader-exit",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.readermodeExit)return e.settings.webHooks.readermodeExit(),!1;t("body").removeClass("vbs-readermode"),t(this).remove(),t(".vbs-controls-wrapper").appendTo("#vbs-controls-placement").unwrap(),t(".vbs-transcript-block").appendTo("#"+e.settings.transcriptBlock),t("#vbs-reader-wrap").remove();var a=t("#"+e.settings.controlsBlock);a.unwrap().removeClass("vbs-controls-box"),l("exit_full"),e.view.resizeTimelineElements()});var l=function(s){var a=t("#"+e.settings.controlsBlock),n=t("#vbs-searchbar-block");"full"==s?(e.settings.searchBarOuter?(n.css("height",0),a.append(n)):a.append(t(".vbs-search-form")),a.hasClass("less-600px")&&!e.common.isMobile()&&a.removeClass("less-600px").addClass("less-600px-backup"),e.settings.markersInNativeTimeline&&e.view.resetControlsPlace()):"exit_full"==s&&(e.settings.searchBarOuter?(n.css("height","32px"),a.after(n)):t(".vbs-keywords-block .vbs-section-title").after(t(".vbs-search-form")),a.hasClass("less-600px-backup")&&!e.common.isMobile()&&a.removeClass("less-600px-backup").addClass("less-600px"),e.settings.markersInNativeTimeline&&e.view.renderControlsAfterSearchBar())};e.helper.find(".vbs-section-btns").on(s,".vbs-evernote-btn",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.evernote)return e.settings.webHooks.evernote(),!1;if("undefined"!=typeof filepicker){var s=null!==e.api.response.metadata&&""!==e.api.response.metadata.response.title?e.api.response.metadata.response.title:"VoiceBase";filepicker.exportFile(e.api.getAutoNotesHtmlURL(),{service:"EVERNOTE",suggestedFilename:s})}}),e.helper.find(".vbs-section-btns").on(s,".vbs-edit-btn",function(s){if(s.preventDefault(),e.transcript.view.getIsSaving())return!1;if("undefined"!=typeof e.settings.webHooks.editTranscript)return e.settings.webHooks.editTranscript(),!1;e.tooltips.view.hideTooltips(),e.data.savingSpeakers=t.extend({},e.data.speakers),e.helper.find(".vbs-edit-mode-prewrapper").html(vbsTemplates.render("transcript/editTranscript",{ourtranscript:e.transcript.view.editTranscriptText()})),t("body").addClass("vbs-no-scroll");var a=t("#"+e.settings.transcriptBlock);a.wrap(vbsTemplates.render("transcript/transcriptPlacement")),t("body").append(vbsTemplates.render("common/editWrapper")),a.appendTo("#vbs-edit-wrap"),e.news.view.collapseNewsBlock()}),e.helper.find(".vbs-transcript-block").on(s,".vbs-edit-mode-exit",function(s){return s.preventDefault(),"undefined"!=typeof e.settings.webHooks.editTranscriptExit?(e.settings.webHooks.editTranscriptExit(),!1):(e.data.speakers=e.data.savingSpeakers,t("#"+e.settings.transcriptBlock).appendTo("#transcript_placement").unwrap(),t("#vbs-edit-wrap").remove(),e.helper.find(".vbs-edit-mode-prewrapper").html(""),t("body").removeClass("vbs-no-scroll"),void 0)}),e.helper.find(".vbs-transcript-block").on(s,".vbs-save-edition-popup-trigger",function(t){t.preventDefault(),e.transcript.view.showSaveQuestion()}),e.helper.find(".vbs-transcript-block").on(s,".vbs-cancel-edition-btn",function(t){t.preventDefault(),e.helper.find(".vbs-save-popup-wrapper").fadeOut("fast")}),e.helper.find(".vbs-transcript-block").on(s,".vbs-discard-edition-btn",function(t){t.preventDefault(),e.helper.find(".vbs-edit-mode-prewrapper").html(vbsTemplates.render("transcript/editTranscript",{ourtranscript:e.transcript.view.editTranscriptText()}))}),e.helper.find(".vbs-transcript-block").on(s,".vbs-save-edition-btn",function(t){t.preventDefault(),e.transcript.view.saveTranscript()}),t(".vbs-section-btns").on(s,".vbs-print-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.print)return e.settings.webHooks.print(),!1;var a=t(".vbs-transcript-wrapper").clone();a.find(".vbs-trans-info").remove();var n=window.open("","","height="+screen.availHeight+",width="+screen.availWidth+",left=0,top=0"),r=vbsTemplates.render("common/print",{transcriptText:a.html()});n.document.write(r),n.document.close(),n.focus(),n.print(),n.close()}),t(".vbs-transcript-block").on(s,".vbs-order-human-trans a",function(s){var a=t(s.target).parents(".vbs-order-human-trans"),n=a.hasClass("vbs-human-ordered");if("undefined"!=typeof e.settings.webHooks.orderTranscript&&!n){var r=(e.data.duration/60).toFixed(2);return e.settings.webHooks.orderTranscript({$orderButton:a,apiUrl:e.settings.apiUrl,version:e.settings.version,apiKey:e.settings.apiKey,password:e.settings.password,mediaId:e.settings.mediaId,mediaUrl:e.api.response.metadata.response.streamUrl,recordName:e.api.response.metadata.response.title,mediaLengthInMinutes:r}),!1}return n?!1:void 0}),e.settings.toggleBlocks&&e.settings.toggleNewsBlock&&e.helper.find(".vbs-news-block .vbs-section-title").on(s,function(s){s.preventDefault(),e.news.view.handleToggleBlock(t(this))}),e.settings.toggleBlocks&&e.settings.togglePredictionsBlock&&e.helper.find(".vbs-predictions-block  .vbs-section-title").on(s,function(e){e.preventDefault();
var s=t(this);s.toggleClass("vbs-hidden"),s.hasClass("vbs-hidden")?(s.attr("data-title","Show Predictions"),s.parents(".vbs-predictions-block").find(".vbs-section-body").slideUp()):(s.attr("data-title","Hide Predictions"),s.parents(".vbs-predictions-block").find(".vbs-section-body").slideDown())}),t(document).off(s,".vbs-reload-overlay,.vbs-white-popup-overlay").on(s,".vbs-reload-overlay,.vbs-white-popup-overlay",function(s){s.preventDefault();var a=t(this);if(a.hasClass("vbs-white-popup-overlay")&&e.settings.tabView)return!1;a.fadeOut("fast",function(){a.remove()});var n=t(s.target);n.hasClass("vbs-reload-btn")&&location.reload()}),t(document).off("keydown",".vbs-edition-block").on("keydown",".vbs-edition-block",function(e){13==e.keyCode&&document.execCommand("insertHTML",!1,"<br>")}),t(document).off(s,".vbsc-edit-play").on(s,".vbsc-edit-play",function(s){s.preventDefault();var a=t(this).attr("data-time");e.PlayerApi.seek(a)}),e.settings.debug&&t(document).off("keydown.vbs_keydown").on("keydown.vbs_keydown",function(t){var s=t.which||t.keyCode;71===s&&(t.metaKey||t.ctrlKey)&&t.altKey&&e.helper.debug()}),e.settings.tabView&&t(document).off(s,".vbs-tabs-links a").on(s,".vbs-tabs-links a",function(e){e.preventDefault();var s=t(this),a=s.attr("data-href");return s.hasClass("vbs-active")||(s.siblings().removeClass("vbs-active"),s.addClass("vbs-active")),t(".vbs-tab").each(function(){t(this).removeClass("vbs-tab-visible")}),t(a).addClass("vbs-tab-visible"),!1}),t(document).off(s,".vbs-selected-playlist-item").on(s,".vbs-selected-playlist-item",function(s){s.preventDefault();var a=t(this).parents(".vbs-playlist");if(a.toggleClass("collapsed"),!a.hasClass("collapsed")){var n=e.PlayerApi.getPlaylistItemIndex(),r=a.find("[data-playlist-item-index="+n+"]");a.animate({scrollTop:r.offset().top-r.parent().offset().top})}}),t(document).off(s,".vbs-playlist-item").on(s,".vbs-playlist-item",function(s){s.preventDefault();var a=t(this).attr("data-playlist-item-index"),n=t(this).parents(".vbs-playlist");n.addClass("collapsed"),e.PlayerApi.setPlaylistItem(a)}),t(document).off(s,".vbs-cancel-search").on(s,".vbs-cancel-search",function(t){t.preventDefault(),e.data.searchWorker&&e.data.searchWorker.terminate(),e.helper.clearMessage(),e.helper.hideLoader(),e.data.clicker=!1,e.PlayerApi.play()})}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.helper={isRand:!1,randConstant:null,css:"",randId:function(){return this.isRand||this.randConstant||(this.isRand=!0,this.randConstant=e.common.rand()),this.randConstant},find:function(s){return t("."+e.data.vclass+" "+s)},findc:function(s){return t("."+e.data.vclass+s)},showLoader:function(){var t=e.helper.find(".vbs-record-timeline-wrap");e.settings.animation&&t.has(".vbs-loader")&&t.prepend(vbsTemplates.render("common/loader"))},hideLoader:function(){e.helper.find(".vbs-record-timeline-wrap .vbs-loader").fadeOut("fast",function(){t(this).remove()})},downloadFile:function(t){var s=e.api.parameters;s.action="getTranscript",s.content=!0,s.format=t;var a=e.settings.apiUrl+"?"+e.common.getStringFromObject(s);window.location=a},getNewUrl:function(t){var s=window.location.search.substring(1),a=s.split("&"),n={},r=[];if(s.length>0)for(var i=a.length,o=0;i>o;o++){var l=a[o].split("=");if("vbt"!=l[0]&&"vbs"!=l[0]){n[l[0]]=l[1];for(var d in t)decodeURIComponent(l[0])==d&&(n[l[0]]=t[d])}}for(var c in e.settings.shareParams)"undefined"==typeof n[c]&&(n[c]=e.settings.shareParams[c]);for(var p in t)"undefined"==typeof n[p]&&(n[p]=t[p]);for(var v in n)r.push(v+"="+n[v]);return e.settings.shareUrl?e.settings.shareUrl+"?"+r.join("&"):window.location.origin+window.location.pathname+"?"+r.join("&")},checkAutoStart:function(){for(var t=window.location.search.substring(1),s=["vbt","vbs"],a=t.split("&"),n={},r=a.length,i=0;r>i;i++){var o=a[i].split("=");for(var l in s)decodeURIComponent(o[0])==s[l]&&(n[s[l]]=o[1])}return e.data.startParams=n,!1},waitReady:function(){if(e.api.ready.keywords&&e.api.ready.metadata&&e.api.ready.transcript&&e.api.ready.comments){if(clearInterval(e.data.waiter),e.data.waiter=null,e.helper.checkErrors(),e.speakers.view.speakersWidget(),Object.keys(e.data.speakers).length>1&&e.speakers.view.speakerFilterWidget(e.data.speakers,"all"),e.comments.view.commentsTWidget(),e.settings.editKeywords&&t(".vbs-keywords-block .vbs-topics").addClass("vbs-edit-topics"),t(".vbs-media-block").hasClass(".less-600px")||t(".vbs-record-player .vbs-time-name-wrapper-narrow").css({opacity:0}),"jwplayer"===e.settings.playerType&&null!==e.api.response.metadata&&!e.settings.hasPlaylist)if(e.common.isApi2_0()&&e.settings.stream){var s=e.settings.apiUrl+e.settings.mediaId+"/streams/original?"+e.settings.token;e.PlayerApi.loadFile(s)}else if("html5"!=e.PlayerApi.getRenderingMode()&&"rtmp"==e.settings.stream){var a=e.api.response.metadata.response.rtmpUrl+""+e.api.response.metadata.response.rtmpFile;e.PlayerApi.loadFile(a)}else("http"===e.settings.stream||e.settings.stream===!0)&&e.PlayerApi.loadFile(e.api.response.metadata.response.streamUrl);e.data.startParams!==!1&&this.autoStart(e.data.startParams),e.api.response.keywords&&e.api.response.keywords.utterances&&e.utterances.view.createView(e.api.response.keywords.utterances),e.view.checkEmptyHeadersForTabs(),e.tooltips.view.init(),e.methods.ready()}return!1},waitReadyAfterSave:function(){if(e.api.ready.keywords&&e.api.ready.metadata&&e.api.ready.transcript&&e.api.ready.comments){if(clearTimeout(e.data.waiterSave),e.data.waiterSave=null,e.settings.modalSave){var s=e.helper.find(".vbs-save-popup-wrapper");s.find(".vbs-save-loading-popup").fadeOut("fast"),s.find(".vbs-save-done-popup").fadeIn("fast")}else e.transcript.view.clearSavingMessages(),t("#"+e.settings.controlsBlock).after(vbsTemplates.render("messages/successSavingMessage")),setTimeout(function(){e.transcript.view.clearSavingMessages()},3e3);setTimeout(function(){e.settings.modalSave&&e.helper.exitEditFullscreen(),e.helper.checkErrors(),e.speakers.view.speakersWidget(),e.comments.view.commentsTWidget(),e.tooltips.view.init()},800)}return!1},exitEditFullscreen:function(){t("#"+e.settings.transcriptBlock).appendTo("#transcript_placement").unwrap(),e.helper.find(".vbs-edit-mode-prewrapper").html(""),t("body").removeClass("vbs-no-scroll")},autoStart:function(t){var s;if("undefined"!=typeof t.vbs){e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive");var a=decodeURI(t.vbs).trim();a=e.keywords.matchWords(a),a=a?a:[];var n=a.join(" ");e.helper.find("#vbs-voice_search_txt").val(n).data("data-val",n).change(),a.length&&e.view.searchWordWidget(a);var r=!0;return"undefined"!=typeof t.vbt&&(r=!1,s=t.vbt,e.PlayerApi.seek(s)),e.api.getSearch(a,r),!1}"undefined"!=typeof t.vbt&&(s=t.vbt,e.PlayerApi.seek(s))},moveToNextMarker:function(s){var a=!0,n=[],r=s.find("a");r.each(function(){n.push(parseFloat(t(this).attr("stime")))}),n.sort(function(e,t){return parseInt(e,10)-parseInt(t,10)});for(var i in n)if(n[i]>e.PlayerApi.getPosition()+1)return e.PlayerApi.seek(n[i]),a=!1,!1;a&&r.length&&e.PlayerApi.seek(n[0])},moveToPrevMarker:function(s){var a=!0,n=[],r=s.find("a");r.each(function(){n.push(parseFloat(t(this).attr("stime")))}),n.sort(function(e,t){return parseInt(t,10)-parseInt(e,10)});for(var i in n)if(n[i]<e.PlayerApi.getPosition()-1)return e.PlayerApi.seek(n[i]),a=!1,!1;a&&r.length&&e.PlayerApi.seek(n[0])},startScroll:function(){var s=e.helper.find("#vbs-search-string .vbs-marquee");if(s.is(":visible")){var a=s.find(".vbs-search-word-widget");a.stop(!0).css("left",0);var n=0;e.helper.find(".vbs-word").each(function(){n+=Math.ceil(this.getBoundingClientRect().width)}),n>s.width()?(a.width(n),e.helper.scrollStringLeft()):a.width(t("#vbs-search-string").width())}},scrollStringLeft:function(){var t=e.helper.find(".vbs-word").length,s=1200*t,a=e.helper.find("#vbs-search-string .vbs-marquee"),n=a.find(".vbs-search-word-widget");n.animate({left:a.width()-n.width()},{duration:s,complete:function(){e.helper.scrollStringRight()}})},scrollStringRight:function(){var t=e.helper.find(".vbs-word").length,s=1200*t;e.helper.find("#vbs-search-string .vbs-marquee .vbs-search-word-widget").animate({left:"1"},{duration:s,complete:function(){e.helper.scrollStringLeft()}})},track:function(t,s){if(s="undefined"!=typeof s?s:!1,"undefined"!=typeof ga&&e.settings.trackEvents)switch(t){case"play":return ga("send","event",e.settings.mediaId,"Play",e.PlayerApi.getPosition()),!0;case"pause":return ga("send","event",e.settings.mediaId,"Pause",e.PlayerApi.getPosition()),!0;case"seek":return ga("send","event",e.settings.mediaId,"Seek",s),!0;case"keyword":return ga("send","event",e.settings.mediaId,"Keyword",s),!0;case"transcript":return ga("send","event",e.settings.mediaId,"Transcript",s),!0;default:return!1}return!1},adjustMediaTime:function(){var t=e.helper.find(".vbs-media-block"),s=t.find(".vbs-section-title"),a=t.find(".vbs-section-btns"),n=s.offset().left+s.width(),r=a.offset().left;if(n>=r&&(s.find(".vbs-voice-name").hide(),s=t.find(".vbs-section-title"),a=t.find(".vbs-section-btns"),n=s.offset().left+s.width(),r=a.offset().left,n>=r&&(s.find(".vbs-time").hide(),t.hasClass("vbs-video")))){var i=e.common.parseTime(e.data.duration),o=vbsTemplates.render("players/timeInPlayer",{time:i});e.helper.findc(".vbs-player-wrapper").append(o)}},checkErrors:function(){if(e.settings.modalErrors){var s=t(".vbsp-"+e.helper.randId()+".vbs-content");if(e.api.errors.processing)s.append(vbsTemplates.render("messages/reloadOverlayCredentials"));else if(e.api.errors.failure){e.settings.tabView?s.append(vbsTemplates.render("messages/abstractAlertPopup",{errorTitle:"File has not finishing processing yet",errorText:"Search, keywords, and transcript for this file are not available. If reloading does not solve the problem, please contact support for assistance."})):s.append(vbsTemplates.render("messages/errorPopup"));var a=s.find(".vbs-big-error-popup"),n=parseInt(a.css("height"));a.css("marginTop",-n/2)}}else if(e.api.errors.processing||e.api.errors.failure){var r="File not indexed. Search, Keywords & Transcript are unavailable for this recording.";e.api.errors.processing&&(r="Could not load recording data, indexing file may not be complete. If reload does not solve problem contact support for assistance");var i=vbsTemplates.render("messages/textErrorMessage",{errorText:r});t("#"+e.settings.controlsBlock).after(i)}},debug:function(){var t="inited";"rtmp"==e.settings.stream?t=e.api.response.metadata.response.rtmpUrl+e.api.response.metadata.response.rtmpFile:("http"==e.settings.stream||e.settings.stream===!0)&&(t=e.api.response.metadata.response.streamUrl);var s={type:e.settings.playerType,mode:e.PlayerApi.getRenderingMode(),inited:e.instances.length,isStream:e.settings.stream,streamUrl:t,mediaID:e.settings.mediaId?e.settings.mediaId:e.settings.externalId,statusMetaData:e.api.response.metadata&&e.api.response.metadata.requestStatus?e.api.response.metadata.requestStatus:!1,statusKeyword:e.api.response.keywords&&e.api.response.keywords.requestStatus?e.api.response.keywords.requestStatus:!1,statusTranscript:e.api.response.transcript&&e.api.response.transcript.requestStatus?e.api.response.transcript.requestStatus:!1,statusTranscriptFileStatus:e.api.response.transcript&&e.api.response.transcript.fileStatus?e.api.response.transcript.fileStatus:!1,statusComments:e.api.response.comments&&e.api.response.comments.requestStatus?e.api.response.comments.requestStatus:!1,browserAppVersion:navigator.appVersion,browserUserAgent:navigator.userAgent,browserPlatform:navigator.platform,browserUserLanguage:navigator.userLanguage,url:window.location.href};"undefined"!=typeof _LTracker&&_LTracker.push(s);var a=e.helper.find(".vbs-logger");if(a.length>0)a.remove();else{e.helper.find(".vbs-record-player").after(vbsTemplates.render("messages/loggerBlock",{response:JSON.stringify(s)}));var n=e.helper.find(".vbs-logger textarea");n.bind("focus",function(){this.select()})}console.log(s)},setOrderedButton:function(s){s=s.replace(/-/g,"/");var a=new Date(s),n=e.data.months[a.getMonth()],r=a.getDate().toString();1===r.length&&(r="0"+r);var i=t(".vbs-order-human-trans");i.addClass("vbs-human-ordered").removeAttr("data-title"),i.find("a").attr("href","#").text("Transcript due "+n+" "+r)},clearIntervals:function(){clearInterval(e.data.waiterSave),e.data.waiterSave=null,e.instances.length>0&&e.instances[e.current_instance]&&e.instances[e.current_instance].player&&(clearInterval(e.instances[e.current_instance].player.find_player_interval),e.instances[e.current_instance].player.find_player_interval=null),clearInterval(e.events.time),e.events.time=null,clearInterval(e.data.waiter),e.data.waiter=null,clearInterval(e.data.metadataWaiter),e.data.metadataWaiter=null},renderMobile:function(){t("body").addClass("vbs-mobile"),e.common.isRetina()&&t("body").addClass("vbs-retina")},getMobileWidth:function(){return t(".vbs-content").width()},setOnTimeInterval:function(){e.events.time=setInterval(function(){e.events.time&&e.events.onTime()},250)},isMediaTypeEqualVideo:function(){var t=e.settings.mediaTypeOverride;if(t)return"video"===t;if(e.api.response){var s=e.api.response.metadata;return!(s&&s.response&&s.response.hasVideo===!1)}return!0},toggleDropdown:function(t){t.hasClass("vbs-s-show")?(e.helper.find(".vbs-select-dropdown").fadeOut("fast"),t.removeClass("vbs-s-show")):(e.helper.find(".vbs-select-dropdown").fadeIn(100),t.addClass("vbs-s-show"))},clearMessage:function(){e.settings.localSearch?(t(".vbs-message").remove(),t(".vbs-text-error-message").remove()):(t(".vbs-message").fadeOut(),t(".vbs-text-error-message").fadeOut())},showMessage:function(t,s){e.helper.clearMessage();var a=vbsTemplates.render("messages/infoMessage",{errorText:t,mode:s});e.helper.appendMessage(a)},appendMessage:function(s){e.settings.searchBarOuter?t("#"+e.settings.searchBarBlock).before(s):t("#"+e.settings.keywordsBlock).before(s)},setDeletedIdsInLocalStorage:function(){var t=e.helper.getDeletedIdsInLocalStorage();t.push(e.settings.mediaId),localStorage.setItem("vbs-deleted-ids",JSON.stringify(t))},getDeletedIdsInLocalStorage:function(){return JSON.parse(localStorage.getItem("vbs-deleted-ids"))||[]},clearUiForDeletedIds:function(){var s=e.helper.getDeletedIdsInLocalStorage(),a=s.filter(function(t){return t===e.settings.mediaId});a.length>0&&(t(".vbs-section-btns,.vbs-order-human-trans,.vbs-time").remove(),t(".vbs-record-player").hide(),e.helper.showMessage("No such media file!","error"),e.PlayerApi.destroy())}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.keywords={data:{categories:[],keywords:[]},getCategories:function(t,s){var a=e.common.objectToArray(t);return e.settings.keywordsGroups&&s&&(a=a.concat(e.common.objectToArray(s))),a},parseCategoriesForTopics:function(t){var s=jQuery.map(t,function(t){var s=e.speakers.parseSpeakersInCategory(t.speakers);return{name:t.name,score:t.score,subcategories:t.subcategories,similarCategories:t.similarCategories,speakers:s,type:t.type}});return s.sort(function(e,t){return e.score-t.score}),s.reverse(),s},parseSpeakersForAllKeywords:function(t){t.forEach(function(t){var s=Object.keys(t.t);e.speakers.parseSpeakersInCategory(s)})},getAllTopicsItem:function(e,t){return{name:"ALL TOPICS",keywords:e,subcategories:{},similarCategories:{},speakers:t}},getKeywordsNames:function(e){return e.map(function(e){return e.name})},termFor:function(e,t){var s=e.split(","),a=s.map(function(e){return e.match(/\s+/g)?'"'+e+'"':e});return"undefined"!=typeof t&&"url"==t?a.join(" "):a},isCategoryGroup:function(e){return"group"===e.type},isCategoryAllTopics:function(e){return"ALL TOPICS"===e.name},getCategoryClassString:function(t,s,a){var n=e.keywords.isCategoryGroup(t)?s:"";return e.keywords.isCategoryAllTopics(t)?a:n},getCategoryTimesAndSpeakersData:function(t){var s="",a=[],n=[];for(var r in t.t){var i="";""!==t.t&&t.t[r]&&(n=n.concat(t.t[r]),i=t.t[r].join());var o=e.common.replaceAndTrim(r),l=e.speakers.getSpeakerKeyByName(o);s+="data-spt-"+l+'="'+i+'" ',a.push(l)}return{sptimes:s,spkeys:a,times:n}},getColumnClassByNumber:function(e){switch(e){case 1:return"vbs-one-col";case 2:return"vbs-two-col";case 3:return"vbs-three-col";case 4:return"vbs-four-col";case 5:return"vbs-five-col";default:return""}},findCategoryByName:function(t){return e.keywords.data.categories.filter(function(e){return e.name===t})[0]},prepareTopicTimes:function(t){var s=e.keywords.findCategoryByName(t),a=[];return s&&s.keywords.forEach(function(e){Object.keys(e.t).forEach(function(t){a=a.concat(e.t[t])})}),a=e.common.uniqueArray(a)},matchWords:function(t){return t=e.keywords.checkQuotes(t),t=t.replace(/""/g,'"'),t.match(/("[^"]+")+|[\S]+/gi)},checkQuotes:function(e){for(var t=[],s=!1,a=-1;!s;)a=e.indexOf('"',a+1),-1!==a?t.push(a):s=!0;if(t.length%2!==0)if(1===t.length)e+='"';else if(t.length>=3){var n=t[t.length-2],r=e.substring(0,n+1),i=e.substring(n+1);e=r+' "'+i}return e},view:{createView:function(t){var s=e.helper.find(".vbs-keywords-block");if("SUCCESS"==t.requestStatus){e.api.response.keywords=t;var a=e.keywords.getCategories(t.categories,t.groups),n=e.keywords.parseCategoriesForTopics(a);e.keywords.parseSpeakersForAllKeywords(t.keywords);var r=e.keywords.getAllTopicsItem(t.keywords,e.speakers.getSpeakersKeys().join());n.unshift(r),a.unshift(r),e.keywords.data.categories=a,e.keywords.data.keywords=e.keywords.getKeywordsNames(t.keywords);var i=vbsTemplates.render("keywords/topicList",{categories:n,getCategoryClassString:e.keywords.getCategoryClassString}),o=e.keywords.view.createKeywordsList(a);e.settings.keywordsColumns&&"auto"!=e.settings.keywordsColumns&&e.helper.find(".vbs-keywords-list-wrapper").addClass(e.keywords.getColumnClassByNumber(e.settings.keywordsColumns)),s.find(".vbs-topics").html(i),s.find(".vbs-keywords-list-tab").html(o),e.settings.showAutoGeneratedKeywords?e.keywords.view.selectTopic(s.find(".vbs-topics").find("li").first()):e.keywords.view.hideAutoGeneratedKeywords(),e.keywords.view.checkExpandKeywordBlock()}else e.keywords.view.errorKeywords(),e.api.setErrors(t);e.api.ready.keywords=!0},createKeywordsList:function(s){var a=t();return s.forEach(function(s){var n=e.keywords.getCategoryClassString(s,"group",""),r=t(vbsTemplates.render("keywords/keywordsUl",{categoryName:s.name,categoryClass:n}));s.keywords.forEach(function(t){var s=e.keywords.getCategoryTimesAndSpeakersData(t),a=e.keywords.view.createKeywordLi(t.name,t.internalName,s.spkeys,s.sptimes,s.times);r.append(a)}),a=a.add(r)}),a},createKeywordLi:function(s,a,n,r,i){var o=vbsTemplates.render("keywords/keywordItem.ejs",{name:s,spkeys:n,sptimes:r,keywordsCounter:e.settings.keywordsCounter,times:i}),l=t(o),d=a?a.join():s;return l.find("a").data("keywordInternalName",d),l},checkExpandKeywordBlock:function(){var t=e.helper.find(".vbs-keywords-block");e.settings.expandKeywordsBlock?t.slideDown("fast",function(){e.keywords.view.keywordsAutoColumns(),e.keywords.view.keywordsAutoTopicsColumns()}):(t.show(),t.find(".vbs-section-title").attr("data-title","Show Keywords"),t.find(".vbs-section-body").hide(),t.find(".vbs-search-form").hide())},errorKeywords:function(){var s=e.helper.find(".vbs-keywords-block");s.append(vbsTemplates.render("common/disabler")),e.settings.tabView||(s.show(),s.find(".vbs-search-form").hide(),s.find(".vbs-section-body").hide()),e.settings.searchBarOuter&&(t("#vbs-voice_search_txt").prop("disabled","disabled"),t("#vbs-searchbar-block").find(".vbs-search-form").addClass("vbs-form-disabled"))},getActiveListEl:function(){return e.helper.find(".vbs-keywords-list-tab ul.vbs-active")},setActiveList:function(t){t.parent().find(".vbs-active").removeClass("vbs-active"),t.addClass("vbs-active");var s=t.find("a").text().trim();e.helper.find(".vbs-keywords-list-tab ul").removeClass("vbs-active"),e.helper.find('.vbs-keywords-list-tab ul[tid="'+s+'"]').addClass("vbs-active")},setActiveAllTopics:function(){var t=e.helper.find(".vbs-topics-list li.vbs-all-topics");e.keywords.view.setActiveList(t)},selectTopic:function(t){return t.hasClass("vbs-active")||t.hasClass("vbs-disabled")?!1:(e.keywords.view.setActiveList(t),e.keywords.view.keywordsAutoTopicsColumns(),e.settings.editKeywords&&e.keywords.view.hideRemoveTopicPopup(),e.speakers.view.filterSpeakersList(t.find("a").attr("speakers").split(",")),void 0)},showAutoGeneratedKeywords:function(){var t=e.helper.find(".vbs-keywords-wrapper");t.find(".vbs-keyword-message").remove();var s=t.find(".vbs-topics"),a=s.hasClass("vbs-no-visible-topics");s.removeClass("vbs-no-visible-topics").find(".vbs-hidden-topic").removeClass("vbs-hidden-topic"),a&&e.keywords.view.selectTopic(s.find("li").first())},hideAutoGeneratedKeywords:function(){var t=e.helper.find(".vbs-keywords-wrapper"),s=t.find(".vbs-topics");s.find("li:not(.group)").addClass("vbs-hidden-topic"),s.find("li").removeClass("vbs-active");var a=s.find(".group");if(a.length>0)e.keywords.view.selectTopic(a.first());else if(t.find(".vbs-keywords-list-tab ul").removeClass("vbs-active"),s.addClass("vbs-no-visible-topics"),0===t.find(".vbs-keyword-message").length){var n=vbsTemplates.render("keywords/emptyMessage");t.prepend(n)}},updateQuotesVisibility:function(){if(e.settings.vbsButtons.unquotes){var t=e.helper.find(".vbs-search-form"),s=e.keywords.view.getSearchWordsArray(),a=s.filter(function(e){return 0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1});a.length>0?t.addClass("vbs-quoted"):t.removeClass("vbs-quoted")}},removeQuotes:function(){var s=e.keywords.view.getSearchWordsArray(),a=[];s.forEach(function(e){if(0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1){e=e.replace(/"/g,"");var t=e.split(" ");t.forEach(function(e){a.push(e)})}else a.push(e)});var n=a.join(" ");e.helper.find("#vbs-voice_search_txt").val(n).data("data-val",n),t("#vbs-search-form").submit()},getPhraseByTime:function(t,s,a){var n="",r=e.helper.find(".vbs-transcript-wrapper > span > span:wordtime("+1e3*t+","+1e3*s+")");if(n=e.keywords.view.getTextFromElems(r),"undefined"!=typeof Fuse){var i=n.split(" "),o=a.split(" ").length,l=[];if(o>1)for(var d=0;d<i.length;d++){for(var c="",p=0;o>p;p++)i[d+p]&&(c+=i[d+p]+" ");l.push(c.trim())}else l=i;var v=new Fuse(l,{threshold:.4}),u=v.search(a),m=u.length>0?u[0]:null;if(null!==m){n="";for(var b=0;b<l.length;b++){var f=l[b];f=f.split(" ")[0],b>=m&&m+o-1>=b&&(f="<b>"+f+"</b>"),n+=f+" "}}}return n},getTextFromElems:function(s){var a="";return s.each(function(){if(!t(this).attr("m")){var s=t(this).text();s=e.common.replaceAndTrim(s),""===s||s.match(/\w+/g)?""!==s&&(a+=""===a?s:" "+s):a+=s}}),a},getSearchWordsArray:function(){var t=e.helper.find("#vbs-voice_search_txt").val().trim();return t=e.keywords.matchWords(t),t=t?t:[]},keywordsAutoTopicsColumns:function(s){if("topics"!==e.settings.keywordsColumns)return!1;s="undefined"!=typeof s?s:5;var a=e.helper.find(".vbs-keywords-list-wrapper");return 0===s?!1:(a.removeClass(e.keywords.getColumnClassByNumber(s+1)).addClass(e.keywords.getColumnClassByNumber(s)),e.keywords.view.getActiveListEl().find("li").each(function(){return t(this).height()>18?(e.keywords.view.keywordsAutoTopicsColumns(s-1),!1):void 0}),void 0)},keywordsAutoColumns:function(s){if("auto"!==e.settings.keywordsColumns)return!1;s="undefined"!=typeof s?s:5;var a=e.helper.find(".vbs-keywords-list-wrapper");return 0===s?(a.removeClass("vbs-auto-columns"),!1):(a.addClass("vbs-auto-columns"),a.removeClass(e.keywords.getColumnClassByNumber(s+1)).addClass(e.keywords.getColumnClassByNumber(s)),a.find("ul li").each(function(){return t(this).height()>18?(e.keywords.view.keywordsAutoColumns(s-1),!1):void 0}),a.removeClass("vbs-auto-columns"),void 0)},keywordHover:function(t){if(0===t.length)return!1;var s=vbsTemplates.render("keywords/markersHover",{times:t,getPosition:e.PlayerApi.getOffset});e.helper.find(".vbs-markers-hovers").html(s)},removeKeywordHover:function(){e.helper.find(".vbs-markers-hovers").html("")},addKeywords:function(s,a){e.keywords.view.setActiveAllTopics();var n=s.replace(/"/g,"");e.keywords.data.keywords.push(n);var r=e.keywords.view.createKeywordLi(n,null,"",a,a.split(","));e.keywords.view.getActiveListEl().prepend(r),e.helper.find(".vbs-add-search-word").each(function(){t(this).data("data-kwa").replace(/"/g,"")===n&&t(this).remove()}),e.keywords.view.keywordsAutoTopicsColumns()},removeTopic:function(){var t=e.helper.find(".vbs-topics-list");t.find("li.vbs-active").remove(),e.keywords.view.setActiveAllTopics(),e.keywords.view.hideRemoveTopicPopup(),e.keywords.view.keywordsAutoTopicsColumns()},removeKeyword:function(t,s,a){"ALL TOPICS"==t&&e.keywords.data.keywords.splice(e.keywords.data.keywords.indexOf(s)),a.remove()},handleEditKeywordEvent:function(s,a){var n=s.parent().data("keywordInternalName"),r=e.keywords.view.getLinkByKeywordInternalName(n),i=e.keywords.view.getCategoryName(),o=t(r).text();"remove"===a?e.api.removeKeyword(o,i,r):e.api.editKeyword(a,o,i,r)},editKeyword:function(e,t){"up"==e?t.insertBefore(t.prev()):"down"==e?t.insertAfter(t.next()):"first"==e&&t.insertBefore(t.siblings(":eq(0)")),"delete"==e&&t.remove()},getCategoryName:function(){return e.helper.find(".vbs-topics-list li.vbs-active").text().trim()},getLinkByKeywordInternalName:function(s){var a;return e.keywords.view.getActiveListEl().find("a").each(function(){return t(this).data("keywordInternalName")==s?(a=t(this),!0):void 0}),a},showRemoveTopicPopup:function(s){if(t(".vbs-topic-delete-popup").length)e.keywords.view.hideRemoveTopicPopup();else{var a=t(document).find(".vbs-popup");a.hide().siblings("a").removeClass("vbs-active");var n=s.parents("li").find("a").text(),r=s.offset().top,i=s.offset().left,o=vbsTemplates.render("keywords/deleteTopicPopup",{topicName:n,top:r,left:i});t(o).appendTo("body"),e.helper.find(".vbs-edit-topics").scroll(function(){e.keywords.view.hideRemoveTopicPopup()})}},hideRemoveTopicPopup:function(){t(".vbs-topic-delete-popup").fadeOut("fast",function(){t(this).remove()})},removeBoldClass:function(){e.helper.find(".vbs-keywords-list-wrapper .vbs-keywords-list-tab li a.bold").removeClass("bold")},filterKeywords:function(s){e.settings.filterSpeaker=s;var a=e.helper.find(".vbs-topics .vbs-topics-list li");a.removeClass("vbs-disabled"),a.find("a").each(function(){var e=t(this);"all"!==s&&(e.is('[speakers*="'+s+'"]')||e.parent().addClass("vbs-disabled"),e.attr("t",e.attr("data-spt-"+s)))}),e.helper.find(".vbs-keywords-list-wrapper .vbs-keywords-list-tab li a").each(function(){var a=t(this);if(a.parent().removeClass("key"),"all"===s){a.parent().addClass("key").show();var n=[];for(var r in e.data.speakers)"undefined"!=typeof a.attr("data-spt-"+r)&&n.push(a.attr("data-spt-"+r));a.attr("t",n.join())}else a.is('[speakers*="'+s+'"]')?a.parent().addClass("key").show():a.parent().hide(),a.attr("t",a.attr("data-spt-"+s))});var n=e.helper.find(".vbs-topics .vbs-topics-list li.vbs-active");n.is(":hidden")&&e.keywords.view.setActiveAllTopics(),e.helper.find("#vbs-voice_search_txt").val().trim().length>0&&(e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.api.getSearch([e.helper.find("#vbs-voice_search_txt").val().trim()],!1)),e.settings.keywordsCounter&&e.helper.find(".vbs-keywords-list-tab li a").each(function(){var e=t(this),s=e.attr("t");e.parent().find("span").html("("+s.split(",").length+")")})},getMaxKeywordHeight:function(){var t=e.helper.find(".vbs-topics-list").height(),s=e.keywords.view.getActiveListEl().height()+10;return t>s?t:s},getKeywordHeight:function(){var e=t(".vbs-topics").height(),s=t(".vbs-keywords-list-tab").height()+10;return e>s?e:s},checkKeyword:function(s,a,n){e.helper.find("#vbs-search-string .vbs-search-word-widget .vbs-word a.vbs-add-search-word").remove(),s=e.common.uniqueArray(s);for(var r=0;r<s.length;r++){var i=e.common.replaceTrimAndLower(s[r]);if(!e.common.hasTermInArray(e.keywords.data.keywords,i)){var o=[];if(n.forEach(function(e){e.term===i&&e.hits.forEach(function(e){o.push(e.time)})}),o.length>0){var l=t(vbsTemplates.render("keywords/plus"));l.data("data-kwa",s[r]),l.data("data-kwt",o.join(",")),e.helper.find("#vbs-search-string .vbs-search-word-widget .vbs-word").each(function(){var e=t(this).find(".vbs-search_word").text();e===s[r]&&t(this).append(l)})}}}}},events:{init:function(s){var a=this;e.settings.toggleBlocks&&e.settings.toggleKeywordsBlock&&e.helper.find(".vbs-keywords-block .vbs-section-title").on(s,function(e){a.toggleBlock(e,t(this))}),e.helper.find(".vbs-keywords-block").on(s,".vbs-keywords-list-tab li a",function(e){a.clickKeywordInList(e,t(this))}),e.helper.find(".vbs-keywords-block .vbs-more-btn a").on(s,function(e){a.toggleMore(e,t(this))}),t(document).off(s,".vbs-widget em").on(s,".vbs-widget em",function(e){a.clickKeywordInSearchBar(e,t(this))}),e.helper.find("#vbs-clear-string").on(s,function(e){a.clearSearchBar(e,t(this))}),e.helper.find("#vbs-voice_search_txt").on("keyup",function(){a.keyUpSearchBar()}),e.helper.find("#vbs-voice_search_txt").on("blur",function(e){a.blurSearchBar(e,t(this))}),e.helper.find("#vbs-voice_search_txt").on("change",function(e){a.changeSearchBar(e,t(this))}),e.helper.find("#vbs-search-btn").on(s,function(e){a.clickSearchButton(e)}),e.helper.find("#vbs-search-form").on("submit",function(){return a.submitSearchForm(),!1}),t(document).off(s,".vbs-unquote-btn").on(s,".vbs-unquote-btn",function(e){a.clickUnquote(e)}),e.helper.find("#vbs-search-string").on(s,function(e){a.clickSearchBar(e,t(this))}),e.helper.find(".vbs-topics").on(s,'.vbs-topics-list li[class="vbs-active"]',function(e){e.preventDefault()}),e.helper.find(".vbs-topics").on(s,'.vbs-topics-list li[class!="vbs-active"]',function(){e.keywords.view.selectTopic(t(this))}),e.helper.find(".vbs-keywords-list-tab").on("mouseenter touchstart","li.key a",function(e){a.hoverKeywordInList(e)}),e.helper.find(".vbs-keywords-list-tab").on("mouseleave touchend","li.key a",function(){e.keywords.view.removeKeywordHover()}),e.settings.topicHover===!0&&e.helper.find(".vbs-keywords-block").on({mouseover:function(){a.hoverTopic(t(this))},mouseout:function(){e.keywords.view.removeKeywordHover()}},".vbs-topics-list li a"),e.settings.editKeywords&&(t(document).off(s,".vbs-voicebase_up").on(s,".vbs-voicebase_up",function(e){a.onMoveKeywordUp(e,t(this))}),t(document).off(s,".vbs-voicebase_down").on(s,".vbs-voicebase_down",function(e){a.onMoveKeywordDown(e,t(this))}),t(document).off(s,".vbs-voicebase_first").on(s,".vbs-voicebase_first",function(e){a.onMoveFirstKeyword(e,t(this))}),t(document).off(s,".vbs-voicebase_remove").on(s,".vbs-voicebase_remove",function(e){a.onRemoveKeyword(e,t(this))}),t(document).off(s,".vbs-topic-del-btn-wrap .vbs-cross-btn").on(s,".vbs-topic-del-btn-wrap .vbs-cross-btn",function(e){a.onRemoveTopic(e,t(this))}),t(document).off(s,".vbs-add-search-word").on(s,".vbs-add-search-word",function(e){a.onAddKeyword(e,t(this))})),t(document).off(s,".vbs-topic-delete-popup .vbs-confirm-btn").on(s,".vbs-topic-delete-popup .vbs-confirm-btn",function(t){t.preventDefault(),e.keywords.view.hideRemoveTopicPopup()}),t(document).off(s,".vbs-topic-delete-popup .vbs-cancel-btn").on(s,".vbs-topic-delete-popup .vbs-cancel-btn",function(e){a.onConfirmRemoveTopic(e,t(this))})},toggleBlock:function(e,t){e.preventDefault(),t.toggleClass("vbs-hidden");var s=t.parents(".vbs-keywords-block");t.hasClass("vbs-hidden")?(t.attr("data-title","Show Keywords"),s.find(".vbs-section-body").slideUp(),s.find(".vbs-search-form").hide()):(t.attr("data-title","Hide Keywords"),s.find(".vbs-section-body").slideDown(),s.find(".vbs-search-form").show())},toggleMore:function(t,s){t.preventDefault(),e.settings.keywordsHeight>e.keywords.view.getMaxKeywordHeight()&&(e.settings.keywordsHeight=e.keywords.view.getKeywordHeight());var a="100%";return e.helper.find(".vbs-keywords-list-wrapper").css({height:a}),e.data.kf?(e.data.kf=!1,s.text("Show More..."),e.helper.find(".vbs-keywords-wrapper").animate({height:e.settings.keywordsHeight+"px"},700)):(e.helper.find(".vbs-keywords-wrapper").animate({height:e.keywords.view.getMaxKeywordHeight()+"px"},700),s.text("Hide More..."),e.data.kf=!0),!1
},clickKeywordInList:function(t,s){t.preventDefault(),e.data.keywordClickEvent=!0,"PLAYING"==e.PlayerApi.getStatus()&&e.PlayerApi.pause(),e.helper.showLoader(),e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.keywords.view.removeBoldClass();var a=s.data("keywordInternalName"),n=e.keywords.termFor(a,"url"),r=e.keywords.termFor(a,"marker");e.helper.find("#vbs-voice_search_txt").val(n).change(),s.addClass("bold"),r.length&&e.view.searchWordWidget(r);var i=e.helper.find("#vbs-voice_search_txt");return i.data("data-val",i.val()),e.helper.track("keyword",a),e.api.getSearch(r),e.news.api.getNews(),e.data.keywordClickEvent=!1,!1},hoverKeywordInList:function(s){var a=t(s.target).is("span")?t(s.target).parent():t(s.target),n=a.attr("t");e.keywords.view.keywordHover(n.split(","))},hoverTopic:function(t){var s=t.text().trim(),a=e.keywords.prepareTopicTimes(s);e.keywords.view.keywordHover(a)},clickKeywordInSearchBar:function(s,a){s.preventDefault();var n=a.find(".vbs_word"),r=t("#vbs-voice_search_txt"),i=[];n.length&&(t.each(n,function(e,s){i.push(t(s).find(".search_word").text()),t(s).remove()}),r.val(i.join(" "))),e.helper.find(".vbs-widget-wrap").addClass("focused"),r.css("opacity","1"),e.helper.find("#vbs-search-string").hide(),r.focus()},clearSearchBar:function(t,s){return t.preventDefault(),s.parents(".vbs-search-form").hasClass("vbs-filled")&&(e.news.view.collapseNewsBlock(),e.PlayerApi.pause(),e.helper.find(".vbs-markers, .vbs-search-word-widget").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.helper.find("#vbs-voice_search_txt").val("").change(),e.helper.find(".vbs-kwe-add").remove(),e.helper.find("#vbs-search-string .vbs-marquee .vbs-search-word-widget").stop(!0).css("left",0)),!1},clickSearchBar:function(s,a){s.preventDefault(),e.common.isMobile()&&s.stopPropagation(),(t(s.target).hasClass("vbs-search-word-widget")||0===e.helper.find("#vbs-voice_search_txt").val().length)&&(a.hide(),e.helper.find("#vbs-voice_search_txt").css("opacity","1").focus())},keyUpSearchBar:function(){var t=e.keywords.view.getSearchWordsArray();t.length?e.helper.find(".vbs-powered-by-label").addClass("vbs-hidden-p"):e.helper.find(".vbs-powered-by-label").removeClass("vbs-hidden-p")},blurSearchBar:function(t,s){var a=e.keywords.view.getSearchWordsArray();a.length?(e.view.searchWordWidget(a),e.helper.find(".vbs-powered-by-label").addClass("vbs-hidden-p")):(e.helper.find(".vbs-markers, .vbs-search-word-widget").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.helper.find(".vbs-powered-by-label").removeClass("vbs-hidden-p")),s.data("data-val",s.val()),e.helper.find(".vbs-widget-wrap").removeClass("focused"),e.helper.find("#vbs-search-string").show()},changeSearchBar:function(s,a){e.keywords.view.removeBoldClass();var n=e.helper.find("#vbs-search-string");if(a.val().length>0?e.helper.find(".vbs-search-form").addClass("vbs-filled"):(e.helper.find(".vbs-search-form").removeClass("vbs-filled"),a.css("opacity","1"),n.hide(),e.helper.find("#vbs-voice_search_txt").focus()),t("#vbs-share-search").is(":checked")){var r={};r.vbs=encodeURI(a.val());var i=e.helper.getNewUrl(r);e.helper.find("#vbsp-url").val(i),"undefined"!=typeof addthis&&addthis.update("share","url",i)}e.helper.find(".vbs-kwe-add").remove(),e.keywords.view.updateQuotesVisibility(),n.show()},clickSearchButton:function(t){t.preventDefault(),e.helper.find("#vbs-search-form").submit()},submitSearchForm:function(){if(t("#vbs-searchbar-block").find(".vbs-search-form").hasClass("vbs-form-disabled"))return!1;"PLAYING"==e.PlayerApi.getStatus()&&e.PlayerApi.pause(),e.helper.find("#vbs-voice_search_txt").blur(),e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.helper.find(".vbs-kwe-add").remove();var s=e.keywords.view.getSearchWordsArray();return s.length>0?(e.helper.showLoader(),e.view.searchWordWidget(s),e.api.getSearch(s)):e.keywords.view.updateQuotesVisibility(),!1},clickUnquote:function(t){t.preventDefault(),e.keywords.view.removeQuotes()},onMoveKeywordUp:function(t,s){return t.preventDefault(),"undefined"!=typeof e.settings.webHooks.keywordUp?(e.settings.webHooks.keywordUp(),!1):(e.keywords.view.handleEditKeywordEvent(s,"up"),void 0)},onMoveKeywordDown:function(t,s){return t.preventDefault(),"undefined"!=typeof e.settings.webHooks.keywordDown?(e.settings.webHooks.keywordDown(),!1):(e.keywords.view.handleEditKeywordEvent(s,"down"),void 0)},onMoveFirstKeyword:function(t,s){return t.preventDefault(),"undefined"!=typeof e.settings.webHooks.keywordFirst?(e.settings.webHooks.keywordFirst(),!1):(e.keywords.view.handleEditKeywordEvent(s,"first"),void 0)},onRemoveKeyword:function(t,s){return t.preventDefault(),"undefined"!=typeof e.settings.webHooks.removeKeyword?(e.settings.webHooks.removeKeyword(),!1):(e.keywords.view.handleEditKeywordEvent(s,"remove"),void 0)},onRemoveTopic:function(t,s){t.preventDefault(),e.keywords.view.showRemoveTopicPopup(s)},onConfirmRemoveTopic:function(t,s){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.removeTopic)return e.settings.webHooks.removeTopic(),!1;var a=s.parents(".vbs-topic-delete-popup").attr("data-topic");e.api.removeTopic(a)},onAddKeyword:function(t,s){t.preventDefault(),e.api.addKeywords(s.data("data-kwa"),s.data("data-kwt"))}}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.menus={view:{vbmenus:function(s,a,n){var r="undefined"!=typeof t.fn.zclip,i="undefined"!=typeof addthis;if(r===!1&&i===!1&&e.settings.editKeywords===!1||e.settings.contextMenu===!1&&"keyword"!==a)return!1;s.preventDefault();var o=t(n),l={},d=t(n).parents("ul").hasClass("group");if("timeline"===a){var c;if("ins"==s.target.localName)c=t(s.target).parent().attr("stime");else{var p=s.offsetX||s.clientX-t(s.target).offset().left;c=Math.round(e.data.duration*(p+s.target.offsetLeft)/e.helper.find(".vbs-record-timeline-wrap").width())}l.vbt=c;var v=t("#vbs-voice_search_txt");v.val().length&&(l.vbs=encodeURI(v.val()))}else if("keyword"==a){var u=t(n).data("keywordInternalName");u.match(/\s+/g)&&(u='"'+u+'"'),l.vbs=encodeURI(u)}else if("transcript"==a){var m=t(n).text();m=encodeURI(m),l.vbs=m}t("ul.vbs-vbcmenu").remove();var b=e.helper.getNewUrl(l),f=vbsTemplates.render("menu/menu",{hasCopyLib:r,hasShareLib:i,hasContextMenu:e.settings.contextMenu,url:b,canKeywordMenu:"keyword"==a&&e.settings.editKeywords&&!d,hasPrevKeyword:o.parent().prev().length,hasNextKeyword:o.parent().next().length});t("body").append(f),t(".vbs-keyword_controls").data("keywordInternalName",o.data("keywordInternalName"));var h=t(".vbs-vbcmenu"),g=e.tooltips.view.getPositionElementForTooltip(t(n));h.height()+s.pageY<document.body.clientHeight?h.css({top:g.top+t(n).height()+"px",left:g.left+g.width/2+"px"}):h.css({top:g.top-t(n).height()-h.height()+"px",left:g.left+g.width/2+"px"}),r&&t("#vbc_url").find("a").zclip({path:e.settings.zeroclipboard,copy:b}),i&&addthis.toolbox("#vbc_share")},vbEditMenu:function(e,s){var a=t(s),n=t(".vbs-edit-mode-wrapper");t("ul.vbs-vbcmenu").remove(),n.find(".vbs-menu-target").removeClass("vbs-menu-target"),a.addClass("vbs-menu-target");var r=a.attr("t")/1e3,i=a.hasClass("vbs-edit-speaker"),o=a.prev().hasClass("vbs-edit-speaker"),l=a.attr("m")||"",d=vbsTemplates.render("menu/editMenu",{isInsertSpeaker:!i&&!o,isRenameSpeaker:i,stime:r,speakerKey:l});n.append(d);var c=t(".vbs-vbcmenu"),p=e.clientY+n.scrollTop();c.height()+e.clientY<document.body.clientHeight?c.css({top:p+"px",left:e.pageX+"px"}):(t(s).find("br").length>0&&(p+=15*t(s).find("br").length),c.css({top:p-c.height()-a.height()+"px",left:e.pageX+"px"}))}},events:{init:function(){(e.settings.contextMenu||e.settings.editKeywords)&&(e.helper.find(".vbs-record-timeline-wrap").on("contextmenu taphold",function(t){e.menus.view.vbmenus(t,"timeline",this)}),e.helper.find(".vbs-keywords-wrapper").on("contextmenu taphold",".vbs-keywords-list-wrapper li a",function(t){e.menus.view.vbmenus(t,"keyword",this)}),e.helper.find(".vbs-transcript-prewrapper").on("contextmenu taphold",".vbs-transcript-wrapper span.w",function(t){e.menus.view.vbmenus(t,"transcript",this)}),t(document).off("click.vbs_vbcmenu").on("click.vbs_vbcmenu",function(e){1===e.which&&t("ul.vbs-vbcmenu").css({top:"-5000px"})}),e.helper.find(".vbs-transcript-block").on("contextmenu taphold",".vbs-edition-block span.vbs-wd",function(t){t.preventDefault(),e.menus.view.vbEditMenu(t,this)}))}}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.methods={init:function(t){e.reSettings(t),e.init(e.settings.playerId),e.view.init(this)},ready:function(){e.settings.ready.apply(this)},favorite:function(t){return e.view.favorite(t)},favoriteToggle:function(){var t=e.helper.find(".vbs-star-btn");return t.toggleClass("vbs-active"),t.hasClass("vbs-active")},isFavorite:function(){return e.helper.find(".vbs-star-btn").hasClass("vbs-active")},getPosition:function(){return Math.round(e.PlayerApi.getPosition())},getSearchString:function(){return e.helper.find("#vbs-voice_search_txt").val()},getSharePositionUrl:function(){var t={};return t.vbt=Math.round(e.PlayerApi.getPosition()),e.helper.getNewUrl(t)},getShareSearchStringUrl:function(){var t={};return t.vbs=encodeURI(e.helper.find("#vbs-voice_search_txt").val()),e.helper.getNewUrl(t)},getShareFlag:function(){return e.helper.find('.vbs-share-radio-row input[name="share-opt"]:checked').val()},search:function(t){return e.helper.find("#vbs-voice_search_txt").val(t),e.helper.find("#vbs-search-form").submit(),t},position:function(t){return e.PlayerApi.seek(t),t},destroy:function(){e.helper.clearIntervals(),e.PlayerApi.destroy(),t(this).remove(),t(".vbs-content").remove()},addCustomMarkers:function(t){e.data.customMarkers=t},showCustomMarkers:function(){e.view.showCustomMarkers()},hideCustomMarkers:function(){e.view.hideCustomMarkers()},nextCustomMarkers:function(){var t=e.helper.find(".vbs-custom-markers");e.helper.moveToNextMarker(t)},prevCustomMarkers:function(){var t=e.helper.find(".vbs-custom-markers");e.helper.moveToPrevMarker(t)},addHighlightTranscript:function(t){e.data.highlightSnippets=t},showHighlightTranscript:function(){e.transcript.view.manageHighlightSnippets(!0)},hideHighlightTranscript:function(){e.transcript.view.manageHighlightSnippets(!1)},showAutoGeneratedKeywords:function(){e.keywords.view.showAutoGeneratedKeywords()},hideAutoGeneratedKeywords:function(){e.keywords.view.hideAutoGeneratedKeywords()}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.news={api:{getNews:function(){if(!e.settings.showNewsBlock)return!1;var s=e.keywords.view.getSearchWordsArray();if(0===s.length)return e.news.view.addEmptyMessageForNews("empty"),!1;if(t("#"+e.settings.newsBlock).find(".vbs-section-title").hasClass("vbs-hidden"))return!1;var a=e.helper.find(".vbs-news-block"),n=s;if(t.isArray(n)&&(n=n.join(" ")),e.data.prevNewsRequest===n)return!1;e.data.prevNewsRequest=n,a.find(".vbs-news-wrapper").html(vbsTemplates.render("common/loader"));var r=encodeURI(e.settings.newsUrl+n);t.ajax({type:"GET",url:r,success:function(t){t=JSON.parse(t),e.news.view.createView(t,s)},error:function(e,t,s){console.log(s+": Error "+e.status)}})}},view:{createView:function(s,a){var n=s&&s.d?s.d.results:[];t.isArray(a)&&(a=a.join(", "));var r=e.helper.find(".vbs-news-block");if(r.find(".vbs-news-words").html(a),n.length>0){var i=vbsTemplates.render("news/newsContent",{allNews:n});r.find(".vbs-news-wrapper").html(i),e.settings.hasNewsBlockHeader||r.addClass("vbs-no-header")}else e.news.view.addEmptyMessageForNews("not_found")},addEmptyMessageForNews:function(t){var s=vbsTemplates.render("news/emptyNewsMessage",{mode:t});e.helper.find(".vbs-news-block").find(".vbs-news-wrapper").html(s)},handleToggleBlock:function(t){t.toggleClass("vbs-hidden"),t.hasClass("vbs-hidden")?e.news.view.collapseNewsBlock():(e.news.view.expandNewsBlock(),e.news.api.getNews())},collapseNewsBlock:function(){var s=t("#"+e.settings.newsBlock);if(s.length>0&&e.settings.toggleBlocks&&e.settings.toggleNewsBlock){var a=s.find(".vbs-section-body");s.find(".vbs-section-title").addClass("vbs-hidden").attr("data-title","Show News"),s.find(".vbs-news-words-wrapper").hide(),a.slideUp()}},expandNewsBlock:function(){var s=t("#"+e.settings.newsBlock);if(s.length>0&&e.settings.toggleBlocks&&e.settings.toggleNewsBlock){var a=s.find(".vbs-section-body");s.find(".vbs-section-title").removeClass("vbs-hidden").attr("data-title","Hide News"),s.find(".vbs-news-words-wrapper").show(),a.slideDown()}}}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.Player=function(t,s){var a=this;a.instance=t;var n=e.settings.playerType;n=n.toLowerCase().replace(/^\s+|\s+$/,""),a.player_type=n,a.instance.player_ready=!1,a.find_player_interval=setInterval(function(){if(a.find_player_interval)try{a.interface=new e.interface[n](s,a.instance),clearInterval(a.find_player_interval),a.find_player_interval=null,e.helper.setOnTimeInterval()}catch(t){console.log(t)}},250)},e.interface={youtube:function(t,s){var a=this;if(a.instance=s,document.getElementById(t)&&"iframe"==document.getElementById(t).tagName.toLowerCase()){if("undefined"==typeof YT||"undefined"==typeof YT.Player)throw"not_ready";if(!YT.loaded)throw"not_ready";if(a.instance.ytplayerloaded)return!1;a.youtube_player=new YT.Player(t),a.instance.ytplayerloaded=!0}else a.youtube_player=window.document[t];a.play=function(){a.youtube_player.playVideo()},a.pause=function(){a.youtube_player.pauseVideo()},a.play_state=function(){try{var e=a.youtube_player.getPlayerState();return 1==parseInt(e)||5==parseInt(e)?"PLAYING":"PAUSED"}catch(t){return"PAUSED"}},a.position=function(){try{return a.youtube_player.getCurrentTime()+.07}catch(e){return 0}},a.duration=function(){return a.youtube_player?parseInt(a.youtube_player.getDuration()+.5):!1},a.seek=function(e){e=parseInt(e,10),a.youtube_player.seekTo(e),a.play()},a.get_volume=function(){return a.youtube_player?a.youtube_player.getVolume():!1},a.set_volume=function(e){a.youtube_player.setVolume(e)},a.get_buffer=function(){return a.youtube_player&&a.youtube_player.getVideoBytesLoaded?100*a.youtube_player.getVideoBytesLoaded()/a.youtube_player.getVideoBytesTotal():!1},a.destroy=function(){},window.onYouTubePlayerReady=function(){a.instance.player_ready||(a.instance.player_ready=!0,e.settings.localYoutubeApp&&(YSP.api.init("ytplayer"),YSP.api.getLanguages(function(t){e.data.localYoutubeData.languages=t.languages,e.view.initApi()})))}},jwplayer:function(s,a){var n=this;if(n.instance=a,"undefined"==typeof jwplayer||!jwplayer(s)||!jwplayer(s).play)throw"not_ready";n.jw_player=jwplayer(s),n.jw_player.onReady(function(){i()}),n.jw_player.onError(function(s){t(".vbs-text-error-message").remove();var a=s.message;"Error loading media: File could not be played"===a&&e.common.is_iDevice()&&(a="This media file cannot be played on your current device and operating system. Please try on a different device or upgrade to a supported version of iOS 8.");var n=vbsTemplates.render("messages/textErrorMessage",{errorText:a});t("#"+e.settings.controlsBlock).after(n)});var r=function(){n.play=function(){n.jw_player.play()},n.pause=function(){n.jw_player.pause()},n.play_state=function(){return"PLAYING"==n.jw_player.getState()?"PLAYING":"PAUSED"},n.position=function(){return n.jw_player.getPosition()},n.duration=function(){return n.jw_player.getDuration()},n.seek=function(e){n.jw_player.seek(e)},n.get_volume=function(){return n.jw_player.getVolume()},n.set_volume=function(e){return n.jw_player.setVolume(e)},n.get_buffer=function(){return n.jw_player.getBuffer()},n.get_rendering_mode=function(){return n.jw_player.getRenderingMode()},n.load_file=function(t){e.settings.hasPlaylist?n.jw_player.load(t):n.jw_player.load([{file:t}])},n.getWidth=function(){var e=n.jw_player.getWidth();if("100%"===e){var s=n.jw_player.getContainer();e=t(s).width()}return e},n.getHeight=function(){var e=n.jw_player.getHeight();if("100%"===e){var s=n.jw_player.getContainer();e=t(s).height()}return e},n.setSize=function(e,t){(null===e||"undefined"==typeof e)&&(e=n.jw_player.getWidth()),(null===t||"undefined"==typeof t)&&(t=n.jw_player.getHeight()),n.jw_player.resize(e,t)};var s=null;n.initPluginFromPlaylistItem=function(){var a=n.getCurrentPlaylistItem(),r=e.PlayerApi.getPlaylistItemId(a);if(r.id!==s){s=r.id,delete e.settings.mediaId,delete e.settings.externalId,e.helper.clearIntervals(),r.isMediaid?e.settings.mediaId=a.vbs_mediaid:e.settings.externalId=a.vbs_externalid,e.helper.setOnTimeInterval(),e.view.initApi();var i=n.jw_player.getPlaylistIndex();t(".vbs-playlist-item").removeClass("active"),t(".vbs-selected-playlist-item").find(".vbs-item-name").text(a.title);var o=t("[data-playlist-item-index="+i+"]");o.addClass("active"),o[0].scrollIntoView()}},n.setPlaylistItem=function(e){e=parseInt(e),n.jw_player.playlistItem(e)},n.getPlaylistItemIndex=function(){return n.jw_player.getPlaylistIndex()},n.onChangePlayListItem=function(){n.jw_player.onPlaylistItem(function(){n.initPluginFromPlaylistItem()})},n.getCurrentPlaylistItem=function(){return n.jw_player.getPlaylistItem()},n.getPlaylist=function(){return n.jw_player.getPlaylist()},n.renderPlaylist=function(){var s=n.getPlaylist();t("#"+e.settings.controlsBlock).before(vbsTemplates.render("players/playlist",{playlist:s}))},n.destroy=function(){n.jw_player.getRenderingMode()&&n.jw_player.remove()}},i=function(){if(n.instance.player_ready=!0,r(),e.common.isMobile()){var s=e.PlayerApi.getMobilePlayerSize();n.setSize(s.mobile_width,s.mobile_height),t("#"+e.settings.mediaBlock).css("width",s.mobile_width)}e.settings.hasPlaylist&&(e.settings.nativePlaylist||n.renderPlaylist(),n.onChangePlayListItem())};r()},kaltura:function(s,a){var n=this;if(n.instance=a,n.kaltura_player=t("#"+s).get(0),n.kaltura_states={buffered:0,bytes_total:0,player_state:!1,playhead_time:0,volume:1,ready:!1},window.bytesTotalChangeHandler=function(e){n.kaltura_states.bytes_total=e},window.html5_kaltura_play_handler=function(){console.log("Kaltura is PLAYING!"),n.kaltura_states.player_state=!0},window.html5_kaltura_pause_handler=function(){console.log("Kaltura is PAUSED!"),n.kaltura_states.player_state=!1},window.html5_kaltura_update_playhead=function(e){n.kaltura_states.playhead_time=parseFloat(e)},window.volumeChangedHandler=function(e){n.kaltura_states.volume=e.newVolume},window.bytesDownloadedChangeHandler=function(e){n.kaltura_states.buffered=e.newValue},window.playerSeekEndHandler=function(){n.play()},n.player_state=!1,n.playhead_time=0,n.player_id=s,n.play=function(){n.kaltura_player.sendNotification("doPlay")},n.pause=function(){n.kaltura_player.sendNotification("doPause")},n.play_state=function(){return n.kaltura_states.player_state?"PLAYING":"PAUSED"},n.position=function(){return n.kaltura_states.playhead_time},n.duration=function(){return n.kaltura_player.evaluate("{mediaProxy.entry.msDuration}")/1e3},n.video_id=function(){return n.kaltura_player.evaluate("{mediaProxy.entry.id}")},n.seek=function(e){n.kaltura_player.sendNotification("doPlay"),setTimeout(function(){n.kaltura_player.sendNotification("doSeek",parseFloat(parseInt(e)))},0)},n.play_file=function(e){if(e.video_id!=this.video_id()){var t=e.m||0;n.kaltura_player.sendNotification("changeMedia",{entryId:e.video_id,seekFromStart:t.toString()}),n.timer=setInterval(function(){return"PLAYING"==n.play_state()&&n.video_id()==e.video_id?(clearInterval(n.timer),!0):void n.play()},200)}else this.seek(e.m)},n.get_buffer=function(){return n.kaltura_states.bytes_total&&n.kaltura_states.buffered?100*n.kaltura_states.buffered/n.kaltura_states.bytes_total:0},n.get_volume=function(){return 100*n.kaltura_states.volume},n.set_volume=function(e){n.kaltura_player.sendNotification("changeVolume",e/100)},n.getPlayerIframe=function(){return t("#"+n.player_id+"_ifp").contents()},n.destroy=function(){},window.kdpReady=function(){if(n.kaltura_states.ready=!0,n.instance.player_ready=!0,console.log("Kaltura is ready!"),n.kaltura_player.addJsListener("volumeChanged","volumeChangedHandler"),n.kaltura_player.addJsListener("playerPlayed","html5_kaltura_play_handler"),n.kaltura_player.addJsListener("playerPaused","html5_kaltura_pause_handler"),n.kaltura_player.addJsListener("playerPlayEnd","html5_kaltura_pause_handler"),n.kaltura_player.addJsListener("playerUpdatePlayhead","html5_kaltura_update_playhead"),n.kaltura_player.addJsListener("bytesTotalChange","bytesTotalChangeHandler"),n.kaltura_player.addJsListener("bytesDownloadedChange","bytesDownloadedChangeHandler"),n.kaltura_player.addJsListener("playerSeekEnd","playerSeekEndHandler"),"OBJECT"==n.kaltura_player.tagName&&n.play(),e.settings.markersInNativeTimeline&&e.settings.cssPathForPlayerFrame){var t=document.createElement("link");t.href=e.settings.cssPathForPlayerFrame,t.rel="stylesheet",t.type="text/css";var s=n.getPlayerIframe();s[0].body.appendChild(t)}},window.jsCallbackReady=function(){},!n.kaltura_player||!n.kaltura_player.addJsListener)throw"not_ready";window.kdpReady()},flowplayer:function(s,a){var n=this;if(n.instance=a,"undefined"==typeof flowplayer)throw"not_ready";n.flow_player=t("#"+s);var r=flowplayer(n.flow_player);n.instance.player_ready=!0,n.play=function(){r.play()},n.pause=function(){return r.pause()},n.play_state=function(){var e=r.paused;return e?"PAUSED":"PLAYING"},n.position=function(){return r.video?r.video.time:0},n.duration=function(){return r.video?r.video.duration:0},n.seek=function(e){r.seek(e),n.play()},n.get_buffer=function(){return r.video?100*r.video.buffer/n.duration():0},n.flow_player.bind("volume",function(){var t=n.get_volume();e.PlayerApi.setUiVolume(t)}),n.get_volume=function(){return 100*r.volumeLevel},n.set_volume=function(e){r.volume(e/100)},n.destroy=function(){}},video_js:function(s,a){var n=this;if(n.instance=a,n.player_id=s,"undefined"==typeof videojs)throw"not_ready";var r=videojs(s);n.instance.player_ready=!0,n.play=function(){r.play()},n.pause=function(){r.pause()},n.play_state=function(){return r.paused()?"PAUSED":"PLAYING"},n.position=function(){return r.currentTime()},n.duration=function(){return r.duration()},n.seek=function(e){r.currentTime(e),n.play()},n.get_buffer=function(){return 100*r.bufferedPercent()||0},r.on("volumechange",function(){var t=n.get_volume();e.PlayerApi.setUiVolume(t)}),n.get_volume=function(){return 100*r.volume()},n.set_volume=function(e){r.volume(e/100)},n.destroy=function(){t("#"+n.player_id).length>0&&r.dispose()}},jplayer:function(s,a){var n=this;n.instance=a,n.player_id=s;var r=t("#"+n.player_id);n.default_size={width:t("#"+n.player_id).width(),height:t("#"+n.player_id).height()},n.play=function(){r.jPlayer("play")},n.pause=function(){r.jPlayer("pause")},n.play_state=function(){return r.data("jPlayer").status.paused?"PAUSED":"PLAYING"},n.position=function(){return r.data("jPlayer").status.currentTime||0},n.duration=function(){return r.data("jPlayer").status.duration||0},n.seek=function(e){e=parseInt(e),r.jPlayer("play",e)},n.get_buffer=function(){return 0},n.get_volume=function(){return 100*r.data("jPlayer").options.volume||0},n.set_volume=function(e){t("#jplayer").jPlayer("volume",e/100)},n.isVideo=function(){return r.data("jPlayer").status.video},n.getGui=function(){return t(r.data("jPlayer").ancestorJq)},n.initEvents=function(){r.bind(t.jPlayer.event.volumechange,function(){var t=n.get_volume();e.PlayerApi.setUiVolume(t)})},n.getWidth=function(){var e=r.jPlayer("option","size");return e.width},n.getHeight=function(){var e=r.jPlayer("option","size");return e.height},n.setSize=function(e,t){r.jPlayer({size:{width:e,height:t}})},n.setDefaultSize=function(){n.setSize(n.default_size.width,n.default_size.height)},n.destroy=function(){r.jPlayer("destroy")};var i=function(){n.instance.player_ready=!0;var e=n.getGui();n.isVideo()||e.hide(),n.initEvents()};i()}},e.PlayerApi={startPlayer:function(t){e.helper.showLoader(),window.setTimeout(function(){e.PlayerApi.cseek(t)},200),window.setTimeout(function(){e.data.movelistner=!1,e.data.dragging=!1},300)},cseek:function(t){e.instances[e.current_instance].player.interface.seek(t)},seek:function(t){e.PlayerApi.startPlayer(t)},play:function(){e.instances[e.current_instance].player.interface.play()},pause:function(){e.instances[e.current_instance].player.interface.pause()},getOffset:function(t){var s=e.helper.find(".vbs-record-timeline-wrap");return t*s.width()/e.data.duration},getDuration:function(){return e.instances[e.current_instance].player.interface.duration()},getPosition:function(){return e.instances[e.current_instance].player.interface.position()},getStatus:function(){return e.instances[e.current_instance].player.interface.play_state()},getVolume:function(){return e.instances[e.current_instance].player.interface.get_volume()},setVolume:function(t){return e.instances[e.current_instance].player.interface.set_volume(t)},setUiVolume:function(t){e.helper.find(".vbs-volume-slider-full").css("height",t+"%"),e.helper.find(".vbs-volume-slider-handler").css("bottom",t+"%")},getBuffer:function(){return e.instances[e.current_instance].player.interface.get_buffer()},getRenderingMode:function(){return e.instances[e.current_instance].player.interface.get_rendering_mode()},loadFile:function(t){return e.instances[e.current_instance].player.interface.load_file(t)},isPlayerReady:function(){return e.instances[e.current_instance].player_ready},getMobilePlayerSize:function(){var t=e.PlayerApi.getPlayerWidth(),s=e.PlayerApi.getPlayerHeight(),a=t&&s?t/s:0,n=e.helper.getMobileWidth(),r=n/a;return r=r>screen.availHeight?screen.availHeight:r,{mobile_width:n,mobile_height:r}},getPlayerWidth:function(){return e.instances[e.current_instance].player.interface.getWidth()},getPlayerHeight:function(){return e.instances[e.current_instance].player.interface.getHeight()},setSizePlayer:function(t,s){var a=e.instances[e.current_instance].player.interface;return a&&a.setSize?a.setSize(t,s):null},setDefaultSizePlayer:function(){return e.instances[e.current_instance].player.interface.setDefaultSize()},hidePlayer:function(){if("kaltura"!=e.settings.playerType)var s=setInterval(function(){e.instances.length&&(clearTimeout(s),e.helper.findc(".vbs-player-wrapper").css({height:0}),"jwplayer"===e.settings.playerType&&(e.PlayerApi.setSizePlayer(0,0),t("#"+e.settings.playerId).css({opacity:0})))},100)},setPlaylistItem:function(t){return e.instances[e.current_instance].player.interface.setPlaylistItem(t)},getPlaylistItemIndex:function(){return e.instances[e.current_instance].player.interface.getPlaylistItemIndex()},getPlaylist:function(){return e.instances[e.current_instance].player.interface.getPlaylist()},getCurrentPlaylistItem:function(){return e.instances[e.current_instance].player.interface.getCurrentPlaylistItem()},getPlaylistItemId:function(e){var t,s=!1;return e.vbs_mediaid?(t=e.vbs_mediaid,s=!0):e.vbs_externalid&&(t=e.vbs_externalid),{id:t,isMediaid:s}},getStreamUrl:function(t){var s="";return"html5"!=e.PlayerApi.getRenderingMode()&&"rtmp"==e.settings.stream?s=t.rtmpUrl+""+t.rtmpFile:("http"==e.settings.stream||e.settings.stream===!0)&&(s=t.streamUrl),s},getPlayerIframe:function(){return e.instances[e.current_instance].player.interface.getPlayerIframe()},destroy:function(){e.instances[e.current_instance]&&e.instances[e.current_instance].player&&e.instances[e.current_instance].player.interface&&e.instances[e.current_instance].player.interface.destroy&&e.instances[e.current_instance].player.interface.destroy()}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return jQuery.extend(jQuery.expr[":"],{speakertime:function(e,s,a){var n=parseFloat(t(e).attr("s")),r=parseFloat(t(e).attr("e")),i=a[3].split(/\s?,\s?/),o=parseFloat(i[0]);return!isNaN(n)&&!isNaN(r)&&!isNaN(o)&&r>=o&&o>=n}}),e.speakers={getSpeakersKeys:function(){return Object.keys(e.data.speakers)},inSpeakers:function(t){for(var s in e.data.speakers)if(e.data.speakers[s].toLowerCase()==t.toLowerCase())return!0;return!1},getSpeakerNameByKey:function(t){return"undefined"!=typeof e.data.speakers[t]?e.data.speakers[t]:""},getSpeakerKeyByName:function(t){for(var s in e.data.speakers)if(e.data.speakers[s].toLowerCase()==t.toLowerCase())return s;return""},setSpeakerName:function(t,s){for(var a in e.data.speakers)if(a===t)return e.data.speakers[a]=s,!0;return!1},addSpeakerKey:function(t){if(t&&!e.speakers.inSpeakers(t)&&">>"!=t){var s=Object.keys(e.data.speakers).length+1;return e.data.speakers["vbs-sp"+s+"o"]=t,!0}return!1},filterResultForSpeaker:function(t){if("undefined"==typeof e.settings.filterSpeaker||"all"==e.settings.filterSpeaker)return!0;for(var s in e.data.allSpeakers)if(1e3*t>parseFloat(e.data.allSpeakers[s].t)&&("undefined"!=typeof e.data.allSpeakers[parseInt(s)+1]&&1e3*t<=parseFloat(e.data.allSpeakers[parseInt(s)+1].t)||"undefined"==typeof e.data.allSpeakers[parseInt(s)+1]&&1e3*t<=1e3*e.data.duration)&&e.speakers.getSpeakerKeyByName(e.data.allSpeakers[parseInt(s)].s)==e.settings.filterSpeaker)return!0;return!1},parseSpeakersInCategory:function(t){var s=[];return t&&t.forEach(function(t){var a=e.common.replaceAndTrim(t);e.speakers.addSpeakerKey(a),s.push(e.speakers.getSpeakerKeyByName(a))}),s},createSpeakerAttr:function(t){var s=e.transcript.isTurn(t.m),a=e.transcript.view.getClearWordFromTranscript(t.w),n=s?a:!1,r="";if(n){e.speakers.addSpeakerKey(n);var i=e.speakers.getSpeakerKeyByName(n);r='m="'+i+'"'}return r},view:{filterSpeakersList:function(s){e.helper.find(".vbs-speaker-dropdown li").removeClass("vbs-disabled").each(function(){var e=t(this),a=e.attr("data-speaker");s.indexOf(a)<0&&"all"!=a&&e.addClass("vbs-disabled")})},speakerIsSpeaking:function(){var s=1e3*e.data.position,a=t(".vbs-speakers > div:speakertime("+s+")");if(a.length){var n=a.attr("cnum"),r=e.speakers.getSpeakerNameByKey(n);if("undefined"!=typeof r&&e.data.lspeaker!=r&&">>"!=r.trim()){e.data.lspeaker=r;var i=vbsTemplates.render("speakers/speakerIsSpeaking",{speakerKey:n,speakerName:r});e.helper.find(".vbs-voice-name").html(i),e.helper.adjustMediaTime()}}else e.helper.find(".vbs-voice-name").html("")},speakersWidget:function(){var s=[],a=1,n=e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper");n.find("span.w[m]").each(function(){var n=t(this),r={};r.s=e.speakers.getSpeakerNameByKey(n.attr("m")),r.t=n.attr("t"),s.push(r);var i,o="";e.settings.turnTimes&&(">>"==r.s.trim()?(i=a%2?"vbs-sp1":"vbs-sp2",a++):i=e.speakers.getSpeakerKeyByName(r.s),o+=vbsTemplates.render("speakers/speakerTranscriptLabel",{spClass:i,speakerName:r.s,speakerTime:e.common.parseTime(r.t/1e3)})),jQuery(o).insertBefore(this)}),a>1&&n.addClass("vbs-machine"),a=1,e.data.allSpeakers=s,s.length&&(e.speakers.view.renderSpeakersInTimeline(),a>1&&($speakers.addClass("vbs-machine"),e.helper.find(".vbs-media-block .vbs-section-title, .vbs-time-name-wrapper-narrow").addClass("vbs-machine")))},renderSpeakersInTimeline:function(){var t=e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper"),s=e.data.allSpeakers;if(s.length){e.settings.turnTimes&&t.addClass("vbs-turntimes");var a="",n=1;s.forEach(function(t,r){var i=s[r+1];t.s=e.common.replaceAndTrim(t.s);var o,l,d=e.PlayerApi.getOffset(t.t/1e3);i?(o=e.PlayerApi.getOffset((i.t-t.t)/1e3),l=parseFloat(i.t)):(o=e.PlayerApi.getOffset(e.data.duration-t.t/1e3),l=1e3*e.data.duration);var c;">>"==t.s.trim()?(c=n%2?"vbs-sp1":"vbs-sp2",n++):c=e.speakers.getSpeakerKeyByName(t.s),a+=" "+vbsTemplates.render("speakers/timelineSpeaker",{position:d,width:o,s:parseFloat(t.t),e:l,speaker:t.s,colorclass:c})}),e.helper.find(".vbs-speakers").html(a)}},speakerFilterWidget:function(t){var s=vbsTemplates.render("speakers/speakerList",{speakers:t});if(e.helper.find(".vbs-search-form").removeClass("vbs-no-speaker"),!e.settings.searchBarOuter){var a=e.helper.findc("#"+e.settings.keywordsBlock),n=e.helper.find(".vbs-keywords-wrapper");a.width()<e.settings.mediumResponsiveWithSpeakers&&a.width()>=e.settings.minResponsive&&(a.addClass("less-600px"),n.height(n.height()-55))
}e.helper.find(".vbs-select-speaker-wrapper .vbs-select-dropdown").html(s)},createInsertSpeakerDialog:function(s){t(".vbs-insert-speaker-popup").remove();var a=e.speakers.view.getPopupPosition(s),n=e.speakers.view.getSpeakersFromEditor(),r=vbsTemplates.render("speakers/insertSpeakerPopup",{top:a.top,left:a.left,speakersKeys:n,getSpeakerNameByKey:e.speakers.getSpeakerNameByKey});t(".vbs-edit-mode-wrapper").append(r),t(".vbs-insert-speaker-popup").fadeIn(function(){t(".vbs-insert-speaker-input").focus()})},selectSpeakerInInsertDialog:function(s){s.parents(".vbs-select-dropdown").fadeOut("fast");var a=t(".vbs-select-insert-speaker"),n=a.find(".vbs-speaker-selected"),r=t(".vbs-speaker-input-wrapper"),i=s.attr("data-speaker-key");if(i){var o=e.speakers.getSpeakerNameByKey(i);a.removeClass("vbs-new-speaker").attr("data-speaker-key",i),r.hide(),n.html(o)}else{var l=r.find(".vbs-insert-speaker-input");r.show(),a.addClass("vbs-new-speaker"),n.html("Insert new speaker"),setTimeout(function(){l.focus()},0)}a.removeClass("vbs-s-show")},insertSpeakerToEditor:function(){var s,a,n=t(".vbs-edit-mode-wrapper").find(".vbs-menu-target"),r=t(n).attr("t"),i=t(".vbs-select-insert-speaker");if(i.hasClass("vbs-new-speaker")?(s=t(".vbs-insert-speaker-input").val(),e.speakers.addSpeakerKey(s),a=e.speakers.getSpeakerKeyByName(s)):(a=i.attr("data-speaker-key"),s=e.speakers.getSpeakerNameByKey(a)),!n.prev().hasClass("vbs-edit-speaker")&&a){var o=vbsTemplates.render("speakers/insertSpeakerText",{speakerKey:a,speakerTime:r,speakerName:s});n.first().before(o)}},getSpeakersFromEditor:function(){var e=[],s=t(".vbs-edit-speaker");return s.each(function(){var s=t(this).attr("m"),a=e.filter(function(e){return e===s});a.length||e.push(s)}),e},findSpeakerElementsInEditor:function(e){var s=t(".vbs-edit-mode-wrapper"),a=[];return s.find(".vbs-edit-speaker").each(function(){var s=t(this).attr("m");e===s&&a.push(t(this))}),a},createRenameSpeakerDialog:function(s){t(".vbs-rename-speaker-popup").remove(),e.speakers.view.enableRenameAllSpeakersInEditor();var a=e.speakers.view.getPopupPosition(s),n=s.attr("data-speaker-key"),r=e.speakers.getSpeakerNameByKey(n),i=vbsTemplates.render("speakers/renameSpeakerPopup",{top:a.top,left:a.left,currentSpeakerKey:n,currentSpeakerName:r});t(".vbs-edit-mode-wrapper").append(i),e.speakers.view.disableRenameSpeakersInEditor(n),t(".vbs-rename-speaker-popup").fadeIn(function(){t("#vbs-rename_speaker_input").focus()})},renameSpeaker:function(){var s=(t(".vbs-edit-mode-wrapper"),t("#vbs-rename_speaker_input").val()),a=t("#vbs-rename_speaker_input").attr("data-old-speaker-key");e.speakers.inSpeakers(s)||e.speakers.addSpeakerKey(s);var n=e.speakers.getSpeakerKeyByName(s),r=e.speakers.view.findSpeakerElementsInEditor(a);r.forEach(function(e){e.text(s+":").prepend("<br><br>").attr("m",n)}),e.speakers.view.clearEditorSpeakers(),e.speakers.view.enableRenameAllSpeakersInEditor(a)},renameSpeakerFromEditor:function(t){var s=e.transcript.view.getClearWordFromTranscript(t.text());-1!=s.lastIndexOf(":")&&(s=s.substring(0,s.lastIndexOf(":"))),e.speakers.inSpeakers(s)||e.speakers.addSpeakerKey(s);var a=e.speakers.getSpeakerKeyByName(s);t.attr("m",a),e.speakers.view.clearEditorSpeakers()},clearEditorSpeakers:function(){var s=t(".vbs-edit-mode-wrapper");Object.keys(voiceBase.data.speakers).forEach(function(t){var a=s.find('span.w[m="'+t+'"]');0===a.length&&(e.data.speakers[t]="")})},disableRenameSpeakersInEditor:function(t){var s=e.speakers.view.findSpeakerElementsInEditor(t);s.forEach(function(e){e.attr("contenteditable","false")})},enableRenameAllSpeakersInEditor:function(){var e=t(".vbs-edit-speaker");e.each(function(){t(this).attr("contenteditable","true")})},getPopupPosition:function(){var e=t(".vbs-vbcmenu"),s=t(".vbs-edit-mode-wrapper"),a=e.offset().top+s.scrollTop(),n=e.offset().left;return{top:a,left:n}}},events:{init:function(s){var a=this,n=e.helper.find(".vbs-select-speaker"),r=e.helper.find(".vbs-widget-wrap");t("#vbs-keywords").width()<=437&&(n.addClass("vbs-fixed-width"),r.addClass("vbs-without-min-width")),t("#vbs-keywords").width()<=360&&e.helper.find(".vbs-search-form").addClass("less-360px"),e.helper.find(".vbs-select-speaker").on(s,function(s){s.preventDefault(),e.helper.toggleDropdown(t(this))}),e.helper.find(".vbs-select-speaker-wrapper .vbs-select-dropdown").on(s,"li",function(e){a.selectSpeaker(e,t(this))}),t(document).off(s,".vbsc-edit-speaker").on(s,".vbsc-edit-speaker",function(e){a.onClickEditSpeaker(e,t(this))}),t(document).off(s,".vbs-select-insert-speaker").on(s,".vbs-select-insert-speaker",function(s){s.preventDefault(),e.helper.toggleDropdown(t(this))}),t(document).off(s,".vbs-select-insert-speaker-wrapper .vbs-select-dropdown li").on(s,".vbs-select-insert-speaker-wrapper .vbs-select-dropdown li",function(s){s.preventDefault(),e.speakers.view.selectSpeakerInInsertDialog(t(this))}),t(document).off(s,".vbs-insert-speaker-popup .vbs-cancel-btn").on(s,".vbs-insert-speaker-popup .vbs-cancel-btn",function(s){s.preventDefault(),e.common.hidePopup(t(".vbs-insert-speaker-popup"))}),t(document).off(s,".vbs-insert-speaker-popup .vbs-confirm-btn").on(s,".vbs-insert-speaker-popup .vbs-confirm-btn",function(e){a.onInsertSpeaker(e)}),t(document).off(s,".vbsc-rename-speaker").on(s,".vbsc-rename-speaker",function(s){s.preventDefault(),e.speakers.view.createRenameSpeakerDialog(t(this))}),t(document).off(s,".vbs-rename-speaker-popup .vbs-cancel-btn").on(s,".vbs-rename-speaker-popup .vbs-cancel-btn",function(e){a.onCancelRenameSpeaker(e)}),t(document).off(s,".vbs-rename-speaker-popup .vbs-confirm-btn").on(s,".vbs-rename-speaker-popup .vbs-confirm-btn",function(e){a.onConfirmRenameSpeaker(e)}),t(document).off("blur keyup paste",".vbs-edition-block").on("blur keyup paste",".vbs-edition-block",function(){a.onEditSpeakerFromEditor()})},selectSpeaker:function(t,s){t.preventDefault();var a=e.helper.find(".vbs-select-speaker"),n=e.helper.find(".vbs-search-btn"),r=e.helper.find(".vbs-widget-wrap"),i=parseInt(r.css("paddingLeft"))+parseInt(r.css("paddingRight")),o=n.width()+parseInt(n.css("borderLeft")),l=parseInt(a.css("paddingLeft"))+parseInt(a.css("paddingRight")),d=parseInt(a.css("borderLeftWidth"))+parseInt(a.css("borderRightWidth")),c=parseInt(r.css("minWidth"));if(a.css("width","auto"),s.hasClass("vbs-disabled"))return!1;e.helper.find(".vbs-select-dropdown").fadeOut("fast");var p=s.attr("data-speaker"),v="all"==p?"Select speaker...":s.text();if(e.helper.find(".vbs-select-speaker").removeClass("vbs-s-show").html(v),e.keywords.view.filterKeywords(p),!e.settings.searchBarOuter){var u,m,b,f=s.parents("#vbs-keywords");if(f.hasClass("less-600px")){if(f.width()<=437)return!1;u=a.width()+l+d;var h=12;if(n.css("right",u+h),r.css("marginRight",u+o+h),r.width()<=c){m=e.helper.find(".vbs-keywords-block").width();var g=e.helper.find(".vbs-widget-wrap"),w=parseInt(g.css("borderLeftWidth"))+parseInt(g.css("borderRightWidth"));b=m-(c+w+o+h+d+l+i),a.css("width",b),n.css("right",b+l+d+h),r.css("marginRight",b+l+d+o+h)}}else if(u=a.width()+l+d,n.css("right",u),r.css("marginRight",u+o),r.width()<=c){m=e.helper.find(".vbs-keywords-block").width()-parseInt(e.helper.find(".vbs-keywords-block .vbs-section-header").css("borderLeftWidth"))-parseInt(e.helper.find(".vbs-keywords-block .vbs-section-header").css("borderRightWidth"));var y=e.helper.find(".vbs-keywords-block .vbs-section-title").width()+parseInt(e.helper.find(".vbs-keywords-block .vbs-search-form").css("borderLeftWidth"));b=m-(y+o+c+d+l+i+1),a.css("width",b),n.css("right",b+l+d),r.css("marginRight",b+l+d+o)}}},onClickEditSpeaker:function(s){s.preventDefault(),e.speakers.view.createInsertSpeakerDialog(t(this))},onInsertSpeaker:function(s){s.preventDefault();var a=t(".vbs-insert-speaker-popup"),n=e.validator.validate(a);n&&(e.speakers.view.insertSpeakerToEditor(),e.common.hidePopup(a))},onCancelRenameSpeaker:function(s){s.preventDefault(),e.speakers.view.enableRenameAllSpeakersInEditor(),e.common.hidePopup(t(".vbs-rename-speaker-popup"))},onConfirmRenameSpeaker:function(s){s.preventDefault();var a=t(".vbs-rename-speaker-popup"),n=e.validator.validate(a);n&&(e.speakers.view.renameSpeaker(),e.common.hidePopup(a))},onEditSpeakerFromEditor:function(){var s=window.getSelection?window.getSelection():document.selection;if(s.focusNode&&s.focusNode.parentElement){var a=t(s.focusNode.parentElement);a.hasClass("vbs-edit-speaker")&&e.speakers.view.renameSpeakerFromEditor(a)}}}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.tooltips={view:{init:function(){t(".vbs-tooltip").remove(),t("body").append('<span class="vbs-tooltip"></span>'),t("[data-title]").each(function(){var s=t(this),a=t(".vbs-tooltip");s.hover(function(){a.stop(!0,!0).hide();var t=s.attr("data-title");a.text(t);var n=e.tooltips.view.getPositionElementForTooltip(s),r=parseInt(a.css("width"))+20,i=34,o={top:n.top>i?n.top-i:n.top+n.height+8,left:n.left+n.width/2-r/2};a.css({top:o.top+"px",left:o.left+"px"}),n.top>i?a.removeClass("vbs-arrow-on-top"):a.addClass("vbs-arrow-on-top"),a.stop(!0,!0).fadeIn(100)},function(){a.stop(!0,!0).fadeOut(100)})})},getPositionElementForTooltip:function(e){var s=e[0].getBoundingClientRect(),a=e.offset(),n={scroll:e.scrollTop()},r=t("body"),i={top:0,left:0};("absolute"===r.css("position")||"relative"===r.css("position")||"fixed"===r.css("position"))&&(i=r.offset());var o=t.extend({},s,n,a);return o.top-=i.top,o.left-=i.left,o},hideTooltips:function(){t(".vbs-tooltip").hide()}}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.transcript={isTurn:function(e){return"undefined"!=typeof e&&"turn"==e},view:{createView:function(t){e.api.response.transcript=t;var s=e.helper.find(".vbs-transcript-block");if(("FAILURE"==t.requestStatus||"MACHINECOMPLETE"!=t.fileStatus&&"HUMANCOMPLETE"!=t.fileStatus)&&(e.api.ready.transcript=!0,e.api.setErrors(t),"FAILURE"===t.requestStatus&&(!t.transcript||t.transcript&&0===t.transcript.length)))return s.addClass("vbs-ho").append(vbsTemplates.render("common/disabler")).show(),!1;if("human"==t.transcriptType?s.addClass("vbs-human").find(".vbs-section-title").attr("data-title","Hide Transcript"):e.settings.vbsButtons.orderTranscript&&s.addClass("vbs-with-order-btn"),e.settings.humanOnly&&"machine"==t.transcriptType)return!1;for(var a="",n=0,r=t.transcript,i="",o=!1,l=0,d=r.length,c=0;d>c;c++){var p=r[c];0===c&&(a+='<span t="0">'),Math.floor(p.s/1e3)>=l+e.settings.transcriptHighlight&&(l+=e.settings.transcriptHighlight,a+='</span><span t="'+l+'">'),n+=p.s,o=e.transcript.isTurn(p.m);var v=e.speakers.createSpeakerAttr(p),u=o&&c>2?"<br/><br/>":"",m=e.settings.lineBreak&&"undefined"!=typeof r[c-1]&&r[c].s-r[c-1].e>1e3*e.settings.lineBreak?"<br/><br/>":"";i=0===c&&"undefined"==typeof p.m?"data-f=true":"";var b=e.common.replaceN(p.w);a+=p.w.match(/\w+/g)?u+m+'<span class="w vbs-trans-word" t="'+p.s+'" '+v+" "+i+"> "+b+"</span>":'<span class="vbs-punc vbs-trans-word" t="'+p.s+'" '+v+">"+b+"</span>"}a+="</span>",s.find(".vbs-transcript-wrapper").html(a),o&&""!==i&&s.find(".vbs-transcript-wrapper span[data-f=true]").before('<span class="w" t="0" m=">> "><br><br>&gt;&gt; </span>'),s.not(".vbs-human").length&&!e.settings.expandTranscriptBlock&&(s.find(".vbs-section-body").hide(),s.find(".vbs-section-title").addClass("vbs-hidden").attr("data-title","Show Transcript")),s.find(".vbs-transcript-prewrapper").css("height",e.settings.transcriptHeight+"px"),s.slideDown("fast"),e.transcript.view.setOrderTranscriptUrl(),e.api.ready.transcript=!0,e.transcript.view.setResizeTranscript(),"REPROCESSING"!=t.fileStatus||e.settings.modalSave||(e.transcript.view.setIsSaving(!0),e.api.triggerTranscriptStatus())},setOrderTranscriptUrl:function(){var t=e.settings.apiUrl.replace("services","orderTranscript"),s=e.settings.mediaId?e.settings.mediaId:e.settings.externalId,a=t+"/"+s+"?token="+e.settings.token+"&cancel=close";e.helper.find(".vbs-order-human-trans a").attr("href",a)},editTranscriptText:function(){for(var t=e.api.response.transcript.transcript,s="",a=0,n=0,r=t.length,i=0;r>i;i++){var o=t[i];0===i&&(s+='<span t="0">'),Math.floor(o.s/1e3)>=n+e.settings.transcriptHighlight&&(n+=e.settings.transcriptHighlight,s+='</span><span t="'+n+'">'),a+=o.s;var l=e.speakers.createSpeakerAttr(o),d=e.common.replaceN(o.w);s+=o.w.match(/\w+/g)?'<span class="w vbs-wd '+(l.length?"vbs-edit-speaker":"")+'" t="'+o.s+'" '+l+"> "+d+"</span>":'<span class="vbs-wd" t="'+o.s+'" '+l+">"+d+"</span>"}return s+="</span>"},getClearWordFromTranscript:function(t){return e.common.replaceAndTrim(t).replace(/:$/,"")},setResizeTranscript:function(){if(e.settings.transcriptResizable&&t.isFunction(t.fn.resizable)){var s=t("#"+e.settings.transcriptBlock),a=s.find(".vbs-section-body"),n=s.width(),r=s.offset(),i=r&&r.left?t(document).width()-Math.round(r.left)-10:s.width();e.helper.find(".vbs-resizable").resizable({minWidth:n,maxWidth:i,resize:function(){var s=t(this).width();a.width(s),a.siblings(".vbs-section-header").width(s),e.transcript.view.checkScrollForResize(a)}}),e.transcript.view.checkScrollForResize(a)}},checkScrollForResize:function(e){var t=e.find(".vbs-transcript-wrapper");e.height()>t.height()?e.find(".ui-resizable-se,.ui-resizable-e").addClass("vbs-no-scroll"):e.find(".ui-resizable-se,.ui-resizable-e").removeClass("vbs-no-scroll")},handleToggle:function(e){e.toggleClass("vbs-hidden"),e.hasClass("vbs-hidden")?(e.attr("data-title","Show Transcript"),e.parents(".vbs-transcript-block").find(".vbs-section-body").slideUp()):(e.attr("data-title","Hide Transcript"),e.parents(".vbs-transcript-block").find(".vbs-section-body").slideDown())},highlight:function(s){var a=Math.round(s);1==a&&(a=0);var n=Math.floor(a/e.settings.transcriptHighlight);a=n*e.settings.transcriptHighlight;var r=e.helper.find(".vbs-transcript-block"),i=r.find(".vbs-transcript-wrapper"),o=r.find(".vbs-transcript-prewrapper");i.children("span").removeClass("vbs-hl"),i.children("span:wordtime("+a+","+(a+e.settings.transcriptHighlight-1)+")").addClass("vbs-hl");var l=i.children("span.vbs-hl").length?i.children("span.vbs-hl"):!1,d=o.length?o:!1;l&&d&&o.not(".vbs-t-hover").stop(!0,!0).animate({scrollTop:l.offset().top-d.offset().top+d.scrollTop()-(d.height()-20)/2},500),t("body").hasClass("vbs-readermode")&&o.not(".vbs-t-hover").length&&(d=r.length?r:!1,l&&d&&r.stop(!0,!0).animate({scrollTop:l.offset().top-d.offset().top+d.scrollTop()-(d.height()-20)/2},500))},manageHighlightSnippets:function(s){for(var a=e.data.highlightSnippets,n=e.helper.find(".vbs-transcript-wrapper"),r=0;r<a.length;r++){var i=a[r],o=n.find(".vbs-trans-word:wordtime("+1e3*i.startTime+","+1e3*i.endTime+")");o.each(function(){var e=s?i.color:"";t(this).css("background-color",e)})}},saveTranscript:function(){var t=e.helper.find(".vbs-edition-block").html();t=t.replace(/<br\s*[\/]?>/gi,"\n"),t=t.replace(/\\n/,"\n");var s=document.createElement("div");s.innerHTML=t;var a=s.textContent||s.innerText||"";e.api.saveTrancript(a.trim());var n=e.helper.find(".vbs-save-popup-wrapper");e.settings.modalSave?(n.find(".vbs-save-popup").fadeOut("fast"),n.find(".vbs-save-loading-popup").fadeIn("fast")):(n.fadeOut("fast"),e.helper.exitEditFullscreen())},saveTranscriptComplete:function(){e.transcript.view.setIsSaving(!1),e.view.initAfterSaveTranscript(),e.data.waiterSave=setInterval(function(){e.data.waiterSave&&e.helper.waitReadyAfterSave()},100)},showSaveQuestion:function(){var s=t(".vbs-edit-speaker").length,a=e.helper.find(".vbs-edition-block").find('.w:not(".vbs-edit-speaker")').length,n=t(".vbs-transcript-prewrapper").find(".w").length-s,r=t(".vbs-save-popup");r.removeClass("vbs-long-edit vbs-short-edit"),a>n&&a>n/5?r.addClass("vbs-long-edit"):n>a&&n/5>a&&r.addClass("vbs-short-edit"),e.helper.find(".vbs-save-popup-wrapper").fadeIn("fast")},saveTranscriptError:function(s){if(e.transcript.view.setIsSaving(!1),e.settings.modalSave){var a=e.helper.find(".vbs-save-popup-wrapper");a.find(".vbs-save-popup").show(),a.find(".vbs-save-loading-popup").fadeOut("fast"),a.fadeOut("fast");var n=vbsTemplates.render("messages/abstractErrorPopup",{errorTitle:"Could not save transcript",errorText:s});t(".vbsp-"+e.helper.randId()+".vbs-content").append(n)}else{e.transcript.view.clearSavingMessages();var r=vbsTemplates.render("messages/textErrorMessage",{errorText:s});t("#"+e.settings.controlsBlock).after(r)}},setIsSaving:function(s){e.data.isSaving=s,e.settings.modalSave||(s?(t(".vbs-edit-btn").addClass("vbs-disable-button"),e.transcript.view.clearSavingMessages(),t("#"+e.settings.controlsBlock).after(vbsTemplates.render("messages/savingMessage"))):t(".vbs-edit-btn").removeClass("vbs-disable-button"))},clearSavingMessages:function(){t(".vbs-saving").remove(),t(".vbs-success-saving").remove(),t(".vbs-text-error-message").remove()},getIsSaving:function(){return e.data.isSaving}}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.utterances={view:{createView:function(s){var a="",n="";if(s.forEach(function(t,s){t.segments.forEach(function(t){var n=e.PlayerApi.getOffset(t.s),r=e.PlayerApi.getOffset(t.e),i=r-n,o=e.common.parseTime(t.s)+" to "+e.common.parseTime(t.e),l=65,d=t.u.substr(0,l-3)+"...";a+=vbsTemplates.render("utterance/utteranceMarker",{startTime:t.s,rownum:s+1,width:i,position:n,title:d,time:o})}),n+=vbsTemplates.render("utterance/utteranceCheckBox",{rownum:s+1,title:t.name,segmentsCount:t.segments.length})}),e.helper.find(".vbs-utterance-markers").empty().append(a),n){var r=vbsTemplates.render("utterance/utteranceBlock");t("#"+e.settings.controlsBlock).after(t(r)),t(".vbs-utterance-block").addClass(e.data.vclass).find("ul").append(n)}},createViewForV2:function(s){var a="",n="",r={};if(s.forEach(function(e){var t=e.type;r[t]||(r[t]=[]),r[t].push(e)}),Object.keys(r).forEach(function(t,s){r[t].forEach(function(t){var n=e.PlayerApi.getOffset(t.s)/1e3,r=e.PlayerApi.getOffset(t.e)/1e3,i=r-n;a+=vbsTemplates.render("utterance/utteranceMarkerV2",{startTime:t.s/1e3,rownum:s+1,width:i,position:n})}),n+=vbsTemplates.render("utterance/utteranceCheckBox",{rownum:s+1,title:t,segmentsCount:r[t].length})}),e.helper.find(".vbs-utterance-markers").empty().append(a),n){var i=vbsTemplates.render("utterance/utteranceBlock");t("#"+e.settings.controlsBlock).after(t(i)),t(".vbs-utterance-block").addClass(e.data.vclass).find("ul").append(n)}}},events:{init:function(s){e.helper.find(".vbs-utterance-markers").on(s,".vbs-utter-marker",function(s){s.preventDefault();var a=t(this).attr("data-stime");return e.PlayerApi.seek(a),!1}),t(document).off("change",".vbs-utterance-block input[type=checkbox]").on("change",".vbs-utterance-block input[type=checkbox]",function(){var s=t(this).attr("data-row");e.helper.find(".vbs-utterance-markers").find(".vbs-utter-row"+s).toggle()})}}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.validator={validate:function(s){var a=s.find("[data-vbs-validate]"),n=[];return a.each(function(){var s=t(this),a=e.validator.getRules(s),r=a.rules,i=!1;a.ignoreRule&&(i=e.validator.conditions.ignore(s,a.ignoreRule.params[0])),!i&&r&&r.forEach(function(t){var a=e.validator.conditions[t.name](s,t.params);if(!a){var r=e.validator.getMessage(t.name,t.params);n.push({field:s,rule:t.name,message:r})}})}),n.length>0?(e.validator.clearMessages(s),e.validator.showMessages(n),!1):!0},clearMessages:function(e){e.find(".vbs-msg").remove()},showMessages:function(t){t.forEach(function(t){var s=t.field,a=e.validator.createMessage(t.message);s.after(a)})},createMessage:function(e){var t='<div class="vbs-msg vbs-msg-alert">'+e+"</div>";return t},getRules:function(t){var s=t.attr("data-vbs-validate"),a={};if(s){var n=[],r=s.split(",");return r.forEach(function(t){for(var s=t.trim().split(/\[|,|\]/),r=0;r<s.length;r++)s[r]=s[r].replace(" ",""),""===s[r]&&s.splice(r,1);if(s.length>0){var i={};i.name=s[0],s.splice(0,1),i.params=s,e.validator.conditions[i.name]&&("ignore"===i.name?a.ignoreRule=i:n.push(i))}}),a.rules=n,a.rules.length>0?a:null}return null},getValue:function(e){var t;switch(e.prop("type")){case"radio":case"checkbox":t=e.is(":checked");break;default:t=e.val()}return t},getMessage:function(t,s){for(var a=e.validator.messages[t]?e.validator.messages[t]:"",n=0;n<s.length;n++){var r=new RegExp("{{\\s*param"+(n+1)+"\\s*}}","gi");a=a.replace(r,s[n])}return a&&(a="* "+a),a},conditions:{required:function(t){var s=e.validator.getValue(t);return!(null===s||""===s)},minSize:function(t,s){var a=parseInt(s[0]),n=e.validator.getValue(t),r=n.length||0;return r>=a},maxSize:function(t,s){var a=parseInt(s[0]),n=e.validator.getValue(t),r=n.length||0;return a>=r},visible:function(e){return e.is(":visible")},ignore:function(t,s){if("invisible"===s){var a=e.validator.conditions.visible(t);return!a}}},messages:{required:"This field is required",minSize:"{{ param1 }} characters required",maxSize:"{{ param1 }} characters allowed"}},e}(voiceBase,jQuery),function(e,t){"use strict";"object"==typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.vbsTemplates=t()}("object"==typeof window?window:this,function(){"use strict";function e(e,s){var n=a({},r.locals);return t(e)(a(n,s))}function t(e){return n[e]}function s(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;"):""}function a(e,t){t=t||{};for(var s in t)e[s]=t[s];return e}var n={};n["common/disabler"]=n["common/disabler.ejs"]=function(e){var t="";return t+='<div class="vbs-disabler"></div>',t.trim()},n["common/editWrapper"]=n["common/editWrapper.ejs"]=function(e){var t="",a=voiceBase.data.vclass;return t+='\n\n<div id="vbs-edit-wrap"  class="',t+=s(a),t+='">\n\n</div>',t.trim()},n["common/loader"]=n["common/loader.ejs"]=function(e){var t="";return t+='<div class="vbs-loader"></div>',t.trim()},n["common/mainDiv"]=n["common/mainDiv.ejs"]=function(e){var t="";return t+='<div id="vbs-media"></div>\n<div id="vbs-controls"></div>\n\n',voiceBase.settings.tabView?(t+='\n\n<div class="vbs-not-media-sections vbs-tabs-view">\n    <div class="vbs-tabs-links vbs-clearfix">\n\n        ',voiceBase.settings.showKeywordsBlock&&(t+='\n        <a href="javascript:void(0)" data-href=".vbs-keywords-block" class="vbs-active">Keywords</a>\n        '),t+="\n        ",voiceBase.settings.showTranscriptBlock&&(t+='\n        <a href="javascript:void(0)" data-href=".vbs-transcript-block">Transcript</a>\n        '),t+="\n        ",voiceBase.settings.showTranscriptBlock&&(t+='\n        <a href="javascript:void(0)" data-href=".vbs-comments-block">Comments</a>\n        '),t+='\n\n    </div>\n    <div id="vbs-keywords"></div>\n    <div id="vbs-transcript"></div>\n    <div id="vbs-comments"></div>\n\n</div>\n\n'):(t+='\n\n<div id="vbs-keywords"></div>\n\n    ',voiceBase.settings.showNewsBlock&&(t+='\n    <div id="vbs-news"></div>\n    '),t+='\n\n<div id="vbs-transcript"></div>\n<div id="vbs-predictions"></div>\n<div id="vbs-comments"></div>\n\n'),t+="\n\n",t.trim()},n["common/mediaBlock"]=n["common/mediaBlock.ejs"]=function(e){var t=e,s="";return s+='<div class="vbs-media-block">\n    <div class="vbs-section-header">\n        <div class="vbs-section-title">\n            <span class="vbs-section-name vbs-sna">audio</span>\n            <span class="vbs-section-name vbs-snv"></span>\n            <span class="vbs-time">\n                <span class="vbs-ctime">00:00:00</span> / <span class="vbs-ftime">00:00:00</span>\n            </span>\n            <span class="vbs-voice-name"></span>\n        </div>\n        <div class="vbs-section-btns">\n            <ul class="vbs-clearfix">\n\n                ',t.vbsButtons.downloadMedia&&(s+='\n                <li>\n                    <a href="#" class="vbs-download-audio-btn" format="pdf" data-title="Download Recording"></a>\n                </li>\n                '),s+="\n\n                ",t.vbsButtons.remove&&(s+='\n                <li>\n                    <a href="#" class="vbs-del-btn" data-title="Delete Recording"></a>\n                    <div class="vbs-download-popup vbs-delete-popup vbs-popup">\n                        <div class="vbs-arrow"></div>\n                        <h3>Are you sure you want to delete this recording?</h3>\n                        <a href="#" class="vbs-red-btn">Delete</a>\n                        <a href="#" class="vbs-blue-btn">Cancel</a>\n                    </div>\n                </li>\n                '),s+="\n\n                ",t.vbsButtons.favorite&&(s+='\n                <li>\n                    <a href="#" class="vbs-star-btn"></a>\n                </li>\n                '),s+="\n\n                ",t.vbsButtons.help&&(s+='\n                <li>\n                    <a href="#" class="vbs-help-btn" data-title="Help"></a>\n                </li>\n                '),s+='\n\n            </ul>\n        </div>\n        <div class="clear-block"></div>\n    </div>\n    <div class="vbs-section-body"></div>\n</div>',s.trim()},n["common/print"]=n["common/print.ejs"]=function(e){var t=e,s="";return s+="<html>\n<head>\n    <title></title>\n</head>\n<body>\n    ",s=[s,t.transcriptText].join(""),s+="\n</body>\n</html>",s.trim()},n["common/readerWrapper"]=n["common/readerWrapper.ejs"]=function(e){var t="",a=voiceBase.settings.localYoutubeApp?" vbs-local-app":"";return t+="\n",a=voiceBase.data.vclass+a,t+='\n<div id="vbs-reader-wrap" class="',t+=s(a),t+='">\n\n</div>',t.trim()},n["comments/commentDeletePopup"]=n["comments/commentDeletePopup.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-comments-popup vbs-popup vbs-comment-delete-popup">\n    <div class="vbs-arrow"></div>\n    <span>Delete This Comment?</span>\n    <div class="vbs-comment-footer">\n        <a href="#" class="vbs-cancel-btn" c_id="',a+=s(t.c_id),a+='">Yes, Delete</a>\n        <a href="#" class="vbs-confirm-btn">No, Cancel</a>\n    </div>\n</div>',a.trim()},n["comments/commentEditPopup"]=n["comments/commentEditPopup.ejs"]=function(e){var t=e,a="",n=Math.round(t.time);a+="\n";var r=t.parseTime(n);return a+='\n\n<div class="vbs-comments-popup vbs-popup ',t.isFirstComment||(a+=" vbs-edit-wr "),a+='">\n    <div class="vbs-arrow"></div>\n    ',t.isFirstComment&&(a+='\n    <div class="vbs-comment-popup-row vbs-clearfix">\n        <label>\n            Comment position:\n            <span class="vbs-time" id="vbs-comment-timeline" vbct="',a+=s(n),a+='">\n                ',a+=s(r),a+='\n            </span>\n            <br>\n            <span class="vbs-explanation">Drag the timeline to change</span>\n        </label>\n        <a href="#" class="vbs-play-btn"></a>\n    </div>\n    '),a+='\n    <div class="vbs-enter-comment-row">\n        <textarea id="vbs-comment-text" placeholder="Enter your comment...">',a+=s(t.commentText),a+='</textarea>\n    </div>\n    <div class="vbs-comment-footer">\n        <a href="#" class="vbs-cancel-btn">Cancel</a>\n        <a href="#" class="vbs-confirm-btn" c_id="',a+=s(t.c_id),a+='">Save Changes</a>\n    </div>\n</div>',a.trim()},n["comments/commentOnTimeline"]=n["comments/commentOnTimeline.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-comments-wrapper ',a+=s(t.rightClass),a+='" style="left:',a+=s(t.left),a+='px;" stime="',a+=s(t.stime),a+='">\n    <div class="vbs-comment-small"></div>\n    <div class="vbs-comment-preview">\n        <a href="#" stime="',a+=s(t.stime),a+='">\n            ',a+=s(t.commentText),a+="\n        </a>\n    </div>\n</div>\n",a.trim()},n["comments/commentPopup"]=n["comments/commentPopup.ejs"]=function(e){var t=e,a="",n=Math.round(t.time);a+="\n";var r=t.parseTime(n);return a+='\n\n<div class="vbs-comments-popup vbs-comments-add-popup vbs-popup">\n    <div class="vbs-arrow"></div>\n    <div class="vbs-comment-popup-row vbs-clearfix">\n        <label>\n            Comment position:\n            <span class="vbs-time" id="vbs-comment-timeline" vbct="',a+=s(n),a+='">\n                ',a+=s(r),a+='\n            </span>\n            <br>\n            <span class="vbs-explanation">Drag the timeline to change</span>\n        </label>\n        <a href="#" class="vbs-play-btn"></a>\n    </div>\n    <div class="vbs-enter-comment-row">\n        <textarea id="vbs-comment-text" placeholder="Enter your comment..."></textarea>\n    </div>\n    <div class="vbs-comment-footer">\n        <a href="#" class="vbs-cancel-btn">Cancel</a>\n        <a href="#" class="vbs-confirm-btn">Add comment</a>\n    </div>\n</div>\n',a.trim()},n["comments/commentReplyPopup"]=n["comments/commentReplyPopup.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-comments-popup vbs-popup">\n    <div class="vbs-arrow"></div>\n    <div class="vbs-enter-comment-row">\n        <textarea id="vbs-comment-reply-text" placeholder="Enter your comment..."></textarea>\n    </div>\n    <div class="vbs-comment-footer">\n        <a href="#" class="vbs-cancel-btn">Cancel</a>\n        <a href="#" c_id="',a+=s(t.c_id),a+='" class="vbs-confirm-btn">Add comment</a>\n    </div>\n</div>\n',a.trim()},n["comments/commentThreads"]=n["comments/commentThreads.ejs"]=function(e){var t=e,a="";return t.countComments>0?(a+="\n\n",t.threads.forEach(function(e){a+="\n    ",e.comments.forEach(function(n){a+="\n        ";var r=n.level>"5"?"5":n.level;a+="\n        ";var i=n.canEdit?"vbs-with-edition-btns":"";if(a+='\n\n        <div class="vbs-comment-row vbs-answer',a+=s(r),a+='">\n            <div class="vbs-comment-title">\n                <span class="vbs-comment-author">',a+=s(n.userName),a+="</span>\n                ",1==r){a+='\n                <span>commented at</span>\n                <a href="javascript:void(0)" class="vbs-comment-time" data-vbct="',a+=s(e.timeStamp),a+='">\n                    ';var o=t.parseTime(e.timeStamp);a+="\n                    ",a+=s(o),a+="\n                </a>\n                "}else a+="\n                <span>replied</span>\n                ";a+='\n            </div>\n            <div class="vbs-comment-content ',a+=s(i),a+='">\n                <div class="vbs-arrow"></div>\n                <div class="vbs-comment-message">\n                    <p>',a+=s(n.content),a+="</p>\n                </div>\n                ",t.showCommentsBtn&&(a+="\n                    ",n.canEdit?(a+='\n                    <div class="vbs-comment-edit-wrapper">\n                        <div class="vbs-comment-edit-btn-wrapper">\n                            <a href="#" c_id="',a+=s(n.id),a+='" c_tm="',a+=s(e.timeStamp),a+='" class="vbs-comment-edit vbs-popup-btn">\n                                Edit\n                            </a>\n                        </div>\n                        <div class="vbs-comment-delete-btn-wrapper">\n                            <a href="#" c_id="',a+=s(n.id),a+='" class="vbs-comment-delete vbs-popup-btn">Delete</a>\n                        </div>\n                    </div>\n                    '):(a+='\n                    <div class="vbs-comment-reply-wrapper">\n                        <a href="#"  c_id="',a+=s(n.id),a+='" class="vbs-comment-reply vbs-popup-btn">Reply</a>\n                    </div>\n                    '),a+="\n                "),a+="\n            </div>\n        </div>\n\n        ",t.countComments++,a+="\n    "}),a+="\n"}),a+="\n\n"):a+='\n\n<div class="vbs-comment-row">\n    <div class="vbs-comment-title">No Comments</div>\n</div>\n\n',a.trim()},n["comments/commentsTimeline"]=n["comments/commentsTimeline.ejs"]=function(t){var s=t,a="",n=function(t,s){return e(t,s)};return s.threads.forEach(function(e){a+="\n";var t=s.getOffset(e.timeStamp);a+="\n";var r=e.timeStamp>s.duration/2?"vbs-from-right":"";a+="\n\n",a=[a,n("comments/commentOnTimeline",{rightClass:r,left:t,stime:e.timeStamp,commentText:e.comments[0].content})].join(""),a+="\n\n"}),a.trim()},n["comments/commentsWrapper"]=n["comments/commentsWrapper.ejs"]=function(e){var t=e,a="",n=t.tabView?"vbs-tab":"";return a+='\n<div class="vbs-comments-block ',a+=s(n),a+='">\n    <div class="vbs-section-header">\n        <div class="vbs-section-title" data-title="Show Comments">\n            <span class="vbs-section-name"></span>\n        </div>\n        ',t.showAddBtn&&(a+='\n        <div class="vbs-section-btns">\n            <ul class="vbs-clearfix">\n                <li>\n                    ',a+=t.tabView?'\n                    <a href="#" class="vbs-comments-btn vbs-popup-btn" data-title="Add a Comment">\n                        <div class="vbs-comments-btn-icon"></div>\n                        <span>Add New Comment</span>\n                    </a>\n                    ':'\n                    <a href="#" class="vbs-comments-btn vbs-popup-btn" data-title="Add a Comment"></a>\n                    ',a+="\n                </li>\n            </ul>\n        </div>\n        "),a+='\n    </div>\n    <div class="vbs-section-body"></div>\n</div>',a.trim()
},n["comments/kalturaInlineComment"]=n["comments/kalturaInlineComment.ejs"]=function(e){var t=e,a="",n=t.stime>t.duration/2?"vbs-from-right":"";return a+='\n\n<div class="vbs-comments-wrapper ',a+=s(n),a+='"\n     style="left:',a+=s(t.left+"%"),a+='; top: -15px;"\n     stime="',a+=s(t.stime),a+='">\n\n    <div class="vbs-comment-small"></div>\n    <div class="vbs-comment-preview" style="z-index: 99999999991; ',t.rightClass||(a+=" padding-left: 10px; "),a+='">\n        <a href="#" stime="',a+=s(t.stime),a+='">\n            ',a+=s(t.commentText),a+="\n        </a>\n    </div>\n\n</div>\n",a.trim()},n["comments/kalturaWrapperComments"]=n["comments/kalturaWrapperComments.ejs"]=function(e){var t="";return t+='<div class="vbs-comments-wrapper-block"></div>',t.trim()},n["controls/controlsBlock"]=n["controls/controlsBlock.ejs"]=function(e){var t=e,a="",n=t.vbsButtons.prev&&t.vbsButtons.next?" vbs-3-left-btns":t.vbsButtons.prev||t.vbsButtons.next?" vbs-2-left-btns":" vbs-1-left-btns";return a+='\n\n<div class="vbs-record-player ',a+=s(n),a+='">\n    <div class="vbs-player-control">\n        <a href="#" class="vbs-play-btn" data-title="Play"></a>\n\n        ',t.vbsButtons.prev&&(a+='\n        <a href="javascript:void(0)" class="vbs-prev-btn" data-title="Back 15 Seconds"></a>\n        '),a+="\n\n        ",t.vbsButtons.next&&(a+='\n        <a href="javascript:void(0)" class="vbs-next-action-btn vbs-next-notactive" data-title="Next Keyword Marker"></a>\n        '),a+='\n    </div>\n    <div class="vbs-time-name-wrapper-narrow">\n        <span class="vbs-time"><span class="vbs-ctime">00:00:00</span> / <span class="vbs-ftime">00:00:00</span></span> <br>\n        <span class="vbs-voice-name"></span>\n    </div>\n    <div class="vbs-timeline">\n        <div class="vbs-record-preview">\n            <div class="vbs-record-timeline-wrap">\n                <div class="">\n                    <div class="vbs-dragger"></div>\n                    <div class="vbs-record-timeline"></div>\n                    <div class="vbs-record-progress"></div>\n                    <div class="vbs-speakers"></div>\n                    <div class="vbs-player-slider"></div>\n                    <div class="vbs-record_buffer"></div>\n                    <div class="vbs-utterance-markers"></div>\n                </div>\n                <!--markers-->\n                <div class="vbs-markers"></div>\n                <div class="vbs-custom-markers"></div>\n                <!-- / markers-->\n                <div class="vbs-markers-hovers"></div>\n                <div class="vbs-comments-wrapper-block"></div>\n                <div class="vbs-record-disabler" style="width: 0;"></div>\n            </div>\n        </div>\n    </div>\n    ',t.vbsButtons.share&&(a+='\n    <div class="vbs-share-btn-wrapper">\n        <a href="#" class="vbs-share-btn vbs-popup-btn" data-title="Share"></a>\n    </div>\n    '),a+="\n\n    ",t.is_iDevice()||(a+='\n    <div class="vbs-volume-toolbar">\n        <a href="#" class="vbs-volume-btn" data-title="Volume"></a>\n        <div class="vbs-volume-toolbar-block" style="display: none;">\n            <div class="vbs-volume-slider">\n                <div class="vbs-volume-slider-bg"></div>\n                <div class="vbs-volume-slider-full"></div>\n                <div class="vbs-volume-slider-handler"></div>\n            </div>\n        </div>\n    </div>\n    '),a+="\n\n</div>\n",a.trim()},n["controls/controlsContainer"]=n["controls/controlsContainer.ejs"]=function(e){var t="";return t+='<div class="vbs-after-controls-wrapper">\n    <div class="vbs-player-control"></div>\n    <div class="vbs-share-control"></div>\n</div>',t.trim()},n["controls/controlsPlacement"]=n["controls/controlsPlacement.ejs"]=function(e){var t="";return t+='<div id="vbs-controls-placement"><div class="vbs-controls-wrapper"></div></div>\n',t.trim()},n["controls/controlsWrapper"]=n["controls/controlsWrapper.ejs"]=function(e){var t="";return t+='<div class="vbs-controls-wrapper"></div>',t.trim()},n["controls/readerExitBtn"]=n["controls/readerExitBtn.ejs"]=function(e){var t="";return t+='<a href="javascript:void(0)" class="vbs-reader-exit">\n    Exit\n</a>',t.trim()},n["keywords/customMarkers"]=n["keywords/customMarkers.ejs"]=function(e){var t=e,a="";for(var n in t.markers){a+="\n";var r=t.getPosition(n);a+="\n";var i=t.unEscapeHtml(t.markers[n]);a+='\n\n<a href="#" class="vbs-marker vbs-custom-marker"\n   style="z-index:91; left:',a+=s(r),a+='px;"\n   stime="',a+=s(n),a+='">\n    <ins></ins>\n</a>\n<span ctime="',a+=s(n),a+='" class="vbs-comment">',a=[a,i].join(""),a+="</span>\n\n"}return a+="\n",a.trim()},n["keywords/deleteTopicPopup"]=n["keywords/deleteTopicPopup.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-comments-popup vbs-popup vbs-topic-delete-popup"\n        data-topic="',a+=s(t.topicName),a+='"\n        style="left: ',a+=s(t.left),a+="px; top: ",a+=s(t.top),a+='px;">\n\n    <div class="vbs-arrow"></div>\n    <span>Delete Topic?</span>\n    <div class="vbs-comment-footer">\n        <a href="#" class="vbs-cancel-btn">Yes</a>\n        <a href="#" class="vbs-confirm-btn">No</a>\n    </div>\n\n</div>',a.trim()},n["keywords/emptyMessage"]=n["keywords/emptyMessage.ejs"]=function(e){var t="";return t+='<div class="vbs-keyword-message">\n    <div class="vbs-message vbs-message-error">\n        <p>None of the specified keywords or phrases were spotted for this media file</p>\n    </div>\n</div>',t.trim()},n["keywords/keywordItem"]=n["keywords/keywordItem.ejs"]=function(e){var t=e,a="";return a+='<li class="',a+=s(t.times.length>0?"key":""),a+='">\n   <a href="#" t="',a+=s(t.times.join()),a+='" speakers="',a+=s(t.spkeys),a+='" ',a+=s(t.sptimes),a+=">\n        ",a+=s(t.name),a+="\n   </a>\n    ",t.keywordsCounter&&(a+="\n    <span>(",a+=s(t.times.length),a+=")</span>\n    "),a+="\n</li>",a.trim()},n["keywords/keywordsBlock"]=n["keywords/keywordsBlock.ejs"]=function(e){var t=e,a="",n=t.tabView?"vbs-tab":"";a+="\n";var r=t.vbsButtons.evernote&&"undefined"!=typeof filepicker;return a+='\n\n<div class="vbs-keywords-block ',a+=s(n),a+='">\n    <div class="vbs-section-header">\n        <div class="vbs-section-title" data-title="Hide Keywords">\n            <span class="vbs-section-name">Keywords</span>\n        </div>\n        \n        <div class="vbs-search-form vbs-no-speaker ',a+=r?" vbs-one-btn ":" vbs-no-btns ",a+='">\n            ',t.searchBarOuter||(a+='\n            <form action="#" id="vbs-search-form">\n                <div class="vbs-widget-wrap">\n                    <div class="vbs-widget">\n                        <input name="get_voice_search" value="" size="20" id="vbs-voice_search_txt" class="vbs-formfields" type="text" placeholder="Search Keywords..." autocomplete=off>\n                        <div id="vbs-search-string">\n                            <div class="vbs-marquee">\n                                <div class="vbs-search-word-widget"></div>\n                            </div>\n                        </div>\n                        ',t.vbsButtons.pwrdb&&(a+='\n                        <span class="vbs-powered-by-label">Powered by VoiceBase</span>\n                        '),a+='\n                    </div>\n                    <a href="#" id="vbs-clear-string" title="Clear String"></a>\n                </div>\n                ',t.vbsButtons.unquotes&&(a+='\n                <a href="javascript:void(0)" class="vbs-unquote-btn">Unquoted</a>\n                '),a+='\n\n                <div class="vbs-search-btn" data-title="Search">\n                    <button type="submit"></button>\n                </div>\n            </form>\n            '),a+='\n\n            <div class="vbs-select-speaker-wrapper">\n                <div class="vbs-select-speaker">Select speaker...</div>\n                <ul class="vbs-speaker-dropdown vbs-select-dropdown"></ul>\n            </div>\n        </div>\n\n        ',r&&(a+='\n        <div class="vbs-section-btns">\n            <ul>\n                <li>\n                    <a href="#" class="vbs-evernote-btn" data-title="Send to Evernote"></a>\n                </li>\n            </ul>\n        </div>\n        '),a+='\n\n        <div class="clear-block"></div>\n    </div>\n    <!-- / section header-->\n    \n    <div class="vbs-section-body">\n        <div class="vbs-keywords-wrapper vbs-scroll" style="height: ',a+=s(voiceBase.settings.keywordsHeight),a+='px;">\n            <div class="vbs-topics"></div>\n            <div class="vbs-keywords-list-wrapper">\n                <div class="vbs-keywords-list-tab"></div>\n            </div>\n            <div class="clear-block"></div>\n        </div>\n\n        ',voiceBase.settings.showMore&&(a+='\n        <div class="vbs-more-btn"><a href="#">Show More...</a></div>\n        '),a+="\n    </div>\n</div>\n",a.trim()},n["keywords/keywordsUl"]=n["keywords/keywordsUl.ejs"]=function(e){var t=e,a="";return a+='<ul tid="',a+=s(t.categoryName),a+='" class="',a+=s(t.categoryClass),a+='">\n\n</ul>',a.trim()},n["keywords/markers"]=n["keywords/markers.ejs"]=function(e){var t=e,a="";return t.times.forEach(function(e,n){a+="\n";var r=t.getPosition(parseFloat(e));a+="\n";var i=t.phrases&&t.phrases[n]?t.unEscapeHtml(t.phrases[n]):"";a+='\n\n<a href="#" class="vbs-marker"\n        style="border-bottom-color:',a+=s(t.color),a+="; z-index:91; left:",a+=s(r),a+='px;"\n        stime="',a+=s(e),a+='">\n    <ins></ins>\n</a>\n<span ctime="',a+=s(e),a+='" class="vbs-comment">',a=[a,i].join(""),a+="</span>\n\n"}),a+="\n",a.trim()},n["keywords/markersHover"]=n["keywords/markersHover.ejs"]=function(e){var t=e,a="";return t.times.forEach(function(e){a+="\n";var n=t.getPosition(parseFloat(e));a+='\n\n<a href="#" class="vbs-marker key" style="z-index:91; left:',a+=s(n),a+='px;" stime="',a+=s(e),a+='">\n    <ins></ins>\n</a>\n\n'}),a+="\n",a.trim()},n["keywords/plus"]=n["keywords/plus.ejs"]=function(e){var t="";return t+='<a href="#add" class="vbs-add-search-word" title="Add to all topics"></a>',t.trim()},n["keywords/searchWordWidget"]=n["keywords/searchWordWidget.ejs"]=function(e){var t=e,a="";return t.words.forEach(function(e,n){a+="\n";var r=n>7?t.generateRandomColor():t.colors[n];a+="\n";var i=e.replace(/"/g,"");a+='\n\n<span class="vbs-word">\n        <em>\n            <dfn style="border-bottom-color: ',a+=s(r),a+=';" class="vbs-marker">\n                <ins></ins>\n            </dfn>\n            ',a+=s(i),a+='\n            <span class="vbs-search_word" style="display:none">',a+=s(e),a+="</span>\n        </em>\n</span>\n\n"}),a.trim()},n["keywords/topicList"]=n["keywords/topicList.ejs"]=function(e){var t=e,a="";return a+='<ul class="vbs-topics-list">\n    ',t.categories.forEach(function(e){a+="\n    ";var n=t.getCategoryClassString(e,"group","vbs-all-topics");a+='\n\n    <li class="',a+=s(n),a+='">\n        <a href="javascript:void(0);" speakers="',a+=s(e.speakers),a+='">',a+=s(e.name),a+='</a>\n        <div class="vbs-topic-del-btn-wrap"><i class="vbs-cross-btn vbs-popup-btn"></i></div>\n    </li>\n\n    '}),a+="\n</ul>",a.trim()},n["menu/editMenu"]=n["menu/editMenu.ejs"]=function(e){var t=e,a="",n=t.stime>1?t.stime-1:t.stime;return a+='\n<ul class=\'vbs-vbcmenu\'>\n    <li>\n        <a href="#" class="vbsc-edit-play" data-time="',a+=s(n),a+='">\n            Play\n        </a>\n    </li>\n\n    ',t.isInsertSpeaker&&(a+='\n    <li>\n        <a href="#" class="vbsc-edit-speaker" data-time="',a+=s(1e3*t.stime),a+='">\n            Insert Speaker\n        </a>\n    </li>\n    '),a+="\n\n    ",t.isRenameSpeaker&&(a+='\n    <li>\n        <a href="#" class="vbsc-rename-speaker" data-speaker-key="',a+=s(t.speakerKey),a+='">\n            Rename Speaker\n        </a>\n    </li>\n    '),a+="\n\n\n</ul>",a.trim()},n["menu/menu"]=n["menu/menu.ejs"]=function(e){var t=e,a="";return a+="<ul class='vbs-vbcmenu'>\n\n    ",t.hasCopyLib&&t.hasContextMenu&&(a+='\n    <li id="vbc_url"><a href="#">Copy URL</a></li>\n    '),a+="\n\n    ",t.hasShareLib&&t.hasContextMenu&&(a+='\n    <li id="vbc_share">\n        <a class="addthis_button_expanded addthis_default_style" addthis:url="',a+=s(t.url),a+='" addthis:title="Check out">\n            Share\n        </a>\n    </li>\n    '),a+="\n\n    ",t.canKeywordMenu&&(a+='\n    <li id="vbc_move">\n        <span class="vbs-keyword_controls">\n            ',t.hasPrevKeyword&&(a+='\n            <span class="vbs-vbe vbs-voicebase_first" title="Move to Top">Move to Top</span>\n            <span class="vbs-vbe vbs-voicebase_up" title="Move up">Move up</span>\n            '),a+="\n\n            ",t.hasNextKeyword&&(a+='\n            <span class="vbs-vbe vbs-voicebase_down" title="Move down">Move down</span>\n            '),a+='\n            <span class="vbs-vbe vbs-voicebase_remove" title="Remove">Remove</span>\n        </span>\n    </li>\n    '),a+="\n\n</ul>",a.trim()},n["messages/abstractAlertPopup"]=n["messages/abstractAlertPopup.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-white-popup-overlay">\n    <div class="vbs-big-error-popup">\n        <h2>',a+=s(t.errorTitle),a+="</h2>\n\n        <p>",a+=s(t.errorText),a+="</p>\n    </div>\n</div>",a.trim()},n["messages/abstractErrorPopup"]=n["messages/abstractErrorPopup.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-white-popup-overlay">\n    <div class="vbs-big-error-popup">\n        <a href="javascript:void(0)" class="overlay_dismiss">&times;</a>\n\n        <h2>',a+=s(t.errorTitle),a+="</h2>\n\n        <p>",a+=s(t.errorText),a+='</p>\n        <a href="javascript:location.reload();" class="vbs-reload-btn"></a>\n        <a href="http://www.voicebase.com/contact-us/" target="_blank" class="vbs-contact-support-btn"></a>\n    </div>\n</div>\';\n',a.trim()},n["messages/endSearchMessage"]=n["messages/endSearchMessage.ejs"]=function(e){var t="";return t+='<div class="vbs-message vbs-message-info">\n    <p>Your search is taking a long time...</p>\n\n    <p>Please wait or click to\n        <a href="javascript:void(0)" class="vbs-cancel-search">Cancel</a>\n    </p>\n</div>\n',t.trim()},n["messages/errorPopup"]=n["messages/errorPopup.ejs"]=function(e){var t="";return t+='<div class="vbs-white-popup-overlay">\n    <div class="vbs-big-error-popup">\n        <a href="javascript:void(0)" class="overlay_dismiss">&times;</a>\n\n        <h2>Could not load recording data</h2>\n\n        <p>Indexing file may not be complete. If reloading does not solve the problem, please contact support for\n            assistance.</p>\n        <a href="javascript:location.reload();" class="vbs-reload-btn"></a>\n        <a href="http://www.voicebase.com/contact-us/" target="_blank" class="vbs-contact-support-btn"></a>\n    </div>\n</div>',t.trim()},n["messages/infoMessage"]=n["messages/infoMessage.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-message vbs-message-',a+=s(t.mode),a+='">\n    <p>',a+=s(t.errorText),a+="</p>\n</div>",a.trim()},n["messages/loggerBlock"]=n["messages/loggerBlock.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-logger">\n    <textarea>\n        ',a+=s(t.response),a+="\n    </textarea>\n</div>",a.trim()},n["messages/reloadOverlayCredentials"]=n["messages/reloadOverlayCredentials.ejs"]=function(e){var t="";return t+='<div class="vbs-reload-overlay">\n    <div class="vbs-reload-message-wrapper vbs-large-error-text vbs-clearfix">\n        <div class="vbs-reload-message">\n            <a href="javascript:void(0)" class="overlay_dismiss">&times;</a>\n            <span>Could not load recording data, indexing file may not be complete. If reload does not solve problem contact support for assistance</span>\n        </div>\n        <a href="javascript:location.reload();" class="vbs-reload-btn"></a>\n    </div>\n</div>',t.trim()},n["messages/savingMessage"]=n["messages/savingMessage.ejs"]=function(e){var t="";return t+='<div class="vbs-saving">\n    <div class="vbs-saving-inner">\n        <div class="vbs-saving-loader"></div>\n        <div class="vbs-saving-message">Saving & Re-syncing...</div>\n    </div>\n</div>\n',t.trim()},n["messages/successSavingMessage"]=n["messages/successSavingMessage.ejs"]=function(e){var t="";return t+='<div class="vbs-success-saving">\n    <div class="vbs-saving-inner">\n        <div class="vbs-saving-loader"></div>\n        <div class="vbs-saving-message">Transcript Saved</div>\n    </div>\n</div>',t.trim()},n["messages/textErrorMessage"]=n["messages/textErrorMessage.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-text-error-message">\n    <p>',a+=s(t.errorText),a+="</p>\n</div>\n",a.trim()},n["news/emptyNewsMessage"]=n["news/emptyNewsMessage.ejs"]=function(e){var t=e,a="";return a+='<div class="empty_news_message">\n    ',"not_found"===t.mode?(a+="\n        ",a+=s("News are not founded"),a+="\n    "):"empty"===t.mode&&(a+="\n        ",a+=s("Please select a keyword"),a+="\n    "),a+="\n</div>",a.trim()},n["news/newsBlock"]=n["news/newsBlock.ejs"]=function(e){var t=e,a="",n=t.tabView?"vbs-tab":"";return a+='\n\n<div class="vbs-news-block ',a+=s(n),a+='">\n    <div class="vbs-section-header">\n        <div class="vbs-section-title" data-title="Show News">\n            <span class="vbs-section-name">\n                <span>News stories</span>\n                <span class="vbs-news-words-wrapper">\n                    <span class="vbs-small-text"> related to </span>\n                    <span class="vbs-news-words"></span>\n                </span>\n            </span>\n        </div>\n    </div>\n    <!--wrapper for news content-->\n    <div class="vbs-section-body">\n        <div class="vbs-news-wrapper vbs-scroll"></div>\n    </div>\n</div>',a.trim()},n["news/newsContent"]=n["news/newsContent.ejs"]=function(e){var t=e,a="";return t.allNews.forEach(function(e,t){a+="\n";var n=(t+1)%2===0;a+='\n<a href="',a+=s(e.Url),a+='" target="_blank" class="vbs-news-elem ',n&&(a+=" vbs-news-elem-odd "),a+='">\n    <div class="vbs-news-elem-title">',a+=s(e.Title||""),a+='</div>\n    <div class="vbs-news-elem-body">\n        <span class="vbs-news-elem-source">',a+=s(e.Source||""),a+='</span>\n        <span>&nbsp;-&nbsp;</span>\n        <span class="vbs-news-elem-time">',a+=s(e.Date),a+="</span>\n    </div>\n</a>\n",n&&(a+='\n<div class="clear-block"></div>\n'),a+="\n\n"}),a.trim()},n["players/expandBtn"]=n["players/expandBtn.ejs"]=function(e){var t="";return t+='<li>\n    <a href="#" class="vbs-expand-btn" data-title="Expand Video"></a>\n</li>',t.trim()},n["players/fullscreenExitBtn"]=n["players/fullscreenExitBtn.ejs"]=function(e){var t="";return t+='<a href="#" class="vbs-fullscreen-exit">Exit</a>',t.trim()},n["players/playerWrapper"]=n["players/playerWrapper.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-player-wrapper vbs-',a+=s(t.randId),a+='">\n\n</div>',a.trim()},n["players/playlist"]=n["players/playlist.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-playlist collapsed">\n    <div class="vbs-selected-playlist-item">\n        <div class="vbs-item-name"></div>\n        <i></i>\n    </div>\n    <div class="vbs-clearfix"></div>\n    <ul class="vbs-playlist-dropdown">\n\n        ',t.playlist.forEach(function(e,t){a+='\n        <li class="vbs-playlist-item" data-playlist-item-index="',a=[a,t].join(""),a+='">\n            <span class="vbs-playlist-item-title">',a+=s(e.title),a+="</span>\n        </li>\n        "}),a+="\n\n    </ul>\n</div>\n",a.trim()},n["players/timeInPlayer"]=n["players/timeInPlayer.ejs"]=function(e){var t=e,s="";return s+='<span class="vbs-time vbs-time-in-player">\n    <span class="vbs-ctime">00:00:00</span> /\n    <span class="vbs-ftime">',s=[s,t.time].join(""),s+="</span>\n</span>",s.trim()},n["search/searchBarOuter"]=n["search/searchBarOuter.ejs"]=function(e){var t="";return t+='<div id="vbs-searchbar-block">\n    <div class="vbs-search-form vbs-no-speaker">\n        <form action="#" id="vbs-search-form">\n            <div class="vbs-widget-wrap">\n                <div class="vbs-widget">\n                    <input name="get_voice_search" value="" size="20" id="vbs-voice_search_txt" class="vbs-formfields" type="text" placeholder="Search Keywords..." autocomplete=off>\n                    <div id="vbs-search-string">\n                        <div class="vbs-marquee">\n                            <div class="vbs-search-word-widget"></div>\n                            </div>\n                        </div>\n                    ',voiceBase.settings.vbsButtons.pwrdb&&(t+='\n                    <span class="vbs-powered-by-label">Powered by VoiceBase</span>\n                    '),t+='\n                </div>\n                <a href="#" id="vbs-clear-string" title="Clear String"></a>\n            </div>\n\n            ',voiceBase.settings.vbsButtons.unquotes&&(t+='\n            <a href="javascript:void(0)" class="vbs-unquote-btn">Unquoted</a>\n            '),t+='\n\n            <div class="vbs-search-btn" data-title="Search">\n               <button type="submit"></button>\n            </div>\n        </form>\n    </div>\n</div>\n',t.trim()},n["search/searchWrapper"]=n["search/searchWrapper.ejs"]=function(e){var t="";return t+='<div id="vbs-searchbar-block" class="vbs-controls-after-searchbar vbs-searchbar-outer">\n\n</div>',t.trim()},n["predictions/predictions"]=n["predictions/predictions.ejs"]=function(e){var t="",a=voiceBase.settings.tabView?"vbs-tab":"";return t+='\n\n<div class="vbs-predictions-block ',t+=s(a),t+='">\n    <div class="vbs-section-header">\n        <div class="vbs-section-title" data-title="Show Predictions">\n            <span class="vbs-section-name">\n                <span>Predictions</span>\n            </span>\n        </div>\n    </div>\n    <div class="vbs-section-body">\n        <div class="vbs-predictions-wrapper vbs-scroll">\n        </div>\n    </div>\n</div>',t.trim()},n["predictions/predictionsData"]=n["predictions/predictionsData.ejs"]=function(e){var t=e,s="";return s+='<table class="vbs-predictions-table">\n    <thead>\n    <tr>\n        <th>Model Id</th>\n        <th>Type</th>\n        <th>Class</th>\n    </tr>\n    </thead>\n    <tbody>\n    ',t.predictions.forEach(function(){s+="\n    <tr>\n        <td> prediction.model + '</td>\n        <td> prediction.type + '</td>\n        <td> prediction.class + '</td>\n    </tr>\n    "}),s+="\n    </tbody>\n</table>",s.trim()},n["share/addthisBox"]=n["share/addthisBox.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-share-social-row vbs-clearfix">\n    <span>Choose one:</span>\n    <div class="vbs-social-wrapper">\n        <div class="vbs-addthis-toolbox addthis_toolbox addthis_default_style">\n            ',t.buttons.forEach(function(e){a+='\n            <a class="addthis_button_',a+=s(e),a+='"></a>\n            '}),a+='\n            <a class="addthis_counter addthis_bubble_style"></a>\n        </div>\n    </div>\n</div>',a.trim()},n["share/sharePopup"]=n["share/sharePopup.ejs"]=function(t){var a=t,n="",r=function(t,s){return e(t,s)};return n+='<div class="vbs-share-popup vbs-popup" style="display: block;">\n    <div class="vbs-arrow"></div>\n\n    <div class="vbs-share-radio-row vbs-clearfix vbs-checked">\n        <input type="radio" name="share-opt" value="share-position" id="vbs-share-position" checked="checked">\n        <label for="vbs-share-position">\n            Share position\n            <span class="vbsp-time" vbct="',n+=s(a.vbt),n+='">\n                ',n+=s(a.vbspTime),n+='\n            </span>\n            <br>\n            <span class="vbs-explanation">\n                Drag the timeline to change\n            </span>\n        </label>\n        <a href="#" class="vbs-play-btn"></a>\n    </div>\n\n    <div class="vbs-share-radio-row vbs-clearfix">\n        <input type="radio" name="share-opt" value="share-search" id="vbs-share-search">\n        <label for="vbs-share-search">\n            Share search <br>\n            <span class="vbs-explanation">\n                The current search or keyword  selected\n            </span>\n        </label>\n    </div>\n\n    <div class="vbs-share-radio-row vbs-clearfix">\n        <input type="radio" name="share-opt" value="share-file" id="vbs-share-file">\n        <label for="vbs-share-file">Share file from start</label>\n    </div>\n\n    <div class="vbs-link-row vbs-clearfix ',n+=s(a.zclip),n+='">\n        <input type="text" id="vbsp-url" class="vbsp-url" value="',n+=s(a.url),n+='">\n        <a href="#" class="vbs-copy-btn">Copy</a>\n    </div>\n\n    ',"undefined"!=typeof addthis&&(n+="\n        ",n=[n,r("share/addthisBox",{buttons:a.buttons})].join(""),n+="\n    "),n+='\n\n    <div class="vbs-share-footer">\n        ',a.isShare&&(n+='\n        <span>or</span>\n        <a href="#" class="vbs-voicebase-share-btn">Share with E-mail</a>\n        '),n+='\n\n        <a href="#" class="vbs-cancel-btn">Cancel</a>\n    </div>\n</div>',n.trim()},n["speakers/insertSpeakerPopup"]=n["speakers/insertSpeakerPopup.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-insert-speaker-popup vbs-common-popup" style="top: ',a+=s(t.top),a+="px; left: ",a+=s(t.left),a+='px;">\n    <div class="vbs-arrow"></div>\n    <div class="vbs-common-popup-header vbs-clearfix">\n        <div class="rename_speaker_label">Insert speaker</div>\n    </div>\n    <div class="vbs-common-popup-body">\n        <div class="vbs-select-wrapper vbs-select-insert-speaker-wrapper">\n            <div class="vbs-select-title vbs-select-insert-speaker vbs-new-speaker">\n                <div class="vbs-speaker-selected">Insert new speaker</div>\n            </div>\n            <ul class="vbs-speaker-dropdown vbs-select-dropdown">\n                <li class="vbs-insert-new-speaker">Insert new speaker</li>\n\n                ',t.speakersKeys.forEach(function(e){a+="\n                ";var n=t.getSpeakerNameByKey(e);a+='\n                    <li data-speaker-key="',a+=s(e),a+='">',a+=s(n),a+="</li>\n                "}),a+='\n\n            </ul>\n        </div>\n        <div class="vbs-speaker-input-wrapper">\n            <input type="text" data-vbs-validate="required,ignore[invisible]" class="vbs-insert-speaker-input" value="" placeholder="Enter speaker name"/>\n        </div>\n    </div>\n    <div class="vbs-common-popup-footer">\n        <a href="#" class="vbs-cancel-btn">Cancel</a>\n        <a href="#" class="vbs-confirm-btn">Insert</a>\n    </div>\n</div>\n\n',a.trim()},n["speakers/insertSpeakerText"]=n["speakers/insertSpeakerText.ejs"]=function(e){var t=e,a="";return a+='<span class="w vbs-wd vbs-edit-speaker" m="',a+=s(t.speakerKey),a+='" t="',a+=s(t.speakerTime),a+='">\n    <br><br>\n    ',a+=s(t.speakerName),a+=":\n</span>\n",a.trim()},n["speakers/renameSpeakerPopup"]=n["speakers/renameSpeakerPopup.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-rename-speaker-popup vbs-common-popup" style="top: ',a+=s(t.top),a+="px; left: ",a+=s(t.left),a+='px;">\n    <div class="vbs-arrow"></div>\n    <div class="vbs-common-popup-header vbs-clearfix">\n        <div class="rename_speaker_label">Rename speaker</div>\n        <div class="vbs-old-speaker-name">',a+=s(t.currentSpeakerName),a+='</div>\n        <div class="rename_speaker_label">to:</div>\n    </div>\n    <div class="vbs-common-popup-body">\n        <input type="text" id="vbs-rename_speaker_input" data-vbs-validate="required" data-old-speaker-key="',a+=s(t.currentSpeakerKey),a+='" placeholder="Enter new speaker name"/>\n    </div>\n    <div class="vbs-common-popup-footer">\n        <a href="#" class="vbs-cancel-btn">Cancel</a>\n        <a href="#" class="vbs-confirm-btn">Rename</a>\n    </div>\n</div>\n',a.trim()},n["speakers/speakerIsSpeaking"]=n["speakers/speakerIsSpeaking.ejs"]=function(e){var t=e,a="";return a+='<span class="',a+=s(t.speakerKey),a+='">',a+=s(t.speakerName),a+="</span> is speaking\n",a.trim()},n["speakers/speakerList"]=n["speakers/speakerList.ejs"]=function(e){var t=e,a="";a+='<li data-speaker="all">All Speakers</li>\n';for(var n in t.speakers)a+='\n<li data-speaker="',a+=s(n),a+='">',a+=s(t.speakers[n]),a+="</li>\n";return a+="\n\n",a.trim()},n["speakers/speakerTranscriptLabel"]=n["speakers/speakerTranscriptLabel.ejs"]=function(e){var t=e,a="";return a+='<span class="vbs-clearfix"></span>\n<span class="vbs-trans-info">\n    <span class="vbs-human-trans-name ',a+=s(t.spClass),a+='" title="',a+=s(t.speakerName),a+='">\n        ',a+=s(t.speakerName),a+='\n    </span>\n    <span class="vbs-human-trans-time">',a+=s(t.speakerTime),a+="</span>\n</span>\n",a.trim()},n["speakers/timelineSpeaker"]=n["speakers/timelineSpeaker.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-speaker ',a+=s(t.colorclass),a+='"\n     rel="tooltip" data-plcement="top" \n     style="width: ',a+=s(t.width),a+="px; left: ",a+=s(t.position),a+='px;"\n     s="',a+=s(t.s),a+='"\n     e="',a+=s(t.e),a+='"\n     cnum="',a+=s(t.colorclass),a+='">\n    \n</div>',a.trim()},n["transcript/editTranscript"]=n["transcript/editTranscript.ejs"]=function(e){var t=e,s="";return s+='<div class="vbs-edit-mode-wrapper">\n    <div class="vbs-controls-wrapper">\n        <div id="vbs-controls" class="vbs-controls-box">\n            <div class="vbs-edition-btns vbs-clearfix">\n                <div class="vbs-save-exit-btns">\n                    <a href="#" class="vbs-save-btn vbs-save-edition-popup-trigger" id="vbs-save-edition-popup-trigger">\n                        Save & Re-sync\n                    </a>\n                    <a href="#" class="vbs-exit-btn vbs-edit-mode-exit">Exit</a>\n                </div>\n            </div>\n            <div class="vbs-record-player vbs-3-left-btns">\n                <div class="vbs-player-control">\n                    <a href="#" class="vbs-play-btn" data-title="Play"></a>\n                    <a href="#" class="vbs-prev-btn" data-title="Back 15 Seconds"></a>\n                    <a href="#" class="vbs-next-action-btn vbs-next-notactive" data-title="Next Keyword Marker"></a>\n                </div>\n                <div class="vbs-time-name-wrapper-narrow" style="opacity: 0;">\n                    <span class="vbs-time">\n                        <span class="vbs-ctime">00:00:00</span> / <span class="vbs-ftime">00:04:03</span>\n                    </span> \n                    <br>\n                    <span class="vbs-voice-name"></span>\n                </div>\n                <div class="vbs-timeline">\n                    <div class="vbs-record-preview">\n                        <div class="vbs-record-timeline-wrap">\n                            <div class="">\n                                <div class="vbs-dragger"></div>\n                                <div class="vbs-record-timeline"></div>\n                                <div class="vbs-record-progress" style="width: 0;"></div>\n                                <div class="vbs-speakers"></div>\n                                <div class="vbs-player-slider" style="left: 0;"></div>\n                                <div class="vbs-record_buffer"></div>\n                            </div>\n                            <!--markers-->\n                            <div class="vbs-markers"></div>\n                            <!-- / markers-->\n                            <div class="vbs-markers-hovers"></div>\n                            <div class="vbs-comments-wrapper-block"></div>\n                            <div class="vbs-record-disabler" style="width: 0;"></div>\n                        </div>\n                    </div>\n                </div>\n                <div class="vbs-volume-toolbar">\n                    <a href="#" class="vbs-volume-btn" data-title="Volume"></a>\n\n                    <div class="vbs-volume-toolbar-block" style="display: none;">\n                        <div class="vbs-volume-slider">\n                            <div class="vbs-volume-slider-bg"></div>\n                            <div class="vbs-volume-slider-full"></div>\n                            <div class="vbs-volume-slider-handler"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="vbs-edit-instr vbs-clearfix">\n        <div class="vbs-mouse-btns-desc">\n            <span><b>Left click</b> on text to <em>Edit</em></span>\n            <span><b>Right click</b> on text to <em>Menu</em></span>\n        </div>\n    </div>\n    <div class="vbs-edition-block" contenteditable="true">\n        ',s=[s,t.ourtranscript].join(""),s+='\n    </div>\n    <div class="vbs-popup-overlay vbs-save-popup-wrapper">\n        <div class="vbs-save-popup">\n            <h2>Unsaved Changes</h2>\n\n            <p class="vbs-normal-save-message">You have unsaved changes that will be lost unless you save them.</p>\n\n            <p class="vbs-save-message-short-editing">\n                Edited transcript is too short relative to the original and may be rejected by the system. Attempt to save?\n            </p>\n\n            <p class="vbs-save-message-long-editing">\n                Edited transcript is too long relative to the original and may be rejected by the system. Attempt to save?\n            </p>\n            <a href="#" class="vbs-save-btn vbs-save-edition-btn">Save Changes</a>\n            <a href="#" class="vbs-exit-btn vbs-discard-edition-btn">Discard Changes</a>\n            <a href="#" class="vbs-exit-btn vbs-cancel-edition-btn">Cancel</a>\n        </div>\n        <div class="vbs-save-done-popup">\n            <div class="vbs-save-done-img"></div>\n            <h3>Done!</h3>\n        </div>\n        <div class="vbs-save-loading-popup">\n            <div class="vbs-ajax-loader"></div>\n            <h3>Saving & Re-syncing!</h3>\n\n            <p>This may take a little time, especially if you’re editing a longer transcript.</p>\n        </div>\n    </div>\n</div>',s.trim()
},n["transcript/transcriptBlock"]=n["transcript/transcriptBlock.ejs"]=function(e){var t=e,a="",n=t.tabView?"vbs-tab":"";a+="\n";var r=voiceBase.settings.showMore?"":"vbs-no-showmore-btn";return a+='\n\n<div class="vbs-transcript-block ',a+=s(n),a+=" ",a+=s(r),a+='">\n    <div class="vbs-edit-mode-prewrapper"></div>\n    <div class="vbs-section-header">\n        <div class="vbs-section-title">\n            <span class="vbs-section-name vbs-snh">human transcript</span>\n            <span class="vbs-section-name vbs-snm">machine transcript</span>\n        </div>\n\n        ',t.vbsButtons.orderTranscript&&(a+='\n        <div class="vbs-order-human-trans" data-title="See Transcript Price & Options">\n            <a href="#" target="_blank">Order Human Transcript</a>\n        </div>\n        '),a+='\n\n        <div class="vbs-section-btns">\n            <ul class="vbs-clearfix">\n                ',t.vbsButtons.downloadTranscript&&(a+='\n                <li><a href="#" class="vbs-cloud-btn vbs-popup-btn" data-title="Download Transcript"></a>\n                    <div class="vbs-download-popup vbs-popup">\n                        <div class="vbs-arrow"></div>\n                        <h3>Download transcript</h3>\n                        <a href="#pdf" class="vbs-donwload-pdf" format="pdf">PDF</a>\n                        <a href="#rtf" class="vbs-donwload-rtf" format="rtf">RTF</a>\n                        <a href="#srt" class="vbs-donwload-srt" format="srt">SRT</a>\n                    </div>\n                </li>\n                '),a+="\n\n                ",t.vbsButtons.edit&&(a+='\n                <li>\n                    <a href="#" class="vbs-edit-btn" data-title="Edit Transcript"></a>\n                </li>\n                '),a+="\n\n                ",t.vbsButtons.print&&(a+='\n                <li>\n                    <a href="#" class="vbs-print-btn" data-title="Print Transcript"></a>\n                </li>\n                '),a+="\n\n                ",t.vbsButtons.readermode&&(a+='\n                <li>\n                    <a href="#" class="vbs-readermode-btn" data-title="Reader Mode"></a>\n                </li>\n                '),a+='\n\n            </ul>\n        </div>\n    </div>\n    <div class="vbs-section-body">\n        <div class="vbs-transcript-prewrapper vbs-resizable">\n            <div class="vbs-transcript-wrapper"></div>\n        </div>\n\n        ',voiceBase.settings.showMore&&(a+='\n        <div class="vbs-more-btn">\n            <a href="#">Show More...</a>\n        </div>\n        '),a+="\n\n    </div>\n</div>\n",a.trim()},n["transcript/transcriptPlacement"]=n["transcript/transcriptPlacement.ejs"]=function(e){var t="";return t+='<div id="transcript_placement">\n\n</div>',t.trim()},n["utterance/utteranceBlock"]=n["utterance/utteranceBlock.ejs"]=function(e){var t="";return t+='<div class="vbs-utterance-block vbs-clearfix">\n    <div class="vbs-utterance-title">\n        <p>utterance detection</p>\n    </div>\n    <div class="vbs-utterance-list">\n        <ul class="vbs-clearfix">\n        </ul>\n    </div>\n</div>',t.trim()},n["utterance/utteranceCheckBox"]=n["utterance/utteranceCheckBox.ejs"]=function(e){var t=e,a="";return a+='<li>\n    <label class="vbs-utter-',a+=s(t.rownum),a+='">\n        <input type="checkbox" checked data-row="',a+=s(t.rownum),a+='"/>\n        ',a+=s(t.title),a+='\n        <span class="vbs-utter-num">(',a+=s(t.segmentsCount),a+=")</span>\n    </label>\n</li>",a.trim()},n["utterance/utteranceMarker"]=n["utterance/utteranceMarker.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-utter-marker\n        vbs-utter-',a+=s(t.rownum),a+="\n        vbs-utter-row",a+=s(t.rownum),a+='"\n        data-stime="',a+=s(t.startTime),a+='"\n        style="width:',a+=s(t.width),a+="px; left:",a+=s(t.position),a+='px;">\n\n    <div class="vbs-utter-tooltip">\n        <p class="vbs-utter-title">',a+=s(t.title),a+='</p>\n\n        <p class="vbs-utter-time">',a+=s(t.time),a+="</p>\n    </div>\n</div>",a.trim()},n["utterance/utteranceMarkerV2"]=n["utterance/utteranceMarkerV2.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-utter-marker\n            vbs-utter-',a+=s(t.rownum),a+="\n            vbs-utter-row",a+=s(t.rownum),a+='"\n    data-stime="',a+=s(t.startTime),a+='"\n    style="width:',a+=s(t.width),a+="px; left:",a+=s(t.position),a+='px;">\n</div>',a.trim()},n["youtube/languageSelect"]=n["youtube/languageSelect.ejs"]=function(e){var t=e,a="";return a+='<div class="vbs-select-wrapper vbs-select-language-wrapper">\n    <div class="vbs-select-title vbs-select-language">Select language...</div>\n    <ul class="vbs-language-dropdown vbs-select-dropdown">\n\n        ',t.languages.forEach(function(e){a+="\n            ";var t=Object.keys(e)[0];a+='\n\n            <li data-lang-code="',a+=s(t),a+='">',a+=s(e[t]),a+="</li>\n\n        "}),a+="\n\n    </ul>\n</div>\n",a.trim()};var r={locals:{},get:t,render:e};return r}),voiceBase=function(e,t){"use strict";function s(s,a){var n=e.blockSettings[s],r=t("#"+e.settings[n.block]);r.empty().html(a).addClass(e.data.vclass).css({width:e.settings[n.width]}),e.view.setResponsiveClass(r)}function a(e){e.find(".vbs-section-title").addClass("vbs-no-toggle")}function n(){if(e.settings.toggleBlocks)for(var s in e.blockSettings){var n=e.blockSettings[s];e.settings[n.toggle]||a(t("#"+e.settings[n.block]))}else t(".vbs-section-title").addClass("vbs-no-toggle")}function r(){for(var s in e.blockSettings){var a=e.blockSettings[s];e.settings[a.hasHeader]||("media"===s?t("#"+e.settings[a.block]).hide():a.additionalBlockClass&&t("#"+e.settings[a.block]).find(a.additionalBlockClass).addClass("vbs-no-header"))}}return e.view={main:null,pluginDiv:null,init:function(t){this.initMainElem(t),e.settings.hasPlaylist||e.settings.localYoutubeApp||this.initApi(),e.common.isMobile()&&e.helper.renderMobile()},initMainElem:function(s){this.main="OBJECT"===s[0].tagName&&"jwplayer"==e.settings.playerType?t(s).parent():s;var a=document.createElement("div");a.className="vbsp-"+e.helper.randId()+" vbs-content",a.innerHTML=vbsTemplates.render("common/mainDiv"),this.pluginDiv=t(a),t(this.main).after(this.pluginDiv)},initApi:function(){e.api.init(),e.settings.token||e.settings.example||e.settings.localYoutubeApp||e.settings.localData?!e.settings.example||e.settings.localYoutubeApp||e.settings.localData?e.view.initWithToken():e.api.getExampleToken():e.api.getToken(e.settings.tokenTimeOut)},initWithToken:function(){e.data.vclass="vbs-"+e.helper.randId(),t(".vbs-white-popup-overlay").remove(),t(".vbs-text-error-message").remove(),e.view.renderMediaBlock(),e.settings.localYoutubeApp?e.api.setLocalMetaData():e.api.getMetaData(),e.view.renderControlsBlock(),e.settings.showKeywordsBlock?(e.view.renderKeywordsBlock(),e.settings.localYoutubeApp||e.common.isApi2_0()||e.api.getKeywords()):e.api.ready.keywords=!0,e.settings.showTranscriptBlock?(e.view.renderTranscriptBlock(),e.settings.localYoutubeApp||e.common.isApi2_0()||e.api.getTranscript()):e.api.ready.transcript=!0,e.settings.showCommentsBlock?(e.view.renderCommentsBlock(),e.common.isApi2_0()||e.comments.api.getComments()):e.api.ready.comments=!0,e.settings.localYoutubeApp&&e.view.renderLanguageBlock(),e.settings.showNewsBlock&&e.view.renderNewsBlock(),e.settings.showPredictionsBlock&&e.view.renderPredictionsBlock(),e.settings.tabView&&e.view.renderTabs(),n(),r(),e.data.waiter=setInterval(function(){e.data.waiter&&e.helper.waitReady()},100),e.events.registerEvents()},initLocalYoutubeData:function(){var s=e.data.localYoutubeData.selected_language,a=t("#"+e.settings.keywordsBlock),n=t("#"+e.settings.transcriptBlock);e.data.localYoutubeData.keywords?e.keywords.view.createView(e.data.localYoutubeData.keywords[s]):YSP.api.getKeywords(function(t){e.data.localYoutubeData.keywords=t.keywords,a.removeClass("vbs-loading"),e.keywords.view.createView(e.data.localYoutubeData.keywords[e.data.localYoutubeData.selected_language])}),e.data.localYoutubeData.transcripts?e.transcript.view.createView(e.data.localYoutubeData.transcripts[s]):YSP.api.getTranscript(function(t){e.data.localYoutubeData.transcripts=t.transcripts,n.removeClass("vbs-loading"),e.transcript.view.createView(e.data.localYoutubeData.transcripts[e.data.localYoutubeData.selected_language])})},renderControlsBlock:function(){var s=t("#"+e.settings.controlsBlock),a=vbsTemplates.render("controls/controlsBlock",{vbsButtons:e.settings.vbsButtons,is_iDevice:e.common.is_iDevice});s.empty().html(a).addClass(e.data.vclass+" vbs-controls").css({width:e.settings.controlsWidth}),e.view.setResponsiveClass(s),e.settings.showControlsBlock||s.addClass("vbs-hide-controls")},renderMediaBlock:function(){var s=t("#"+e.settings.mediaBlock),a=vbsTemplates.render("common/mediaBlock",{vbsButtons:e.settings.vbsButtons});s.empty().html(a).addClass(e.data.vclass).css({width:e.settings.mediaWidth}),e.view.setResponsiveClass(s)},renderTimeInMediaTitle:function(){var s=t("#"+e.settings.mediaBlock),a=e.common.parseTime(e.data.duration);e.helper.find(".vbs-ftime").text(a),s.hasClass("less-600px")||!e.settings.hasMediaBlockHeader?t(".vbs-time-in-player").find(".vbs-time").show():s.find(".vbs-section-header").find(".vbs-time").show()},renderKeywordsBlock:function(){var a=t("#"+e.settings.keywordsBlock),n=t("#"+e.settings.controlsBlock),r=vbsTemplates.render("keywords/keywordsBlock",{tabView:e.settings.tabView,vbsButtons:e.settings.vbsButtons,searchBarOuter:e.settings.searchBarOuter});if(e.settings.searchBarOuter){t("#vbs-searchbar-block").remove();var i=t("#"+e.settings.searchBarBlock);i.length>0?i.empty().append(vbsTemplates.render("search/searchBarOuter")):n.after(vbsTemplates.render("search/searchBarOuter"));var o=t("#vbs-searchbar-block");o.addClass(e.data.vclass).css({width:e.settings.searchBarBlockWidth}),a.empty().html(r).addClass(e.data.vclass).css({width:e.settings.keywordsWidth}),a.find(".vbs-search-form").addClass("no_border")}else s("keywords",r);e.settings.markersInNativeTimeline&&e.view.renderControlsAfterSearchBar(),e.settings.localYoutubeApp&&(a.addClass("vbs-local-app vbs-loading"),a.find(".vbs-section-title").attr("data-title","Loading keywords"))},renderControlsAfterSearchBar:function(){if(e.settings.searchBarOuter){var s=t("#vbs-searchbar-block");s.addClass("vbs-controls-after-searchbar vbs-searchbar-outer"),t(".vbs-after-controls-wrapper").remove(),s.find(".vbs-search-form").after(vbsTemplates.render("controls/controlsContainer")),t(".vbs-prev-btn,.vbs-next-action-btn").appendTo(".vbs-controls-after-searchbar .vbs-player-control"),t(".vbs-share-btn-wrapper").appendTo(".vbs-controls-after-searchbar .vbs-share-control"),s.find(".vbs-search-form").width(s.width()-t(".vbs-controls-after-searchbar .vbs-after-controls-wrapper").width()-2)}else{var a=t(".vbs-keywords-block "),n=t(".vbs-search-form");0===a.find(".vbs-section-btns").length&&n.after('<div class="vbs-section-btns"><ul></ul></div>');var r=a.find(".vbs-section-btns");r.find(".vbs-controls-after-searchbar").remove(),r.addClass("vbs-controls-after-searchbar-wrapper").find("ul").append('<li class="vbs-controls-after-searchbar vbs-searchbar-inner"></li>'),r.find(".vbs-controls-after-searchbar").append(vbsTemplates.render("controls/controlsContainer")),t(".vbs-prev-btn,.vbs-next-action-btn").appendTo(".vbs-controls-after-searchbar-wrapper .vbs-player-control"),t(".vbs-share-btn-wrapper").appendTo(".vbs-controls-after-searchbar-wrapper .vbs-share-control"),n.removeClass("vbs-one-btn vbs-no-btns"),e.settings.vbsButtons.evernote&&"undefined"!=typeof filepicker?n.addClass("vbs-four-btns"):n.addClass("vbs-three-btns")}},resetControlsPlace:function(){t(".vbs-controls-after-searchbar").find(".vbs-prev-btn").appendTo(".vbs-record-player .vbs-player-control"),t(".vbs-controls-after-searchbar").find(".vbs-next-action-btn").appendTo(".vbs-record-player .vbs-player-control"),t(".vbs-search-form").removeClass("vbs-four-btns vbs-three-btns"),t(".vbs-volume-toolbar").after(t(".vbs-controls-after-searchbar").find(".vbs-share-btn-wrapper")),e.settings.searchBarOuter&&t(".vbs-search-form").width(295)},renderTabs:function(){var s=t("#"+e.settings.keywordsBlock),a=t(".vbs-tabs-view");e.view.setResponsiveClass(a),a.hasClass("less-600px")||a.hasClass("less-480px")||a.addClass("vbs-normal-width");var n=t(".vbs-tabs-links");n.find("a").removeClass("vbs-active"),n.find('[data-href=".vbs-keywords-block"]').addClass("vbs-active"),s.find(".vbs-keywords-block").addClass("vbs-tab-visible")},checkEmptyHeadersForTabs:function(){var e=t(".vbs-tabs-view");e.hasClass("vbs-normal-width")||t(".vbs-tab").each(function(){var e=t(this).find(".vbs-section-header"),s=t(this).hasClass("vbs-keywords-block")&&0===e.find(".vbs-no-speaker").length?!0:!1;s||0!==e.find(".vbs-section-btns").length||t(this).addClass("vbs-tab-empty-header")})},renderTranscriptBlock:function(){var a=t("#"+e.settings.transcriptBlock),n=vbsTemplates.render("transcript/transcriptBlock",{tabView:e.settings.tabView,vbsButtons:e.settings.vbsButtons});s("transcript",n),e.settings.localYoutubeApp&&(a.addClass("vbs-local-app vbs-loading"),a.find(".vbs-section-title").attr("data-title","Loading transcript"))},renderCommentsBlock:function(){var t=vbsTemplates.render("comments/commentsWrapper",{tabView:e.settings.tabView,showAddBtn:e.comments.canCommentEdit()});s("comments",t)},renderNewsBlock:function(){var t=vbsTemplates.render("news/newsBlock",{tabView:e.settings.tabView});s("news",t),e.settings.expandNewsBlock?e.news.view.expandNewsBlock():e.news.view.collapseNewsBlock()},renderPredictionsBlock:function(){s("predictions",vbsTemplates.render("predictions/predictions"))},renderLanguageBlock:function(){if(e.data.localYoutubeData.languages&&e.data.localYoutubeData.languages.length>0){var s=t("#"+e.settings.mediaBlock).find(".vbs-section-header .vbs-section-btns");s.after(vbsTemplates.render("youtube/languageSelect",{languages:e.data.localYoutubeData.languages})),e.view.selectDefaultLanguage()}},selectDefaultLanguage:function(){for(var t=!1,s=0;s<e.data.localYoutubeData.languages.length;s++){var a=e.data.localYoutubeData.languages[s],n=Object.keys(a)[0];if(0===n.indexOf("en")){e.view.selectLanguage({lang_code:n,lang_name:a[n]}),t=!0;break}}t||e.view.selectLanguage(e.data.localYoutubeData.languages[0])},selectLanguage:function(s){var a=t(".vbs-select-language-wrapper").find(".vbs-select-language"),n=s.lang_code;a.removeClass("vbs-s-show").html(s.lang_name).attr(n),e.data.localYoutubeData.selected_language=n,e.view.initLocalYoutubeData()},checkResponsive:function(){for(var s in e.blockSettings){var a=e.blockSettings[s];e.view.setResponsiveClass(t("#"+a.block))}e.view.setResponsiveClass(t("#"+e.settings.controlsBlock))},setResponsiveClass:function(t){t.width()<e.settings.mediumResponsive&&t.width()>=e.settings.minResponsive?t.addClass("less-600px"):t.width()<e.settings.minResponsive&&t.addClass("less-600px").addClass("less-460px")},initAfterSaveTranscript:function(){e.api.ready.keywords=!1,e.helper.find(".vbs-keywords-block .vbs-topics").html(""),e.helper.find(".vbs-keywords-block .vbs-keywords-list-tab").html(""),e.helper.find(".vbs-select-speaker-wrapper .vbs-select-dropdown").html(""),e.helper.find(".vbs-search-form").addClass("vbs-no-speaker"),e.data.speakers={},e.api.ready.transcript=!1,e.helper.find(".vbs-transcript-block").removeClass("vbs-human").removeClass("vbs-with-order-btn"),e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper").html("").removeClass("vbs-turntimes"),e.helper.find(".vbs-speakers").html("").removeClass("vbs-machine"),e.helper.find(".vbs-media-block .vbs-section-title, .vbs-time-name-wrapper-narrow").removeClass("vbs-machine"),e.api.getKeywords(),e.api.getTranscript()},searchWordWidget:function(t){if(t.length>0){var s=e.helper.find(".vbs-search-word-widget"),a=e.helper.find("#vbs-voice_search_txt");a.css("opacity","0"),e.helper.find("#vbs-search-string").show();var n=vbsTemplates.render("keywords/searchWordWidget",{words:t,colors:e.settings.colors,generateRandomColor:e.common.generateRandomColor});s.html(n),e.data.searcht&&e.settings.editKeywords&&a.data("data-val")==a.val()&&e.keywords.view.checkKeyword(t,e.data.searcht,e.data.searchHits),a.data("data-val")!=a.val()&&(e.data.searcht=null,e.data.searchHits=null),e.keywords.view.updateQuotesVisibility(),e.helper.startScroll()}},markerWidget:function(t,s,a){return vbsTemplates.render("keywords/markers",{times:t,phrases:s,color:a||e.settings.colors[0],getPosition:e.PlayerApi.getOffset,unEscapeHtml:e.common.unEscapeHtml})},showCustomMarkers:function(){var s=t(".vbs-custom-markers");if(0===s.find(".vbs-custom-marker").length){var a=vbsTemplates.render("keywords/customMarkers",{markers:e.data.customMarkers,getPosition:e.PlayerApi.getOffset,unEscapeHtml:e.common.unEscapeHtml});s.append(a)}s.show()},hideCustomMarkers:function(){var e=t(".vbs-custom-markers");e.hide()},markerWidgetForNativeTimeline:function(){{var s=e.data.duration,a=t(".vbs-markers").find(".vbs-marker");e.PlayerApi.getPlayerIframe()}e.view.clearScrubberOfMarks(),t.each(a,function(a,n){var r=t(n).attr("stime"),i=t(n).css("border-bottom-color"),o=(t(n).css("left"),r/s*100);e.view.createScruberMark("vb_scrubber_mark"+a,i,o,10,"keyword-marks keyword-mark-"+a);var l=t('span[ctime="'+r+'"]');"undefined"!=typeof n?e.view.createPhraseBar("vb_scrubber_mark"+a,l.text()):console.log("Keyword phrase-bar not found for "+r)})},clearScrubberOfMarks:function(){var t=e.PlayerApi.getPlayerIframe();t.find(".keyword-marks").remove(),t.find(".vb-keyphrase").remove()},createScruberMark:function(t,s,a,n,r){var i=e.PlayerApi.getPlayerIframe(),o=i.find(".playHead"),l=i.find("#"+t);if(l.length>0)l.css("left",a+"%");else{n="undefined"!=typeof n?n:10,s="undefined"!=typeof s?s:"#dddddd";var d=i.find(".scrubber"),c=d.height();l=jQuery('<a class="scrubber-marker '+r+'"></a>'),e.view.setMarkerCss(l,c,a,s,t,n),o.after(l)}},createPhraseBar:function(s,a){var n=e.PlayerApi.getPlayerIframe(),r=t('<span class="vb-keyphrase" style="display: none;">'+a+"</span>");r.css({position:"absolute","text-align":"center",width:"100%",height:"17px","padding-top":"3px","margin-top":"-20px","background-color":"#EDF0F8","border-radius":"2px",color:"#333","font-family":"Helvetica, Arial, sans-serif","font-size":"13px","z-index":99}).attr("sourcemarker",s),n.find(".controlBarContainer").prepend(r),n.find("#"+s).mouseenter(function(){n.find("span[sourcemarker="+this.id+"]").show()}),n.find("#"+s).mouseleave(function(){n.find("span[sourcemarker="+this.id+"]").hide()})},setMarkerCss:function(e,t,s,a,n,r){e.css({"border-top-width":t,"border-top-style":"solid","border-top-color":a,left:s+"%",position:"absolute","border-left-width":r/2,"border-left-style":"solid","border-left-color":"transparent","border-right-width":r/2,"border-right-style":"solid","border-right-color":"transparent","z-index":99}).attr("id",n)},favorite:function(t){return t?e.helper.find(".vbs-star-btn").addClass("vbs-active").attr("data-tile","Remove from Favorites"):e.helper.find(".vbs-star-btn").removeClass("vbs-active").attr("data-tile","Add from Favorites"),t},favoriteToggle:function(){return e.helper.find(".vbs-star-btn").toggleClass("vbs-active"),!0},resizeTimelineElements:function(){e.helper.find(".vbs-markers a").each(function(){var s=t(this),a=s.attr("stime"),n=e.PlayerApi.getOffset(a);s.css("left",n)}),e.speakers.view.renderSpeakersInTimeline(),e.comments.view.resizeCommentsTWidget(),e.helper.startScroll()}},e}(voiceBase,jQuery);